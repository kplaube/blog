{"componentChunkName":"component---src-templates-blog-post-js","path":"/2012/01/23/supervisor-gerencie-os-processos-seu-servidor-web.html","result":{"data":{"markdownRemark":{"html":"<p>E se você pudesse controlar uma série de processos\natravés de um comando? Ou de garantir que serviços “down” sejam\nreiniciados automaticamente? Ou ainda, agrupar seus serviços e poder\nreiniciá-los com um simples comando de terminal?</p>\n<p>O <strong><em>Supervisor</em></strong> aparece para facilitar muito a vida de quem precisa\nadministrar servidores <a href=\"/tag/desenvolvimento-web.html\" title=\"Leia mais sobre Web\"><em>web</em></a>, e não tem muito tempo a perder com\ncriação de rotinas, ou mesmo com trabalho manual.</p>\n<h2>Afinal, o que é o Supervisor?</h2>\n<p>A proposta do <a href=\"http://supervisord.org/\" title=\"Conheça o projeto Supervisor\"><em>Supervisor</em></a> é simples: permitir que usuários possam\ncontrolar e monitorar processos (e grupos de processos) em um sistema\n<em>Unix-like</em>.</p>\n<p>Em suma, o <em>Supervisor</em> é um programa escrito em <a href=\"/tag/python.html\" title=\"Leia mais sobre Python\"><em>Python</em></a>, capaz de\niniciar, reiniciar e parar outros programas. Mas, o que me chamou mais a\natenção, é que ele é capaz de reiniciar programas “crashados”\nautomaticamente.</p>\n<p>Isso é possível pois, por baixo dos panos, o <em>Supervisor</em> é um serviço\nque inicia todos os demais como subprocessos. Desse modo, é capaz de\nmonitorar o estado dos mesmos, e numa eventual “queda”, reiniciar um\ndeterminado processo/serviço imediatamente.</p>\n<p>Ou seja, funciona como uma ferramenta centralizadora e de monitoramento.\nE que ainda serve uma <em>API</em> para gerenciamento remoto, <a href=\"http://supervisord.org/api.html\" title=\"Leia mais sobre a API do Supervisor\">através de <em>XML-RPC</em></a>.</p>\n<h2>Instalar para administrar</h2>\n<p>Para instalar, basta utilizar o <code class=\"language-text\">pip</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ pip install supervisor</code></pre></div>\n<p>Vamos gerar um arquivo de configuração básico:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ echo_supervisord_conf > /etc/supervisord.conf</code></pre></div>\n<p>Vamos aproveitar que <a href=\"/2011/12/19/nginx-poderoso-rapido-facil.html\" title=\"Nginx: Poderoso, rápido e fácil\">falamos recentemente sobre a instalação do <em>Nginx</em></a>,\npara demonstrar o princípio do <em>Supervisor</em>. Adicione as\nseguintes linhas ao arquivo <code class=\"language-text\">/etc/supervisord.conf</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"config\"><pre class=\"language-config\"><code class=\"language-config\">[program:nginx]\ncommand=/usr/local/nginx/sbin/nginx</code></pre></div>\n<p>Agora iniciamos o serviço do <em>Supervisor</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ supervisord</code></pre></div>\n<p>E através do <code class=\"language-text\">supervisorctl</code>, vamos iniciar e parar o <em>Nginx</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ supervisorctl start all\nnginx: started\n\n$ ps aux | grep nginx\nroot      1863  0.0  0.1 (...) /usr/local/nginx/sbin/nginx\n\n$ supervisorctl stop nginx\nnginx: stopped</code></pre></div>\n<p>E agora, o “pulo do gato”. Com o <em>Nginx</em> iniciado via <em>Supervisor</em>,\nvamos fechá-lo através de um comando <code class=\"language-text\">kill</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ supervisorctl start nginx\nnginx: started\n\n$ killall nginx\n\n$ ps aux | grep nginx\nroot      1917  0.0  0.1 (...) /usr/local/nginx/sbin/nginx</code></pre></div>\n<p>Magia? Que nada! É a ferramenta garantindo que os nossos processos não\nfiquem “down”. <a href=\"http://brandonkonkle.com/blog/2010/sep/14/django-uwsgi-and-nginx/\" title=\"Django on uWSGI and Nginx\"><em>Brandon Konkle</em></a> e <a href=\"http://senko.net/en/django-nginx-gunicorn/\" title=\"A Django setup using Nginx and Gunicorn\"><em>Senko Rasic</em></a> possuem exemplos\nutilizando um cenário real com <a href=\"/tag/django.html\" title=\"Leia mais sobre Django\"><em>Django</em></a> e <a href=\"/tag/nginx.html\" title=\"Leia mais sobre Nginx\"><em>Nginx</em></a>.</p>\n<h2>Considerações finais</h2>\n<p>Embora o <em>Supervisor</em> seja uma ferramenta espetacular, acredito que\nmuitos profissionais já possuam intimidade com os seus servidores, bem\ncomo já tenham construído <em>sets</em> de <em>scripts</em>, e atalhos em geral. Isso,\nde fato, faz a gente questionar a utilidade dela.</p>\n<p>A possibilidade de monitorar e garantir a disponibilidade dos processos\nfoi o que mais me agradou. Se você tem “poderes administrativos” na sua\nhospedagem, talvez o <em>Supervisor</em> seja a ferramenta que faltava para\nvocê possa dormir mais tranquilo.</p>\n<h2>Referências</h2>\n<ul>\n<li><a href=\"http://supervisord.org/\" title=\"Supervisor - A process control system\"><em>Supervisor</em> – Documentação oficial</a></li>\n<li><a href=\"http://brandonkonkle.com/blog/2010/sep/14/django-uwsgi-and-nginx/\" title=\"Saiba como montar um servidor Nginx com Django, uWSGI e Supervisor\"><em>Brandon Konkle – Django on uWSGI and Nginx</em></a></li>\n<li><a href=\"http://www.plope.com/static/misc/supervisor-pycon2008.pdf\" title=\"Apresentação para a PyCon 2008, sobre Supervisor\"><em>Mike Naberezny – Supervisor as a Platform</em></a></li>\n<li><a href=\"http://senko.net/en/django-nginx-gunicorn/\" title=\"Um ótimo exemplo de uso do Nginx, Django e Supervisor\"><em>Senko’s Blog – A Django setup using Nginx and Gunicorn</em></a></li>\n</ul>","excerpt":"E se você pudesse controlar uma série de processos\natravés de um comando? Ou de garantir que serviços “down” sejam\nreiniciados…","frontmatter":{"date":"2012-01-23T21:28:00.000Z","title":"Supervisor: Aumentando a disponibilidade das suas aplicações Web","tags":["desenvolvimento-web","infraestrutura","supervisor","linux"],"thumbnail":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiUlEQVQ4y+1TyU4CQRDlK4kHNZFPkKjRg14YMIoSI+EgLiMS2R12mK1nZ0LYZmAW9hk8ePAr7AESz+hRk5dKVXW97up63a7xgP4xXH+aPOpTPyGPBvTMYOYmC50JhAbgRmsMvu1kAEZOMbXCmgyrZb4gAmyqM4ZK6AphG7xtcJbBQbswHX9h8JqCz3UWAq5aOuuQhyr5Ycl+36nXu/9pt4oARathIKUKAK1x8Sr38kY/ltkYtGkiCjNMI50HT5SYmOmMa6LRags/OT7yePbaUp0UX29y59dZ/yF6EMwgoWwASZzFa5Fb7OK5Gr7KINFiCEk6GdiO630soA9ht3tre2f3/i4y1Kheu6IreIWJCXJu3Ke77bKpkvDOWg9XOpV+t6Z0qoaCO21bJlvKx4OXwYDfJ4t1s0dwZIqpJ1tCoSOVmjzWAFmBzvB0mifTEsixRBLUE00hP9WBMzDYfVMsSwxmj/ih6gzWUIjVaTA0FceBIZzOEGaWWOm60plaSsVsKvWvH8n/l9wAX1cuqbfjRRJYAAAAAElFTkSuQmCC","width":180,"height":180,"src":"/static/408dba86c1299ad6a5573b3b225963f0/d8216/supervisor-logo.png","srcSet":"/static/408dba86c1299ad6a5573b3b225963f0/d8216/supervisor-logo.png 1x"}},"publicURL":"/static/408dba86c1299ad6a5573b3b225963f0/supervisor-logo.png"}},"fields":{"readingTime":{"minutes":3.1},"slug":"/2012/01/23/supervisor-gerencie-os-processos-seu-servidor-web.html"}},"site":{"siteMetadata":{"author":{"name":"Klaus Peter Laube","gravatar":"https://en.gravatar.com/userimage/12163112/d3ae0c6239980b01ff1f1730b65c2ebe.jpg"},"siteUrl":"https://klauslaube.com.br"}}},"pageContext":{"slug":"/2012/01/23/supervisor-gerencie-os-processos-seu-servidor-web.html"}},"staticQueryHashes":["2831923220","4114525740"]}