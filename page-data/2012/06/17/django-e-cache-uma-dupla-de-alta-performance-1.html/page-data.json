{"componentChunkName":"component---src-templates-blog-post-js","path":"/2012/06/17/django-e-cache-uma-dupla-de-alta-performance-1.html","result":{"data":{"markdownRemark":{"html":"<p>Embora o <a href=\"/2012/05/14/o-cache-e-o-http.html\" title=\"O cache e o HTTP\"><em>caching HTTP</em></a> seja essencial\npara qualquer aplicação <a href=\"/tag/desenvolvimento-web.html\" title=\"Leia mais sobre Web\"><em>web</em></a>, <strong>(IMO)</strong>\nessa modalidade de <a href=\"/tag/cache.html\" title=\"Leia mais sobre Cache\"><em>cache</em></a> deve ser encarada como um acréscimo à\nexperiência de uso, e não necessariamente como uma “arma” contra\nproblemas de performance. Os usuários poderão abdicar desta\nfuncionalidade, e aí a sua aplicação não poderá depender do protocolo\npara atingir tempos de resposta atrativos.</p>\n<p>Desenvolvedores <a href=\"/tag/django.html\" title=\"Leia mais sobre Django\"><em>Django</em></a> podem contar com boas soluções, do próprio\n<em>framework</em> e de terceiros, que podem melhorar o <em>caching</em> das\naplicações (e consequentemente a performance). A grande notícia é que\nessas ferramentas são fáceis e práticas. Vamos conhecê-las?</p>\n<h2>O Memcached</h2>\n<p>Eu juro que tentei escrever uma introdução\npara este tópico, mas a descricão contida no <a href=\"http://memcached.org/\" title=\"A distributed memory object caching system\">site oficial do <em>Memcached</em></a> é\ntão boa, que vou simplesmente copiá-la:</p>\n<blockquote>\n<p>Memcached is an in-memory key-value store for small chunks of arbitrary\ndata (strings, objects) from results of database calls,\nAPI calls, or page rendering.</p>\n</blockquote>\n<p>Em outras palavras, é uma ferramenta <em>open source</em>, que tem como função\no armazenamento (e gerenciamento) de resultados de <em>queries</em>, conteúdo\nde arquivos, processamentos avançados, ou qualquer tipo de informação,\nem memória (um meio muito mais rápido de ser lido que em disco, por\nexemplo). Embora esse potencial possa ser utilizado para os mais\ndiferentes fins, é como mecanismo de <em>caching</em> que ele se destaca.</p>\n<p>O <em>Memcached</em> foi construído em um esquema “cliente-servidor”, e é\npossível utilizá-lo com uma grande quantidade de linguagens de\nprogramação. Mas o que eu acho mais bacana na ferramenta é a\npossibilidade de utilizá-la de forma distribuída. Isso propicia uma\nflexibilidade muito maior na hora de construirmos a <a href=\"/tag/infraestrutura.html\" title=\"Leia mais sobre infra\">infraestrutura</a>\npara servir as nossas aplicações <em>web</em>.</p>\n<p>Mas a “cereja do bolo” é: O <em>Django</em> funciona muito bem com o\n<em>Memcached</em>.</p>\n<h2>Framework de cache do Django</h2>\n<p>O uso do <em>Memcached</em> não é obrigatório! Na verdade, podemos utilizar\ndiferentes <em>backends</em> para diferentes tipos de mecanismos de <em>cache</em>. O\n<em>Django</em> possui algumas opções disponíveis, sem necessitar utilizar\nnenhum “código de terceiro”. Temos a opção de fazer <em>cache</em> em disco,\nbanco de dados ou até mesmo “simularmos” a interação com <em>cache</em> (muito\nbom para ambientes de desenvolvimento). <a href=\"https://docs.djangoproject.com/en/1.3/topics/cache/#setting-up-the-cache\" title=\"Setting up cache\">Leia mais sobre</a>.</p>\n<p>Neste <em>post</em>, vamos nos concentrar na configuração do <em>Django</em> com o\n<em>Memcached</em>. Para instalar, <a href=\"http://code.google.com/p/memcached/wiki/NewInstallFromSource\" title=\"Memcached - Why build from source\">basta compilar através do make</a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ wget http://memcached.org/latest\n$ tar -zxvf memcached-1.4.13.tar.gz\n$ cd memcached-1.4.13\n$ ./configure\n$ make &amp;&amp; make test\n$ make install</code></pre></div>\n<p>Utilizando a <a href=\"ftp://ftp.tummy.com/pub/python-memcached/\" title=\"Conheça a python-memcached\"><em>python-memcached</em></a> como <em>binding</em> <em>Python</em> para o\n<em>Memcached</em>, basta adicionarmos o seguinte <em>backend</em> ao <strong>settings.py</strong>:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">CACHES <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'default'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">'BACKEND'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'django.core.cache.backends.memcached.MemcachedCache'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'LOCATION'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'127.0.0.1:11211'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'TIMEOUT'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># Default: 300 segundos,</span>\n        <span class=\"token string\">'KEY_PREFIX'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'djcache'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Onde:</p>\n<ul>\n<li><code class=\"language-text\">BACKEND:</code> É o módulo responsável por se comunicar com o\n<em>Memcached</em>. Estamos utilizando este <em>backend</em> pois optamos pela\n<em>python-memcached</em>.</li>\n<li><code class=\"language-text\">LOCATION:</code> É a porta (ou <em>socket</em>) onde o serviço do <em>Memcached</em>\nestá respondendo. A porta padrão é a 11211.</li>\n<li><code class=\"language-text\">TIMEOUT:</code> É o tempo de vida do informação “cacheada”. Acima\ninformamos 60 segundos, o padrão é 5 minutos.</li>\n<li><code class=\"language-text\">KEY_PREFIX:</code> É um valor que precederá todas as chaves que\nutilizarmos com o <em>Django</em>. Bem útil para prevenir que duas\naplicações utilizem o mesmo valor no <em>Memcached</em> (quando este não é\no comportamento esperado).</li>\n</ul>\n<p><a href=\"https://docs.djangoproject.com/en/dev/topics/cache/#cache-arguments\" title=\"Cache Arguments - Django Documentation\">Conheça outras opções de configurações.</a></p>\n<h2>Considerações finais</h2>\n<p>Pronto! As ferramentas estão apresentadas e estamos prontos para partir\npara uma abordagem prática.</p>\n<p>O <em>Django</em> já vem “preparado” para trabalhar com mecanismos de <em>cache</em>.\nO seu esquema de <em>backends</em> permite que você “acople” diferentes módulos\npara atender os mais exóticos mecanismos de <em>cache</em>, sem necessariamente\nprecisar alterar código nas suas <em>apps</em>.</p>\n<p>É bem verdade que o <em>Memcached</em> é um tanto “tradicional”, e que hoje\nexistem alternativas mais “atrativas”, como o <a href=\"http://redis.io/\" title=\"Redis is an open source, advanced key-value store\"><em>Redis</em></a>. Na prática,\ndepende muito do cenário no qual você está inserido, por exemplo, no\n<a href=\"http://globoesporte.globo.com/\" title=\"a melhor cobertura sobre o Futebol e Outros Esportes, no Brasil e no Mundo\"><em>Globoesporte.com</em></a> utilizamos o <em>Memcached</em> e ele nos atende muito\nbem.</p>\n<p>No próximo <em>post</em> vamos partir para uma abordagem mais prática, cobrindo\nas diferentes maneiras de utilizar <em>caching</em> com <em>Django</em>.</p>\n<p>Até lá...</p>\n<h2>Referências</h2>\n<ul>\n<li><a href=\"http://amix.dk/blog/post/19471\" title=\"Um post antigo, com o comparativo entre pylibmc e python-memcached\"><em>Amix.dk – memcached: Benchmark of 4 Python libraries</em></a></li>\n<li><a href=\"https://docs.djangoproject.com/en/dev/topics/cache/\" title=\"Leia a documentação do framework de cache do Django\"><em>Django Documentation – Django’s cache framework</em></a></li>\n<li><a href=\"http://memcached.org/\" title=\"Página principal do projeto Memcached\"><em>Memcached.org</em></a></li>\n<li><a href=\"http://sendapatch.se/projects/pylibmc/\" title=\"Cliente Python escrito em C para trabalhar com o Memcached\"><em>pylibmc – Python client for memcached</em></a></li>\n<li><a href=\"http://en.wikipedia.org/wiki/Memcached\" title=\"Leia mais sobre o Memcached no Wikipedia\"><em>Wikipedia: Memcached</em></a></li>\n</ul>","excerpt":"Embora o caching HTTP seja essencial\npara qualquer aplicação web, (IMO)\nessa modalidade de cache deve ser encarada como um acréscimo à…","frontmatter":{"date":"2012-06-17T15:52:22.000Z","title":"Django e Cache: Uma dupla de alta performance - Parte 1","tags":["desenvolvimento-web","python","django","memcached","cache"],"thumbnail":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACjElEQVQ4y52V3UtTYRzH9yd035Vl0YvOapuatjZzLTNFSSudQ5u2uSVpyQx7p5KIrFUXSlAGvaBpJWlI2qpRGPZ2MURUspQKusjWsumcXezb8/zsjCnnrNkDD+c85/x+n/N7PzKFRQepvc6cjmjeh8vJ/geoLN+8cKAgtNa8CfGlGsjZ5s8SyrSI262mq9hHZVIwbgVXLDhpgXtkAL39r5G8dyvqbjgwOPYe5+80YkVxClTl+sgWCi+TbBmIM6lhc9RAWOsZsKvPSfcv3H1YUqhEonWLNJAss8zGZ1XJBizOl8Nw2kqAX1M+aKpyUHGpFm2uDtgbT2A184B7IgoU3BRiZb1gx9FrZ3D14S0CTvonoavOg96+E2Xn9iP7kJHFMU08KYJlHJZ+IA9vh9yYv/yBaeZyJu66Oun86NVTLDWopF3m1nE3e964SGH8pwf1LQ24/fgenacCfqRUZKLZeZ/OHb3diDUkigOVbMtLtcylfIoVX8ebzmJRViyMdba5wCftdO58GQnIS8S0EduPmRD4PUMKhacsiGFZtDkOzgG2hIA90kC+eYC1Vbnw+iZI4XpXM2IKFJQAvnwsKTyGUQNVzMqVxam42d0aSsTw5w8Y+TJK98FgEOp92VQy/4xheJspzDo0tDdh7Osnyuz0TADfvN/R/3GQubwNznfPCdj67AGWFSUxoF66DoXrcmMytZTevgMZNbuo/riypjIHnokfBLzYdmVWjgEle1mACv0pp6GgpRbMPVKCgdGhUE1m1RYhniVSslPEwLzYOTyBQc311Qw4jHGvB5WXD7OaTaW4c9kFzUOhi/hk4ZXAE8Nh/JnYvIwIDAer/g7VNXvSQpaJyUYFnD8AIv0a/gClXoHnX4B8twAAAABJRU5ErkJggg==","width":180,"height":180,"src":"/static/46012f1b5a5e44b0747baafa90e04f8a/d8216/django-logo.png","srcSet":"/static/46012f1b5a5e44b0747baafa90e04f8a/d8216/django-logo.png 1x"}},"publicURL":"/static/46012f1b5a5e44b0747baafa90e04f8a/django-logo.png"}},"fields":{"readingTime":{"minutes":4.26},"slug":"/2012/06/17/django-e-cache-uma-dupla-de-alta-performance-1.html"}},"site":{"siteMetadata":{"author":{"name":"Klaus Peter Laube","gravatar":"https://en.gravatar.com/userimage/12163112/d3ae0c6239980b01ff1f1730b65c2ebe.jpg"},"siteUrl":"https://klauslaube.com.br"}}},"pageContext":{"slug":"/2012/06/17/django-e-cache-uma-dupla-de-alta-performance-1.html"}},"staticQueryHashes":["2831923220","4114525740"]}