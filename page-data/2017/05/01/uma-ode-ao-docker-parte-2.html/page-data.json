{"componentChunkName":"component---src-templates-blog-post-js","path":"/2017/05/01/uma-ode-ao-docker-parte-2.html","result":{"data":{"markdownRemark":{"html":"<p>No <a href=\"/2017/01/14/uma-ode-ao-docker-parte-1.html\" title=\"Uma ode ao Docker - Parte 1\"><em>post</em> anterior</a>\nfalamos sobre o <em>Docker</em>, e arranhamos um pouco sobre a diferença entre\nvirtualização com <em>Hypervisor</em> e <em>Container</em>. Nesse <em>post</em>,\nvamos explorar um pouquinho mais alguns conceitos, mostrando como funciona essa\nferramenta que é sensação quando o assunto é <em>virtual machines</em>.</p>\n<p>Mas antes, vamos relembrar o que é o <em>Docker</em>:</p>\n<blockquote>\n<p>\"Docker is an open platform for building, shipping and running distributed\napplications. It gives programmers, development teams, and operations engineers\nthe common toolbox they need to take advantage of the distributed and networked\nnature of modern applications.\"</p>\n</blockquote>\n<p>Em uma linguagem mais simples, <em>Docker</em> lhe dá a habilidade de executar\naplicações dentro de um ambiente controlado, conhecido como <em>Container</em>.\n<em>Containers</em> são similares às tradicionais máquinas virtuais, contudo, eles\ncompartilham o mesmo sistema operacional e provém um conjunto de comandos\nque permitem a execução e controle da sua aplicação ou processo.</p>\n<p><a href=\"https://www.youtube.com/watch?v=pGYAg7TMmp0\" title=\"Docker Tutorial - What is Docker &#x26; Docker Containers, Images, etc?\">Veja a diferença entre <em>Vagrant</em> e <em>Docker</em></a>.</p>\n<h2>Instalando</h2>\n<p>Talvez você se depare com alguns artigos na <em>Internet</em>, que ao falar sobre a\ninstalação do <em>Docker</em>, também mencionem <strong>boot2docker</strong> ou a necessidade do\n<strong>docker-machine</strong>. Houve um tempo onde utilizar <em>Docker</em> em máquinas\n<em>Windows</em> ou <em>OSX</em> não era tão trivial assim... mas esse tempo ficou para trás.</p>\n<p>Hoje, basta acessar a <a href=\"https://www.docker.com/community-edition#/download\" title=\"Baixe o Docker Community Edition\">página de <em>download</em></a>,\nselecionar o seu sistema operacional, e seguir o passo a passo\n(que geralmente consiste em uma série de \"next-next-finish\").</p>\n<p><a href=\"https://docs.docker.com/docker-for-mac/docker-toolbox/\" title=\"Docker for Mac vs. Docker Toolbox\">Entenda a diferença entre o Docker Toolbox e Docker for Mac</a>.</p>\n<p>Uma vez instalado, através do terminal execute o seguinte comando:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker images\n\nREPOSITORY   TAG   IMAGE  ID   CREATED   SIZE</code></pre></div>\n<p>Esse é o momento ideal para falarmos de outro conceito muito importante dentro\ndo <em>Docker</em>: <strong>Images</strong>.</p>\n<h2>Imagens</h2>\n<p>Segundo a documentação oficial:</p>\n<blockquote>\n<p>An image is a lightweight, stand-alone, executable package that includes\neverything needed to run a piece of software, including the code, a runtime,\nlibraries, environment variables, and config files.</p>\n</blockquote>\n<p>Ou seja, um <em>Docker Image</em> é um binário que inclui todos os requisitos\nnecessários para rodar um <em>Container</em>. Podemos pensar sobre esse\nconceito como uma tecnologia para empacotamento (ou até mesmo como uma espécie <em>snapshot</em>),\nonde não só definimos nossa distribuição <em>Linux</em> ou serviços utilizados\n(como <em>Postgres</em> ou <em>Nginx</em>, por exemplo), como também adicionamos a nossa própria aplicação\nao pacote.</p>\n<p>Uma imagem é imutável, ou seja, <em>read only</em>. Imagens\ngeralmente são compostas por outras camadas de imagens (<em>image layers</em>). Isso é um\n<em>approach</em> interessante, já que uma vez que uma camada seja baixada ela não precisará ser\nbaixada novamente, mesmo se outras imagens utilizarem da mesma camada:</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 610px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8e197844bf74ca6668d7b39d88ad54d5/073a0/docker-image-container.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.27083333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDBP/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAHZV1YuML//xAAZEAADAQEBAAAAAAAAAAAAAAABAgMAESH/2gAIAQEAAQUCardlQs3maI05hTv/xAAVEQEBAAAAAAAAAAAAAAAAAAAQIf/aAAgBAwEBPwGn/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAgMBAAAAAAAAAAAAAAAAAAEQETFB/9oACAEBAAY/AuFONZacf//EABoQAAIDAQEAAAAAAAAAAAAAAAERACFREEH/2gAIAQEAAT8hDIayVZSyMIyTcbjUD5fP/9oADAMBAAIAAwAAABDnz//EABcRAQADAAAAAAAAAAAAAAAAAAEQESH/2gAIAQMBAT8QC2x//8QAFhEBAQEAAAAAAAAAAAAAAAAAARAR/9oACAECAQE/EFMn/8QAHRABAQABBAMAAAAAAAAAAAAAAREAECExwUFRcf/aAAgBAQABPxABMCCn39xavMJHeBIJl0ocA8uXkpsB1p//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"&quot;Esquema representando o Sistema de Arquivo (docs.docker.com)&quot;\"\n        title=\"Esquema representando o Sistema de Arquivo (docs.docker.com)\"\n        src=\"/static/8e197844bf74ca6668d7b39d88ad54d5/073a0/docker-image-container.jpg\"\n        srcset=\"/static/8e197844bf74ca6668d7b39d88ad54d5/7809d/docker-image-container.jpg 192w,\n/static/8e197844bf74ca6668d7b39d88ad54d5/4ecad/docker-image-container.jpg 384w,\n/static/8e197844bf74ca6668d7b39d88ad54d5/073a0/docker-image-container.jpg 610w\"\n        sizes=\"(max-width: 610px) 100vw, 610px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Esquema representando o Sistema de Arquivo (docs.docker.com)</figcaption>\n  </figure></p>\n<p>Um <em>Docker Container</em> em vias práticas é uma \"instância\" da imagem... é o que a imagem se torna em memória\nao ser executada. De forma preguiçosa, podemos fazer a analogia com a <a href=\"/tag/oop.html\" title=\"Leia mais sobre OOP\">Orientação a Objetos</a>,\nonde a imagem pode ser comparada com uma classe, e a instância com um <em>Container</em>. Podemos ter\ntantos <em>containers</em> quanto necessário para uma mesma imagem.</p>\n<h2>Um pouco de prática</h2>\n<p>Vamos baixar a nossa primeira imagem <em>Docker</em>. Para isso, execute o seguinte comando:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker pull docker/whalesay</code></pre></div>\n<p>O comando <code class=\"language-text\">docker pull</code> fará o <em>download</em> da imagem <code class=\"language-text\">docker/whalesay</code>\npara o seu computador. Essa imagem está hospedada (por padrão) no <a href=\"https://hub.docker.com/r/docker/whalesay/\"><em>Docker Hub</em></a>,\numa espécie de \"Github para imagens Docker\".</p>\n<p><a href=\"https://hub.docker.com/\" title=\"Docker Hub\">Leia mais sobre o <em>Docker Hub</em></a>.</p>\n<p>É possível visualizarmos a imagem através do comando <code class=\"language-text\">docker images</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker images\n\nREPOSITORY         TAG       IMAGE ID        CREATED          SIZE\ndocker/whalesay    latest    6b362a9f73eb    23 months ago    247 MB</code></pre></div>\n<p>É uma prática comum o repositório/nome da imagem ser chamado de\n<code class=\"language-text\">&lt;repositório&gt;/&lt;nome de imagem&gt;</code>. Isso evita que haja duplicidade no <em>Docker Hub</em>. Para\nexecutar a imagem (e por consequência criar um <em>Container</em>), temos o comando <code class=\"language-text\">docker run</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker run docker/whalesay cowsay boo\n _____\n&lt; boo &gt;\n -----\n    \\\n     \\\n      \\\n                    ##        .\n              ## ## ##       ==\n           ## ## ## ##      ===\n       /&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;___/ ===\n  ~~~ {~~ ~~~~ ~~~ ~~~~ ~~ ~ /  ===- ~~~\n       \\______ o          __/\n        \\    \\        __/\n          \\____\\______/</code></pre></div>\n<p>Também é possível executarmos através do <code class=\"language-text\">ID</code> da imagem:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker run 6b362a9f73eb cowsay boo2</code></pre></div>\n<h2>Welcome to Nginx!</h2>\n<p>É claro que o <em>Docker</em> é muito mais poderoso do que isso. Por exemplo, vamos baixar o\n<a href=\"/tag/nginx.html\" title=\"Leia mais sobre o Nginx\"><em>Nginx</em></a> e ver como podemos receber uma simpática tela de \"It's working\":</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker pull nginx</code></pre></div>\n<p>Notou a ausência do <code class=\"language-text\">&lt;repositório&gt;/</code>? Repositórios oficiais no <em>Docker Hub</em> não necessitam\nde um prefixo, e você pode encontrá-los na interface <em>web</em> através do <em>path</em> <code class=\"language-text\">_/&lt;nome da imagem&gt;</code>.\nPor exemplo, o endereço do <em>Nginx</em> no <em>Docker Hub</em> é <a href=\"https://hub.docker.com/_/nginx/\">https://hub.docker.com/_/nginx/</a>.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 610px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fb8a561d8561fc395633a751c6b93aa5/5aae9/memento-docker.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAADnklEQVQozwGTA2z8AFhYVGdqaYaFh5iVl4+NjtXKx8nDwezr3eTj1ePh0+Xj1+Hc1NbPztTQ0crFyMbBwtHKzMrEx8e+wsO6vwDU1duvs7ucoa6NlaB4f4W0vMeSmqWiq7DY2tPZ08rSy8jSzMvHtrOXfHObh4bHwcTJxcrNyMu6tLikm6UA1dDRtLK0x8fKzNDQwMTC197eq7KztLu829/X5+vg5uzl2NjTsIyLmGJff1JIqp6Yu8DNq663zNHYpKayAGNiboJ8hYh/gZKSkl9iXrWyr9/b2tjV083My9TS0qWopmxiXI5kZpBjZYxgXWlNP35/gWJqdXB0eYKFigAWGRRTVFQxLyYmLSBUW1kxNTNycnNSUlE6Ojg0NDJpbnCHfICCU1WRX2KPX11gQjVfXFxub3JISUlHSksAUVNPcG1rTEtDOUAxWlpNZVpMYFtSRkg8PUA3ODs0YGVhdWdhgFZRek9IbkM6cU5Jem9nf3VzdXN0cnFwAGRmZGRiXXFtaHx4dnZwa29oXmllXGxpX21uZm5vaV5dUUBCPUlHR2lkXkoyJ11WUWFfV1pVSVlYS1VXUQBcXlpWVEtcVEiOhIOUh4Z+c2tPU0hhX1FoY1RjW0tcV0csMDNHREQvLi5wTkl1aWdpZmJyYlNxYE9vXlMAd2plfGxlhG9pgXFukYB/l4B6d2leeW5khnJilHxvjXFrODI1ISYpLCssVExWh3p/oYWDk3p0l3t3j3t/AH9wdIN1d4t7fYt6fI17fpeDhp6JjZ2JjJuJjKSEgn9bUzk0NS4tLxQSEEpHT42Bh5iIjZuLkJqHjYt4fwCBfYRmaXJucHdscXlqb3dscHdscXZzdXqYkpWAamI7JhovHhQ3IRg7IRplS0N2bm1oY2N6cnOIe31/dnoAu62wiISLVF1lXWZtXmhuXmhtWmVqZGtvfX6BVElDPTIoSkM6UjQkdEk7bE5AUlNKXFxXamdmZmNea2doAHl4fdjMyqilpmFpb2FqbmJqbl1ma319gXh6fSgtOjI2MTlFQS4lI1Q2JXRRRV1aU0tPR1BTS1JRSGRiYgBVXGF2eXuXlZZrcXRdZmphaWxtcHNscGxOWE0sMiwnLSUqMCgZIy0tKSVPRjxpaGRYWFFBRTxQT0hVVVIAUVpdS1ZaS1ZaVGBjVWFlX2doV11WPkc7LC8iIiMWISQYICEaHCYsLDQvPUU8SVBIYWFbWltWVVVPVFVTJc2TKg08qrQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"&quot;Assim como em Memento, o Docker também depende de imagens e tem memória curta (problemasfilosoficos.blogspot.com.br)&quot;\"\n        title=\"Assim como em Memento, o Docker também depende de imagens e tem memória curta (problemasfilosoficos.blogspot.com.br)\"\n        src=\"/static/fb8a561d8561fc395633a751c6b93aa5/5aae9/memento-docker.png\"\n        srcset=\"/static/fb8a561d8561fc395633a751c6b93aa5/8514f/memento-docker.png 192w,\n/static/fb8a561d8561fc395633a751c6b93aa5/804b2/memento-docker.png 384w,\n/static/fb8a561d8561fc395633a751c6b93aa5/5aae9/memento-docker.png 610w\"\n        sizes=\"(max-width: 610px) 100vw, 610px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Assim como em Memento, o Docker também depende de imagens e tem memória curta (problemasfilosoficos.blogspot.com.br)</figcaption>\n  </figure></p>\n<p>Vamos executar o <em>Nginx</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker run -p 5000:80 nginx</code></pre></div>\n<p>Mapemos a porta <code class=\"language-text\">5000</code> da nossa máquina para apontar para a porta <code class=\"language-text\">80</code> do <em>Container</em>. Logo, ao acessarmos\no <code class=\"language-text\">http://localhost:5000</code>, recebemos a simpática tela de boas vindas ao <em>Nginx</em>.</p>\n<p>Podemos dar um nome ao processo, e ainda executá-lo em modo <em>daemon</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker run --name docker-nginx -p 5000:80 -d nginx\n\n796ab2f0a662c045d0cfc99ff836a364a384406b8c6eaf03bcfb65e6cfd87751</code></pre></div>\n<p>O valor de retorno é o <em>ID</em> do <em>Container</em>. Note a presença dos parâmetros <code class=\"language-text\">--name</code> e <code class=\"language-text\">-d</code>.</p>\n<p>Para listar os <em>Containers</em> ativos, usamos o comando <code class=\"language-text\">ps</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker ps\n\nCONTAINER ID    IMAGE    COMMAND\n796ab2f0a662    nginx    &quot;nginx -g &#39;daemon ...&quot;\nCREATED           STATUS           PORTS                  NAMES\n12 seconds ago    Up 11 seconds    0.0.0.0:5000-&gt;80/tcp   docker-nginx</code></pre></div>\n<p>Para parar o serviço:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker stop docker-nginx</code></pre></div>\n<p>Pronto! Simples como as melhores coisas da vida.</p>\n<h2>Considerações finais</h2>\n<p>Lembro até hoje do momento em que ouvi falar sobre <em>Docker</em> pela primeira vez,\ne me questionei: Onde é que eu encaixo a minha ferramenta de provisionamento?</p>\n<p>Pois bem, não se faz necessário ter uma ferramenta de provisionamento uma vez que a sua\naplicação seja empacotada em uma imagem <em>Docker</em>. A forma de pensar no <em>deploy</em> da\naplicação muda, uma vez que ela esteja \"containerizada\".</p>\n<p>No próximo <em>post</em> da série vamos utilizar <em>Docker</em> em uma aplicação <a href=\"/tag/python.html\" title=\"Leia mais sobre Python\"><em>Python</em></a>\ne <a href=\"/tag/django.html\" title=\"Leia mais sobre Django\"><em>Django</em></a>, e nos deparar com\nalgumas peculiaridades de ambientes <em>Docker</em> (como por exemplo, os ambiente efêmeros).</p>\n<p>Até a próxima!</p>\n<h2>Referências</h2>\n<ul>\n<li><a href=\"https://docs.docker.com/get-started/\"><em>Docker Docs</em> - <em>Get started, Part 1: Orientation and Setup</em></a></li>\n<li><a href=\"http://www.mundodocker.com.br/o-que-e-uma-imagem/\"><em>MundoDocker</em> - O que é uma imagem?</a></li>\n<li><a href=\"https://docs.openshift.com/enterprise/3.0/architecture/core_concepts/containers_and_images.html#docker-images\"><em>Openshift</em> - <em>Docker images</em></a></li>\n<li><a href=\"https://semaphoreci.com/community/tutorials/dockerizing-a-python-django-web-application\"><em>Semaphore</em> - <em>Dockerizing a Python Django web Application</em></a></li>\n<li><a href=\"http://stackoverflow.com/questions/23735149/docker-image-vs-container\"><em>Stackoverflow</em> - <em>Docker image vs container</em></a></li>\n</ul>","excerpt":"No post anterior\nfalamos sobre o Docker, e arranhamos um pouco sobre a diferença entre\nvirtualização com Hypervisor e Container. Nesse post…","frontmatter":{"date":"2017-05-01T22:25:00.000Z","title":"Uma ode ao Docker - Parte 2","tags":["infraestrutura","virtualizacao","containerizacao","docker","nginx"],"thumbnail":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACEklEQVQ4y72Uy08TQRzH98/xBMYEEhA1PERiiB40IQYCJ+EAMRxIOMtDRUGFhkd4CQflYZoitJSC0GKgKhxQGxKrokB4P1pKuxRop19mhu5m2eqSVMIkv8zM7u/3md9rRsAZD+HcgKFQSJ4lUX7/L2CQRAlUGpEwSMtr9VoGhlTKyrHsFlE+OAP33kHEf7UNmwV1npiIBwEsbHux5fPD9mMVt5tGsLIjciOiggQIOQlUbg6DhK8dyy4OudduRc4rG7LaxuAS92XP1jx7KDVMyfrKAwR1GF3TcyijIT7o/YiiHjuXgjcTeGL5CqNjkevs+g+RWmtG8dtPaJ108n2Eh/uBIJbcPpToPyO3YxyF3Xbkv57gsPt0zumwodL8BaseEfbf67jbMoo7zaPQ2WZlTzmQhCv5c8ODay9MuKEbws16C9LrhpBGvUine7bO0FmQVmdGystBXHio5979rQMEKcmbXj+uU8PYSgNiqMRV9SOZGsdVvUP8034uidVGXHrcxw+e3/JyO+ZdRFGkfqt+78CVGhPyOj8gmxYjs2EYlykkqcaIxGcDiKkw4OpzEybn1rl+kJxSFNYu+pk/cK7tYNHlw63GER7exUcGJFAgC5Ol5hj2j8aWNsr++k6B35a2YXWuQGed5Yf8CoO0YMdAhYfklHvK/hMN2ImQ1fdYMmY3geWKaNxfzdcm2mfr/B/YaMcRA+XYxCUTdYQAAAAASUVORK5CYII=","width":180,"height":180,"src":"/static/e04fca1f269af5284f335b29e184323f/d8216/docker-logo-2.png","srcSet":"/static/e04fca1f269af5284f335b29e184323f/d8216/docker-logo-2.png 1x"}},"publicURL":"/static/e04fca1f269af5284f335b29e184323f/docker-logo-2.png"}},"fields":{"readingTime":{"minutes":5.585},"slug":"/2017/05/01/uma-ode-ao-docker-parte-2.html"}},"site":{"siteMetadata":{"author":{"name":"Klaus Peter Laube","gravatar":"https://en.gravatar.com/userimage/12163112/d3ae0c6239980b01ff1f1730b65c2ebe.jpg"},"siteUrl":"https://klauslaube.com.br"}}},"pageContext":{"slug":"/2017/05/01/uma-ode-ao-docker-parte-2.html"}}}