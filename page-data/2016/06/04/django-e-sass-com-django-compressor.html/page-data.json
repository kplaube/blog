{"componentChunkName":"component---src-templates-blog-post-js","path":"/2016/06/04/django-e-sass-com-django-compressor.html","result":{"data":{"markdownRemark":{"html":"<p>Eu sempre gostei da proposta do <code class=\"language-text\">django-compressor</code>: Concatenar e comprimir\nestáticos, utilizando como agrupadores os blocos da <em>engine</em> de <em>templates</em>\ndo <a href=\"/tag/django.html\" title=\"Leia mais sobre Django\"><em>Django</em></a>.\nAlém de manter a declaração dos <em>assets</em> no <a href=\"/tag/html.html\" title=\"Leia mais sobre HTML\"><em>HTML</em></a>,\nele ainda abre uma margem interessante para quando você precisa customizar um grupo\nde estáticos para uma determinada página.</p>\n<p>Com a chegada dos pré-processadores, como <a href=\"http://sass-lang.com/\" title=\"CSS with superpower\"><em>Sass</em></a>\ne <a href=\"http://coffeescript.org/\" title=\"CoffeeScript is a little language that compiles into JavaScript\"><em>CoffeeScript</em></a>,\ne fatalmente com o advento das ferramentas de <em>build</em>, deixar esse processo\npara o <em>Django</em> passou a ser questionável. É extremamente razoável passar toda\nessa responsabilidade para o <a href=\"/tag/grunt.html\" title=\"Leia mais sobre Grunt\"><em>Grunt</em></a>,\ne colocar apenas no seu <em>template</em> <em>Django</em> a <em>URL</em> do estático já \"buildado\".</p>\n<p>Na minha opinião, isso tira um pouco da vantagem descrita no primeiro parágrafo,\ne adiciona certa complexidade à nossa <em>stack</em> de desenvolvimento. Baseado nisso,\ne indo na <a href=\"/2016/02/22/vivendo-sem-o-grunt.html\" title=\"Vivendo sem o Grunt\">onda da simplificação de <em>build</em></a>,\nque eu resolvi devolver esse poder ao <em>Django</em>.\nE já te adianto: Estou relativamente satisfeito com o resultado!</p>\n<h2>Concat e minify sem Node.js</h2>\n<p>O <em>Django Compressor</em> é um <em>app</em> <em>Django</em> que comprime <em>Javascript</em>\nou <em>CSS</em>, em um único arquivo cacheável.</p>\n<p>Para usá-lo, começamos instalando através do <code class=\"language-text\">pip</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">::shell\n$ pip install django-compressor</code></pre></div>\n<p>Na sequência, precisamos adicioná-lo ao arquivo de configuração do seu projeto <em>Django</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">::python\n# settings.py\nINSTALLED_APPS = (\n    ...\n    &#39;compressor&#39;,\n    ...\n)</code></pre></div>\n<p>Não esqueça de adicioná-lo ao <code class=\"language-text\">STATICFILES_FINDERS</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">::python\n# settings.py\nSTATICFILES_FINDERS = (\n    &#39;django.contrib.staticfiles.finders.FileSystemFinder&#39;,\n    &#39;django.contrib.staticfiles.finders.AppDirectoriesFinder&#39;,\n    ...\n    &#39;compressor.finders.CompressorFinder&#39;,\n)</code></pre></div>\n<p>E no seu <em>template</em> <em>Django</em>, utilizamos a <code class=\"language-text\">templatetag</code> de compressão\npara <em>CSS</em> e <em>JS</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">::html\n&lt;!-- index.html --&gt;\n\n{% load compress %}\n{% load staticfiles %}\n\n{% compress css %}\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;{% static &#39;vendor/skeleton/normalize.css&#39; %}&quot; type=&quot;text/css&quot;&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;{% static &#39;vendor/skeleton/skeleton.css&#39; %}&quot; type=&quot;text/css&quot;&gt;\n{% endcompress %}\n\n{% compress js %}\n    &lt;script src=&quot;{% static &#39;vendor/jquery/jquery.js&#39; %}&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;{% static &#39;js/app.js&#39; %}&quot;&gt;&lt;/script&gt;\n{% endcompress %}</code></pre></div>\n<p>Quando o internauta acessar a sua página, o resultado final será parecido com esse:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;!-- index.html --&gt;\n\n&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/CACHE/css/0fb9d388202c.css&quot; type=&quot;text/css&quot;&gt;\n&lt;script type=&quot;text/javascript&quot; src=&quot;/static/CACHE/js/82f4dc99bcc1.js&quot;&gt;&lt;/script&gt;</code></pre></div>\n<p>Bacana, não? Como a opção <code class=\"language-text\">COMPRESS_ENABLED</code> é por padrão o inverso de <code class=\"language-text\">DEBUG</code>,\nem tempo de desenvolvimento você não verá os <em>assets</em> comprimidos,\nmas em tempo de <em>QA</em> e produção, se o seu <em>Django</em> estiver corretamente configurado,\nsim.</p>\n<h2>Pré-compiladores</h2>\n<p>Você não precisa do <em>Ruby</em> para utilizar <em>Sass</em>. Hoje, com o advento da especificação\ndo <em>libsass</em>, é possível ter a ferramenta em diferentes linguagens, como\n<a href=\"/tag/node.html\" title=\"Leia mais sobre Node.js\"><em>Node.js</em></a> e <a href=\"/tag/python.html\" title=\"Leia mais sobre Python\"><em>Python</em></a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">::shell\n$ pip install libsass</code></pre></div>\n<p>O <code class=\"language-text\">django-compressor</code> dá suporte a execução de compiladores/transpiladores dado um\ndeterminado <code class=\"language-text\">type</code>. Vamos ilustrar esse cenário com o uso de <em>Sass</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">::python\n# settings.py\nCOMPRESS_PRECOMPILERS = (\n    (&#39;text/x-sass&#39;, &#39;sassc {infile} {outfile}&#39;),\n)</code></pre></div>\n<p>O binário <code class=\"language-text\">sassc</code> foi instalado no comando <code class=\"language-text\">pip install</code> acima. O parâmetro <code class=\"language-text\">infile</code>\nserá o próprio arquivo <code class=\"language-text\">scss</code>, e <code class=\"language-text\">outfile</code> será a saída do arquivo, já compilado para <em>CSS</em>.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 620px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4911baf4d5081e0d229de140f03d2a02/935bc/django-style.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.14583333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAwH/2gAMAwEAAhADEAAAAc+wTSFP/8QAGBABAAMBAAAAAAAAAAAAAAAAAQACEhP/2gAIAQEAAQUCwESpfkT/xAAXEQADAQAAAAAAAAAAAAAAAAAAARIR/9oACAEDAQE/AZWEo//EABYRAQEBAAAAAAAAAAAAAAAAAAEAEv/aAAgBAgEBPwEW03//xAAWEAEBAQAAAAAAAAAAAAAAAAAAITH/2gAIAQEABj8CVr//xAAaEAACAgMAAAAAAAAAAAAAAAAAASExEUFR/9oACAEBAAE/IVPddZgjTSkbNj//2gAMAwEAAgADAAAAEA//AP/EABcRAQADAAAAAAAAAAAAAAAAAAABESH/2gAIAQMBAT8QjIof/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQBh/9oACAECAQE/EFI21//EABsQAQACAwEBAAAAAAAAAAAAAAERIQBBcTFh/9oACAEBAAE/EAteaGJ+G8RR0UBDte4rMfS8/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"&quot;Django com estilo!&quot;\"\n        title=\"Django com estilo!\"\n        src=\"/static/4911baf4d5081e0d229de140f03d2a02/935bc/django-style.jpg\"\n        srcset=\"/static/4911baf4d5081e0d229de140f03d2a02/7809d/django-style.jpg 192w,\n/static/4911baf4d5081e0d229de140f03d2a02/4ecad/django-style.jpg 384w,\n/static/4911baf4d5081e0d229de140f03d2a02/935bc/django-style.jpg 620w\"\n        sizes=\"(max-width: 620px) 100vw, 620px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Django com estilo!</figcaption>\n  </figure></p>\n<p>Agora, a jogada será declarar em nosso <em>template</em> que todas as folhas de estilo escritas\nem <em>Sass</em>, terão como <code class=\"language-text\">type</code> o valor <code class=\"language-text\">text/x-sass</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">::html\n&lt;!-- index.html --&gt;\n\n{% compress css %}\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;{% static &#39;vendor/skeleton/normalize.css&#39; %}&quot; type=&quot;text/css&quot;&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;{% static &#39;vendor/skeleton/skeleton.css&#39; %}&quot; type=&quot;text/css&quot;&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;{% static &#39;scss/app.scss&#39; %}&quot; type=&quot;text/x-sass&quot;&gt;\n{% endcompress %}</code></pre></div>\n<p>A partir de agora, no momento de execução do <em>Compressor</em>, além de minificar e concatenar\nas folhas de estilo, também interpretará arquivos <em>Sass</em>.</p>\n<h2>Considerações finais</h2>\n<p>E com isso, mais uma vez, mostramos que é possível ter um projeto <a href=\"/tag/desenvolvimento-web.html\" title=\"Leia mais sobre web\"><em>web</em></a>,\nutilizando ferramentas bacanas (como o <em>Sass</em>), sem necessariamente\nadicionar uma linguagem diferente à sua <em>stack</em>.</p>\n<p>O ideal é que o processo de <em>build</em> seja executado durante o procedimento\nde <em>deploy</em> do seu projeto (através do comando <code class=\"language-text\">python manage.py compress</code>). Para isso,\né necessário ativar o\n<a href=\"http://django-compressor.readthedocs.io/en/latest/scenarios/#offline-compression\" title=\"Offline compression\"><em>offline compression</em> do <em>Django Compressor</em></a>.</p>\n<p>No próximo <em>post</em> vamos falar sobre <em>Django</em> + <em>ES6</em>.</p>\n<p>Até a próxima...</p>\n<h2>Referências</h2>\n<ul>\n<li><a href=\"https://django-compressor.readthedocs.io/en/latest/\"><em>Django Compressor - Compresses linked and inline JavaScript or CSS into a single cached file</em></a></li>\n<li><a href=\"https://hongminhee.org/libsass-python/\"><em>libsass - Sass/SCSS for Python</em></a></li>\n</ul>","excerpt":"Eu sempre gostei da proposta do : Concatenar e comprimir\nestáticos, utilizando como agrupadores os blocos da engine de templates\ndo Django…","frontmatter":{"date":"2016-06-04T16:00:00.000Z","title":"Django e Sass com django-compressor","tags":["desenvolvimento-web","python","django","sass","css"],"thumbnail":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAADT0lEQVQ4y21T+U9TQRDuf4I/iFoEEayAIpWzRhOJxKCiHAXKERINEAViOQU1KBTkCCCnLfWAcKUklENMOFSQo0WQlkKhgFyF0lIptH2H81hCBZns28zM7rff7Df7aBcivf8fjEhv+3APm5ArMMCBjC3bzYbtahfKZET6XIxmWT9wLmmpoR0LduB4esTeupMeAcM91g8yvk+DbqeE3kgMYET5WAc6FzSWkyR5DNgp+tqpQJcsQR65Z1l8nmOE17J6FfxhmfTkA+eCBgqJYdgxYJeY62eCLz+vzUfgTH4ulKrZ0oI/ODlS3FQFDo7jBEHQjnBejGI5RHhZ3XPMeJezzyzg2Ye7i/rau0f6NnQagiSQHSobLkMPcT3LdmM99nd7eDO3rgSBXwrf0IMv27GZvE9UxoxhCGkBAxJK5byK+zY+tLa5rvuztbWtxwkcMdNDr0imxsE/4LSAQXp6sGti6TOUP1iGi8GcUp2dwctECv2LpMDAeZ7jyXzku7i2BLHRbHorEvgls2s76tGOrjzBcg9Fi5sx8rDRgBYKjslLQLF4oBuaYXXXMb36FYRzH3qUBWKCKgc+8ijYKZp1OuhSamU2inl1pefC3W1DmRn8XH2vYqamGxESOLG7qsVN2DHg+OJUFDf3tp3wdzjDcRO215NaI5Cpeye3ZIvb82rpE75ZZ9hXBcNhpu58LuwqvDtQGPIms+l1c1kWlztX2G7c0OMm81Bkycb3qYX6b2NJtfiuCTeaMYPxqNqFDRUopemYmCvqUAl7lOVdmhHlrxeNisK2jQGFsvLzTFnnYsPAbM2X3y0/sB2Tpc92YVefFKetyedGkwTrw9PTxWI5T7TUOqSbWJDE1+ysaqeLxPIcESpbM6xc6ZTS0A/oFMWy4TC53ITFxgFlRZe6b3L0UaXsdYtWqloRS6QJgvmP/VO8VuBHYFBO3SejMfbKtr7vXNopNAypFj59VVZ1jyXWynNFU/mt+unlibQ60MzwW6NXLCMkJY1226jRU322DnAqbKogcVKa/H7zp2pXrVvvl5l027ADOgQKHfQGQkujQG3oSmpcvCK9QcIVLjQP7p9N/DPDhMEZONUeC5AyWlkrn9wlNyWzhiWNZQEn9sD/vanD9heHhEcK9wIrgwAAAABJRU5ErkJggg==","width":180,"height":180,"src":"/static/3ba26ca8bb1b97ce0946832f20aaba53/d8216/django-sass-logo.png","srcSet":"/static/3ba26ca8bb1b97ce0946832f20aaba53/d8216/django-sass-logo.png 1x"}},"publicURL":"/static/3ba26ca8bb1b97ce0946832f20aaba53/django-sass-logo.png"}},"fields":{"readingTime":{"minutes":3.38},"slug":"/2016/06/04/django-e-sass-com-django-compressor.html"}},"site":{"siteMetadata":{"author":{"name":"Klaus Peter Laube","gravatar":"https://en.gravatar.com/userimage/12163112/d3ae0c6239980b01ff1f1730b65c2ebe.jpg"},"siteUrl":"https://klauslaube.com.br"}}},"pageContext":{"slug":"/2016/06/04/django-e-sass-com-django-compressor.html"}}}