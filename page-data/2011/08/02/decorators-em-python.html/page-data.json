{"componentChunkName":"component---src-templates-blog-post-js","path":"/2011/08/02/decorators-em-python.html","result":{"data":{"markdownRemark":{"html":"<p>E na mesma linha dos <a href=\"/2011/05/29/afinal-o-que-sao-closures.html\" title=\"Afinal, o que são Closures?\"><em>closures</em></a>, eu passei a\nsaber realmente o que são <em>decorators</em> depois de utilizar o <em>framework</em>\n<a href=\"/tag/django.html\" title=\"Leia mais sobre Django\"><em>Django</em></a>. Se você está trabalhando com <a href=\"/tag/oop.html\" title=\"Leia mais sobre OOP\">Orientação a Objetos</a> e\naté agora não se deparou com este recurso, te garanto que um dia você\nprecisará dele… afinal, é um dos <a href=\"http://pt.wikipedia.org/wiki/Padr%C3%A3o_de_projeto_de_software\" title=\"Conheça os Design Patterns\"><em>Design Patterns</em></a> mais bacanas (e\núteis) que já vi.</p>\n<p>Vamos lá “decorar” nossos métodos <a href=\"/tag/python.html\" title=\"Leia mais sobre Python\"><em>Python</em></a>!</p>\n<h2>Decoradores? Really?</h2>\n<p>Eu não saberia explicar de uma forma melhor do que foi explicado pela\n<a href=\"http://pt.wikipedia.org/wiki/Decorator\" title=\"Leia mais sobre o pattern Decorator\"><em>Wikipedia</em></a>, o que é o padrão decorator:</p>\n<ul>\n<li><strong>Intenção:</strong> Acrescentar responsabilidades a um objeto\ndinamicamente. Prover alternativa flexível ao uso de subclasses para\nse estender a funcionalidade de uma classe;</li>\n<li><strong>Motivação:</strong> Objeto usado possui as funcionalidades básicas, mas é\nnecessário adicionar funcionalidades adicionais a ele que podem\nocorrer antes ou depois da funcionalidade básica. Funcionalidades\ndevem ser adicionadas em instancias individuais e não na classe;</li>\n<li><strong>Consequências:</strong> Mais flexibilidade do que herança.</li>\n</ul>\n<p>Encontramos na <a href=\"http://wiki.python.org/moin/FrontPage\" title=\"Wiki oficial da linguagem Python\"><em>Wiki</em> do <em>Python</em></a> uma explicação mais objetiva e\nesclarecedora:</p>\n<blockquote>\n<p>Decorators alteram dinamicamente a funcionalidade de uma função,\nmétodo ou classe, sem uso direto de subclasses ou alterando o\ncódigo-fonte da função “decorada”.</p>\n</blockquote>\n<h2>O uso de decorators em Python</h2>\n<p>O <em>Python</em> começou a dar suporte a <em>decorators</em> a partir da <strong>versão\n2.4</strong>.</p>\n<p>Você terá a sua disposição alguns decoradores <em>built-in</em> e também poderá\ncriar os seus próprios sem muito dificuldade. É possível identificar um\n<em>decorator</em> através do caractere <code class=\"language-text\">@</code>, por exemplo, a instrução abaixo\ndeclara o método <code class=\"language-text\">say_hello</code> da classe <code class=\"language-text\">People</code> como estático:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">People</span><span class=\"token punctuation\">:</span>\n  <span class=\"token decorator annotation punctuation\">@staticmethod</span>\n  <span class=\"token keyword\">def</span> <span class=\"token function\">say_hello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span> <span class=\"token string\">'Hello!'</span></code></pre></div>\n<p>Vale notar que podemos reproduzir o comportamento acima sem utilizar a\nsintaxe especial de <em>decorators</em> (mas não deixamos de utilizar o\nconceito):</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">People</span><span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">def</span> <span class=\"token function\">say_hello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span> <span class=\"token string\">'Hello!'</span>\n  say_hello <span class=\"token operator\">=</span> <span class=\"token builtin\">staticmethod</span><span class=\"token punctuation\">(</span>say_hello<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Quer conhecer mais sobre <em>decorators</em> em <em>Python</em>? Leia a\n<a href=\"http://www.python.org/dev/peps/pep-0318/\" title=\"Leia mais sobre a PEP318\"><em>PEP 318 – Decorators for functions and methods</em></a>.</p>\n<h2>Um pouco de prática</h2>\n<p>Vamos por a mão na massa e criar o nosso próprio <em>decorator</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># meu_decorator.py</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">meu_decorador</span><span class=\"token punctuation\">(</span>alvo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">def</span> <span class=\"token function\">wrapper</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span> <span class=\"token string\">'Chamando a funcao \"%s\"'</span> <span class=\"token operator\">%</span> alvo<span class=\"token punctuation\">.</span>__name__\n    <span class=\"token keyword\">return</span> alvo<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> wrapper\n\n<span class=\"token decorator annotation punctuation\">@meu_decorador</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">meu_alvo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">print</span> <span class=\"token string\">'Eu sou um alvo!'</span>\n\nmeu_alvo<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Chamando o <em>script</em> acima, teremos o seguinte resultado:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ python meu_decorator.py\n\nChamando a funcao \"meu_alvo\"\nEu sou um alvo!</code></pre></div>\n<p>Vou tentar seguir um fluxo que deixe claro o que o procedimento está\nrealizando.</p>\n<p>O comportamento da função <code class=\"language-text\">meu_alvo</code> é muito simples: imprimir <code class=\"language-text\">“Eu sou um alvo!”</code> na tela. Mas o <code class=\"language-text\">@meu_decorador</code> está lá para\ncomplicar a nossa vida :D</p>\n<p>Com a chamada de <code class=\"language-text\">@meu_decorador</code> logo acima de <code class=\"language-text\">meu_alvo</code>, fica\nclaro que na verdade estamos passando <code class=\"language-text\">meu_alvo</code> como um parâmetro\n(<code class=\"language-text\">alvo</code>) para o método <code class=\"language-text\">meu_decorador</code>, encontrado logo no início\ndo arquivo. Note que o método retorna <code class=\"language-text\">wrapper</code> sem os parênteses no\nfinal (que caracterizam uma chamada de função), ele está retornando\napenas a referência ao método <code class=\"language-text\">wrapper</code>, que será de fato “executado”\nexternamente.</p>\n<p>Dentro da função <code class=\"language-text\">wrapper</code> temos a impressão da <em>string</em> <code class=\"language-text\">‘Chamando a funcao “meu_alvo”‘</code> e a execução de <code class=\"language-text\">meu_alvo</code>. Isto deve-se ao\nfato de que <code class=\"language-text\">alvo</code> nada mais é que uma referência a função\n<code class=\"language-text\">meu_alvo</code>, que passamos como argumento para <code class=\"language-text\">meu_decorador</code>\natravés do <code class=\"language-text\">@meu_decorador</code> logo acima da função <code class=\"language-text\">meu_alvo</code>,\ncerto?</p>\n<p>Então resumindo isso tudo, o resultado final é que <code class=\"language-text\">meu_alvo()</code> no\nfinal do arquivo na verdade é a execução da referência a <code class=\"language-text\">wrapper</code>, ou\nseja, é o mesmo que ler <code class=\"language-text\">“wrapper()“</code>. Ele fará o <em>print</em> e\nposteriormente retornará o resultado de <code class=\"language-text\">meu_alvo</code>, que nada mais é\nque a impressão de <code class=\"language-text\">“Eu sou um alvo!”</code>.</p>\n<p>Bacana não? Aqui vai mais um para deixar as coisas um pouco mais claras…\nvamos simular o esquema de roteamento de um <em>framework</em> <a href=\"/tag/desenvolvimento-web.html\"><em>web</em></a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">rotas <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">rota</span><span class=\"token punctuation\">(</span>endereco<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">def</span> <span class=\"token function\">wrapper</span><span class=\"token punctuation\">(</span>fn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    rotas<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>endereco<span class=\"token punctuation\">,</span> fn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> wrapper\n\n<span class=\"token decorator annotation punctuation\">@rota</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/index/'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">home_view</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">return</span> <span class=\"token string\">'Pagina inicial'</span>\n\n<span class=\"token decorator annotation punctuation\">@rota</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/contato/'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">contato_view</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">return</span> <span class=\"token string\">'Pagina de contato'</span>\n\n<span class=\"token keyword\">print</span> rotas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># Pagina inicial</span>\n<span class=\"token keyword\">print</span> rotas<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># Pagina de contato</span>\n<span class=\"token keyword\">print</span> rotas\n<span class=\"token comment\"># [('/index/', &lt; function home_view at 0xb736580c >),</span>\n<span class=\"token comment\">#  ('/contato/', &lt; function contato_view at 0xb7365b8c >)]</span></code></pre></div>\n<h2>Referências</h2>\n<ul>\n<li><a href=\"http://devlog.waltercruz.com/python_decorators\" title=\"Walter Cruz em um excelente post sobre Decorators em Python\"><em>Devlog – @decorators</em></a></li>\n<li><a href=\"http://www.fiveminutes.eu/a-quick-introduction-to-python-decorators/\" title=\"Uma introdução rápida aos decorators em Python. Muito bom!\"><em>Five Minutes – A quick introduction to Python decorators</em></a></li>\n<li><a href=\"http://www.python.org/workshops/1997-10/proceedings/savikko.html\" title=\"Padrões de Projetos em Python.\"><em>Python.org – Design Patterns in Python</em></a></li>\n<li><a href=\"http://wiki.python.org/moin/PythonDecorators\" title=\"Decorators em Python, direto da Wiki oficial do Python\"><em>Python.org – Python Decorators</em></a></li>\n<li><a href=\"http://www.siafoo.net/article/68\" title=\"Decorators em Python não precisam ser assustadores. Um ótimo artigo.\"><em>Siafoo – Python Decorators Don’t Have to be (that) Scary</em></a></li>\n<li><a href=\"http://pt.wikipedia.org/wiki/Decorator\" title=\"Leia mais na Wikipedia sobre Decorators\"><em>Wikipedia – Decorator</em></a></li>\n</ul>\n<p>Até a próxima…</p>","excerpt":"E na mesma linha dos closures, eu passei a\nsaber realmente o que são decorators depois de utilizar o framework\nDjango. Se você está…","frontmatter":{"date":"2011-08-02T20:00:00.000Z","title":"Decorators em Python","tags":["python","oop","design-patterns","decorators"],"thumbnail":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADT0lEQVQ4y4WU+09UVxDH9y9pY1KrhaX6Q3UtaCGYGE2spvqD8dGmglJFl5UGtCQqpiY0MdTXFZTnEl/4aFXESAGDSKMReSpoQSMLVLE+ipooMeu95+Pcvfcuu2vESSZnN3fO53xn5sxxKaX4kOuGEe26gSGraU5MrLkmAn7IjIhvsXGu2ODIgKabQxRf6GTP2Vb2nLmOv76L3sDjiRXGwnQ7pcNNt8nQ6vmhsJbJ6QeJzzjI1DSN6T8V0dw9EIoxY8NQew2lbNgfzICgbgHT99VT2dhDycUuJv1YROKmSmZvqmDq6n1srWy0gPpb2Sd7baDJCNfQMKLlm7AVu2rJ2F9H2u7aENDjLSM+fT/5VZcsoMlxYPYaStmB3Rp8Rt6Ra2RXXGGzv4Ut/ivk+ZvJLmkgKduPZ2OpADXy/Rfh0V70O17U/812ypZSl9OxR6OvSdlew+cbjuL2HiUuswp3ph/3+nIS1pXiyaogyVeOe43G1rLz0LcM/e/PUDeSUW9G7DIauJwmnLk+wBRvNUl5fzBr80m+zj3OdK+fhPVlAiwhfm0xCWs1Pl11gJKzUsO+peitSairbtSTWhuom0BL4YG6XuJ8J5i15TQzcqqZ5jvG8sJL+Epb8B66TNahJjK1BnafusxY/05om4lqSwYTOFxs11AfV1j0lwVM/OU0X/qq0Wpa4L+9MJwjngtDP8Og+L3voT1RYN8IdI4FHNLeB55vG+SLrGo8uSdYWNDI2L/l0JvM2+55GF2pGJ0pGO1z0AWkOuYKNEWg4lfjo1N2mvL4xRip+TV8sqaSbwsaeBP4TYALULeXoHoWorpTUZ3SgPbZcEPSbf1K1MXJ/3mo4PPxpkRem+7AU7Ydv4ZW109wuFCA81G9i8S/QwV2QGAn6n4+akBqOFAgv39FvewIw8KTEjvwIXvwuyhbINDFsor3r4O7cu/urIaRKgsSHlnrDkZNiqPUHCfzLPVAFN6aKykvDUHp8MCTPwV2GHU3x4IZwajRC0+KA7Tg9mmvelB9K1E3U6UW4h3S2X/SJM1tkmb7uLLYx+G95ytiNlVwFDXagBqpsPzpOZmKh1GjNuHz5chW9gbnABVRr8iaOfEff2AdhSZU7pbjKuTRz1WsvQOAZnfm2TGBHwAAAABJRU5ErkJggg==","width":180,"height":180,"src":"/static/7f2a92f8e64d5340552525c4391133b2/d8216/python-logo.png","srcSet":"/static/7f2a92f8e64d5340552525c4391133b2/d8216/python-logo.png 1x"}},"publicURL":"/static/7f2a92f8e64d5340552525c4391133b2/python-logo.png"}},"fields":{"readingTime":{"minutes":4.325},"slug":"/2011/08/02/decorators-em-python.html"}},"site":{"siteMetadata":{"author":{"name":"Klaus Peter Laube","gravatar":"https://en.gravatar.com/userimage/12163112/d3ae0c6239980b01ff1f1730b65c2ebe.jpg"},"siteUrl":"https://klauslaube.com.br"}}},"pageContext":{"slug":"/2011/08/02/decorators-em-python.html"}},"staticQueryHashes":["2831923220","4114525740"]}