<!DOCTYPE html><html lang=pt-br> <head><meta charset=utf-8><title>O API-First | Klaus Laube</title><meta name=author content="Klaus Peter Laube"><meta name=description content='Tratar APIs como "first-class citizens" pode ser um desafio e tanto, principalmente quando estamos em um contexto de entrega rápida ou de prova de...'><meta name=robots content=index,follow><meta property=og:site_name content="Klaus Laube"><meta property=og:type content=website><meta name=keywords content="desenvolvimento, web, rest, apis, api-first"><meta property=og:title content="O API-First"><meta property=og:description content='Tratar APIs como "first-class citizens" pode ser um desafio e tanto, principalmente quando estamos em um contexto de entrega rápida ou de prova de...'><meta property=og:url content=https://klauslaube.com.br/2020/02/21/o-api-first.html><meta property=og:image content=https://klauslaube.com.br//images/blog/captain-ux.jpg><meta property=fb:app_id content=262757647133878><meta name=google-site-verification content=xCq0H3B3JhkPcAdZ03J0vayijvH_g1rQVMZ_DVcMsQY><meta name=viewport content="width=device-width, initial-scale=1.0"><link rel=icon type=image/x-icon href=https://klauslaube.com.br/favicon.ico><link rel=alternate type=application/rss+xml title="Klaus Laube » Feed" href=https://klauslaube.com.br/feed/rss.xml><link rel=canonical href=https://klauslaube.com.br/2020/02/21/o-api-first.html><link rel=stylesheet href=https://unpkg.com/purecss@1.0.0/build/pure-min.css integrity=sha384-nn4HPE8lTHyVtfCBi5yW9d20FjT8BJwUXyWZT9InLYax14RDjBj46LmSztkmNP9w crossorigin=anonymous><link rel=stylesheet href=https://klauslaube.com.br/theme/css/styles.min.css?0830b1e2></head> <body> <div class="Page pure-g is-fullEntry"> <div class="PageHeader pure-u-1"> <nav class="pure-menu pure-menu-open pure-menu-horizontal"> <a href=https://klauslaube.com.br/index.html title="Home page" class="PageHeader-link pure-menu-heading pure-menu-link">Klaus<span class=u-highlighted>Laube</a> <ul class="PageHeader-menu pure-menu-list"> <li class=pure-menu-item> <a href=https://about.me/klauslaube class="PageHeader-menu-link pure-menu-link">Contato</a> </li> </ul> </nav> </div> <div class="PageContent pure-u-1"> <article class="Article u-box" itemscope itemtype=http://schema.org/BlogPosting> <div itemprop=image itemscope itemtype=http://schema.org/ImageObject> <meta itemprop=url content=https://klauslaube.com.br//images/blog/captain-ux.jpg> </div> <span itemprop=mainEntityOfPage> <header> <h1 class=Article-title itemprop="headline name"> O API-First </h1> <p class=Article-meta> Por <span class=Article-author itemprop=author>Klaus Peter Laube</span>. <span class=Article-pubDate> Publicado em <time datetime=2020-02-21T09:15:00-03:00 itemprop=datePublished>21 Fev, 2020</time> </span> </p> </header> <div class=Article-content itemprop=articleBody> <img src=/images/blog/rest-api-logo.png alt=API class=representative-image width=180 height=180> <p>Tratar <em>APIs</em> como "first-class citizens" pode ser um desafio e tanto, principalmente quando estamos em um contexto de entrega rápida ou de prova de conceito. Como desenvolvedor, admito que priorizo resolver a lógica de negócio escrevendo código, do que discutindo contratos ou requisitos não funcionais.</p> <!-- PELICAN_END_SUMMARY --> <h2>Code-First</h2> <p>O modelo de trabalho ilustrado acima pode ser conhecido por "bottom up", "code first", ou apenas por "aquela forma que a gente geralmente utiliza em nossos projetos". Onde focamos primeiro no código, e deixamos para depois questões relacionadas à integração dos componentes.</p> <p><em>Kirsten Hunter</em> <a href=https://www.programmableweb.com/news/introduction-to-api-first-design/analysis/2016/10/31 title="Introduction to API-First Design">ilustra bem os efeitos colaterais de tal prática</a>:</p> <blockquote> <p>APIs are created as an afterthought once the product has already been created as a tightly coupled system, with the frontend website and backend system entwined together in a highly codependent way and the REST API having to be ‘shoe-horned’ into this system as a separate entity.</p> </blockquote> <p>Não há nada fundamentalmente errado com essa dinâmica (inclusive, <a href="https://www.youtube.com/watch?v=Tb823aqgX_0" title="Bottom Up vs Top Down Design in Clojure">há opiniões a favor desse conceito</a>), mas com o mundo cada vez mais "microservices-driven", pensar primeiramente na interface e em quem irá usá-la pode antecipar problemas, diminuir riscos e definir contratos mais sólidos.</p> <p><img class=align-center src=/images/blog/captain-ux.jpg width=640 height=320 title="Não faça o dev ser merecedor para utilizar a sua API (comicbookmovie.com)" alt="Não faça o dev ser merecedor para utilizar a sua API (comicbookmovie.com)"></p> <p>Não é raro escutarmos em pleno 2020 histórias sobre times distintos trabalhando em uma grande solução, que quando colocaram seus serviços para funcionar juntos, descobriram uma série de problemas de integração (ou até mesmo que eles simplesmente não resolviam o problema).</p> <h2>O que é API-First?</h2> <p><em>API-First</em> pode ser grosseiramente resumido em "trate APIs como first-class citizens".</p> <p>Em outras palavras, a proposta é que <em>APIs</em> sejam consideradas partes fundamentais do ecossistema de um produto, devem ser parte de sua estratégia e construção, e não apenas um "extra" ou um "side product".</p> <p>O <em>DZone</em> define <em>API-First</em> da <a href=https://dzone.com/articles/an-api-first-development-approach-1 title="An API-First Development Approach">seguinte forma</a>:</p> <blockquote> <p>(...) is a strategy in which the first order of business is to develop an API that puts your target developer’s interests first and then build the product on top of it (be it a website, mobile application, or a SaaS software). By building on top of APIs with developers in mind, you and your developers are saving a lot of work while laying down the foundations for others to build on.</p> </blockquote> <p>Elas devem ser tão cruciais quanto usuários são em estratégias <em>user-centric</em> e a experiência <em>mobile</em> é em um <em>approach</em> <em>mobile-first</em>. Utilizar uma abordagem <em>api-centric</em> fará com que o <em>design</em> funcione de uma ótica diferente (possibilitando maior cuidado em relação a consistência e reuso), e que o negócio gire em torno do contrato que está sendo definido (ocasionando maior interação com outros <em>stakeholders</em> de forma antecipada, dentro do tempo de vida de desenvolvimento).</p> <h3>API-centric == Developer Experience</h3> <p>E se pararmos para analisar friamente o que essa ideia significa, ser <em>api-centric</em> é no fim das contas ser <em>user-centric</em> (ou <em>customer-centric</em>).</p> <p><img class=align-center src=/images/blog/thor-ux.png width=740 height=309 title="Não duvide da vontade do seu usuário. Ele vai descobrir um jeito de levantar o martelo (ibtimes.com)" alt="Não duvide da vontade do seu usuário. Ele vai descobrir um jeito de levantar o martelo (ibtimes.com)"></p> <p>O usuário nesse caso passa a ser outro desenvolvedor (do mesmo time, da mesma empresa, ou de terceiros), portanto, <em>Developer eXperience</em> também é parte fundamental dessa estratégia, e vem embutida em sua prática, como ilustra o <a href=https://swagger.io/resources/articles/adopting-an-api-first-approach/ title="Leia mais no Swagger.io">"Understanding the API-First Approach to Building Products"</a>:</p> <blockquote> <p>Consumers of APIs are most often developers, and developer experience (DX) can make or break the success of an API. API first ensures that developers have positive experiences using your APIs. Well-designed, well-documented, consistent APIs provide positive developer experiences because it’s easier to reuse code and onboard developers, and it reduces the learning curve.</p> </blockquote> <h2>Os 3 princípios</h2> <p><em>Lars Trieloff</em>, no <a href=https://medium.com/adobetech title="Leia o blog de tecnologia da Adobe"><em>Adobe Tech Blog</em></a>, escreve sobre <a href=https://medium.com/adobetech/three-principles-of-api-first-design-fa6666d9f694 title="Veja mais no Adobe Tech Blog">três princípios fundamentais para o sucesso da prática</a>, que acredito serem essenciais para compreender a real motivação por trás da ideia.</p> <h3>1. Your API is the first user interface of your application</h3> <p>Vale estressar esse ponto: Pessoas utilizando a sua <em>API</em> são os seus usuários, e a sua <em>API</em> precisa ser projetada com esses usuários em mente.</p> <p>Partindo do princípio que a <em>API</em> é o caminho mais importante de interação com o seu produto, isso significa que ela deve ter um investimento de tempo equivalente (ou superior) ao tempo investido no desenvolvimento de (por exemplo) interfaces gráficas.</p> <h3>2. Your API comes first, then the implementation</h3> <blockquote> <p>Your implementation will change frequently, your API should not.</p> </blockquote> <p>Sua <em>API</em> se torna um contrato que servirá como especificação para a implementação, portanto, o ideal é pensarmos como duas coisas separadas. Conforme a sua aplicação for evoluindo é muito provável que a sua implementação mude, mas o contrato deve (dentro do possível) manter-se o mesmo.</p> <h3>3. Your API is described (and maybe even self-descriptive)</h3> <p>Sua <em>API</em> precisa ser compreendida por pessoas que não estavam envolvidas em seu desenvolvimento. E aqui é difícil escaparmos da necessidade de documentação.</p> <p>E por documentação, é impossível deixar de questionar todo o esforço envolvido em ter uma documentação válida, atualizada, e que deveras é usável. Ferramentas estão disponíveis, e existem diferentes formas de automatizar esse processo. Tais ferramentas servem não somente para a criação de documentação, mas também da especificação em si (que pode ser também consumida por uma máquina). Por exemplo, <a href=https://klauslaube.com.br/tag/raml.html title="Leia mais sobre RAML"><em>RAML</em></a> e <a href=https://klauslaube.com.br/tag/swagger.html title="Leia mais sobre Swagger"><em>Swagger</em></a>, já abordados no <em>blog</em>, são excelentes iniciativas para resolver essa questão.</p> <p><img class=align-center src=/images/blog/thor-ux-2.jpg width=597 height=300 title="Se o Thor tivesse uma documentação bacanuda para como funciona o martelo, Caps teria usado antes (cinemablend.com)" alt="Se o Thor tivesse uma documentação bacanuda para como funciona o martelo, Caps teria usado antes (cinemablend.com)"></p> <p>Mas além disso, seguir padrões é outro esforço que trará resultados na usabilidade da <em>API</em>:</p> <blockquote> <p>When it comes to documentation for APIs, structured documentation beats unstructured documentation. Following a standard pattern for URLs, resource types, request methods, headers, request parameters, and response formats will make it easier to explore and understand functionality, and reduces surprises when your API grows.</p> </blockquote> <p><em>Hypermedia</em> parece outra excelente ideia, uma vez que serve como documentação e oferece meios para humanos e máquinas compreenderem melhor a sua funcionalidade.</p> <h2>Camadas: API-First Development x API-First Design</h2> <p><em>API-First</em> é sobre fazer a <em>API</em> antes da interface <a href=https://klauslaube.com.br/tag/web.html title="Leia mais sobre web"><em>web</em></a> e <em>mobile</em>? Ou seria sobre primeiro fazer o <em>design</em> da <em>API</em> e a partir daí passar para a implementação?</p> <p>Uma ótica interessante sobre esse debate pode ser lida no <a href=https://apievangelist.com/2014/08/11/what-is-an-api-first-strategy-adding-some-dimensions-to-this-new-question/ title="Leia mais no API Evangelist">"What Is An API First Strategy? Adding Some Dimensions To This New Question"</a>, do <em>apievangelist.com</em>.</p> <p>Durante a pesquisa para a escrita desse <em>post</em>, fui exposto a diferentes perspectivas, e é muito provável que eu tenha apresentado elas de forma "misturada" até aqui:</p> <ul> <li>Do ponto de vista de negócio, é sobre ter uma <em>API</em> primeiro e torná-la um produto <em>per se</em>;</li> <li>Do ponto de vista de tecnologia, é sobre ter uma plataforma primeiro;</li> <li>Do ponto de vista de arquitetura, é sobre ter um <em>design</em> coeso, reusável, e construído através da colaboração de diferentes <em>stakeholders</em>;</li> <li>Do ponto de vista de <em>UX</em>, é sobre ter uma <em>API</em> bem estruturada e documentada;</li> <li>Do ponto de vista do desenvolvedor, é sobre ter uma especificação antes de partir para a implementação.</li> </ul> <p>Qual visão você pretende adotar depende muito do contexto. Haverá casos em que o produto já existe, soluções já estão no ar, e você fará o movimento para um consumo baseado em <em>APIs</em>. Ou, com sorte, você fundará uma <em>startup</em> e terá controle o suficiente para primeiramente produzir uma <em>API</em> e depois as interfaces gráficas.</p> <p>Assim como há diferentes "níveis de <em>REST</em>" que podemos usar no cotidiano, <em>API-First</em> pode ser adotado em diferentes níveis e maneiras.</p> <p>No meu caso, que atualmente trabalho em um ambiente <em>enterprise</em> e tenho pouca influência sobre o negócio, é basicamente sobre <a href=https://en.wikipedia.org/wiki/Design_by_contract title="Design by contract">discutir o contrato primeiro</a>, e ter uma especificação que sirva como documentação e que guie o meu desenvolvimento.</p> <h2>Os passos</h2> <p>Na primeira vez que ouvi falar sobre esse conceito, me perguntei como que de forma prática é possível exercitá-lo. De lá para cá já me deparei com diferentes formas e processos para adoção.</p> <p><img class=align-center src=/images/blog/captain-ux-2.jpg width=740 height=416 title="Ver outro dev usando sua API é tão sensacional quanto o Caps usando o martelo (youtube.com)" alt="Ver outro dev usando sua API é tão sensacional quanto o Caps usando o martelo (youtube.com)"></p> <p>Inclusive, durante meu período na <a href=https://loadsmart.com/#/ title="Book a truck in seconds"><em>Loadsmart</em></a>, cheguei a falar exatamente sobre isso em um <a href=https://www.slideshare.net/kplaube/api-first-design title="Veja os slides da apresentação API First Design: Insights from the real-life usage"><em>lightning talk</em> na <em>Python Sul</em></a>, e sobre como estávamos montando esse processo.</p> <p>O contexto pode variar de acordo com o público alvo de sua <em>API</em>. Por exemplo, no artigo <a href=https://swagger.io/resources/articles/adopting-an-api-first-approach/ >"Understanding the API-First Approach to Building Products"</a> do <em>swagger.io</em>, há uma boa descrição do que <strong>não</strong> pode faltar quando o assunto é prover <em>APIs</em> dentro de uma organização:</p> <ul> <li><strong>Brainstorm:</strong> Primeiro identifique os serviços chave do negócio e suas <em>capabilities</em>. Descubra quais tipos de <em>APIs</em> deveriam ser oferecidas, descreva os casos de uso para tais <em>APIs</em>, e aponte potenciais <em>endpoints</em> baseados nesses casos de uso.</li> <li><strong>Identifique os stakeholders:</strong> Quem são os potenciais usuários dentro da sua organização? Tente construir uma visão clara e compartilhada com os demais times da sua empresa. Permita que <em>stakeholders</em> influenciem no <em>design</em> da <em>API</em> e envolva-os em melhorias e mudanças.</li> <li><strong>Projete um contrato:</strong> O contrato estabelecerá uma série de padrões e boas práticas. Descreva todas as <em>APIs</em> e garanta que elas funcionarão de acordo com o acordado.</li> <li><strong>Crie um style guide:</strong> Com um <em>style guide</em> será possível ter consistência entre diferentes times e serviços, dentro de uma mesma organização. <em>Status codes</em>, versionamento, erros, padrões de rota, etc. Possuir uma especificação comum reduzirá o atrito para adoção de sua <em>API</em> por outros desenvolvedores da organização.</li> <li><strong>Implemente governança:</strong> Isso ajudará a estabelecer padrões e reforçar <em>outcomes</em> esperados. Essa prática pode envolver de <em>code reviews</em> a <a href=https://www.mabl.com/blog/understanding-contract-testing-microservices-mabl title="Understanding Contract Testing for Microservices"><em>contract tests</em></a>.</li> <li><strong>Automatize processos:</strong> Utilize ferramentas para automatizar o processo de geração da documentação de <em>API</em>, validação de estilo, <em>mocking</em>, versionamento, etc. Prover todo o ferramental necessário para que o usuário possa interagir com sua <em>API</em> facilmente faz parte desse passo.</li> <li><strong>Controle o seu portfolio de APIs:</strong> Não é raro esquecermos que certo serviço já existe, portanto, possuir um sistema que auxilie no gerenciamento e <em>tracking</em> de <em>APIs</em> é fundamental.</li> <li><strong>Crie um portal para desenvolvedores internos:</strong> Tenha um lugar centralizado onde usuários possam encontrar a documentação, especificação e demais contratos. <em>Developer Experience</em> é importante.</li> </ul> <p>Muitos desses passos, mesmo em um contexto onde você esteja provendo <em>APIs</em> para usuários externos, fazem completo sentido (e provavelmente já façam parte da fase de arquitetura e <em>design</em> do seu produto). Possuir um portal no qual você exponha as suas <em>APIs</em>, como elas funcionam e como um possível parceiro é capaz de integrar-se a ela, não são apenas artefatos de engenharia, também são possíveis artefatos de negócios.</p> <h2>Considerações finais</h2> <p>Se você já pratica <a href='https://en.wikipedia.org/wiki/Design_by_contract "Leia mais no Wikipedia'><em>design by contract</em></a>, muito do que foi dito aqui já faz parte do seu cotidiano.</p> <p>E com o <em>microservices</em> fazendo cada vez mais "parte da normalidade", <em>API-First</em> pode parece mais um <em>buzzword</em> para descrever o que já é comum. Ainda assim, não é raro escutarmos histórias sobre dois serviços diferentes que não são capazes de se comunicar, ou de prestadores de serviço que produzem interfaces gráficas para empresas e que na hora de \ vinculá-las ao <em>back end</em> a coisa simplesmente não funciona.</p> <p>Lembro que o meu primeiro contato com <em>API-First</em> foi fruto de uma necessidade de expor certa funcionalidade para um certo grupo de possíveis parceiros. Pensar na <em>API</em> primeiro foi um exercício interessante, uma vez que envolveu pensar numa plataforma coesa, e permitiu levar em consideração questões como reuso (que ocasionou na própria empresa utilizando a <em>API</em> produzida).</p> <p>Lembro também que o <em>feedback</em> foi muito bom, uma vez que certos mercados possuem uma postura bem conservadora, e pensar primeiro no usuário mostrou preocupação genuína com o problema do usuário e consequentemente com o produto sendo escrito.</p> <p>Contratos são difíceis de serem alterados depois de implementados, então discutí-los antes permite uma resposta mais rápida (e indolor) à mudanças, além de proporcionar uma possível "paralelidade" entre servidor e consumidor no desenvolvimento da funcionalidade (reduzindo assim tempo de <em>release</em> e aumentando a interação durante a implementação do contrato por ambas as partes).</p> <p>Por maior que esse <em>post</em> seja, no fim das contas <em>API-First</em> é algo fundamentalmente simples, que assim como o <em>agile</em>, parte do princípio que as pessoas (e seus problemas) são o que realmente importa.</p> <p>Até a próxima.</p> <h2>Referências</h2> <ul> <li><a href=https://medium.com/adobetech/three-principles-of-api-first-design-fa6666d9f694>Adobe Tech Blog - Three Principles of API First Design</a></li> <li><a href=https://apievangelist.com/2014/08/11/what-is-an-api-first-strategy-adding-some-dimensions-to-this-new-question/ >API Evangelist - What Is An API First Strategy? Adding Some Dimensions To This New Question</a></li> <li><a href=https://apifriends.com/api-creation/api-first/ >API Friends - What is an API First definition?</a></li> <li><a href=https://dzone.com/articles/an-api-first-development-approach-1>DZone - An API-First Development Approach</a></li> <li><a href=https://dzone.com/articles/what-api-first>DZone - What is API First?</a></li> <li><a href=https://www.programmableweb.com/news/introduction-to-api-first-design/analysis/2016/10/31>ProgrammableWeb - Introduction to API-First Design</a></li> <li><a href=https://swagger.io/resources/articles/adopting-an-api-first-approach/ >Swagger.io - Understanding the API-First Approach to Building Products</a></li> <li><a href=https://en.wikipedia.org/wiki/Design_by_contract>Wikipedia - Design by contract</a></li> </ul> </div> </span> <div class=Article-tags> <span class=Article-tagLabel>Tags:</span> <span itemprop=keywords> <a href=https://klauslaube.com.br/tag/desenvolvimento.html title="Leia mais sobre" class=Article-tagLink>desenvolvimento</a> <a href=https://klauslaube.com.br/tag/web.html title="Leia mais sobre" class=Article-tagLink>web</a> <a href=https://klauslaube.com.br/tag/rest.html title="Leia mais sobre" class=Article-tagLink>rest</a> <a href=https://klauslaube.com.br/tag/apis.html title="Leia mais sobre" class=Article-tagLink>apis</a> <a href=https://klauslaube.com.br/tag/api-first.html title="Leia mais sobre" class=Article-tagLink>api-first</a> </span> </div> <div class=Article-comments> <div id=disqus_thread></div> <script type=text/javascript>
        var disqus_shortname = "klauslaube";
        var disqus_identifier = "2020/02/21/o-api-first.html";

        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script> <noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript> </div> </article> </div> <footer class="PageFooter pure-u-1"> <div class=u-box> <p>O conteúdo deste blog está sob a licença <a class=PageFooter-link href=http://creativecommons.org/licenses/by/3.0/deed.pt_BR title="Distribua, adapte, use. Mas mencione o autor." rel=nofollow>Creative Commons Attribution 3.0</a>.</p> <p>O código está disponível em <a class=PageFooter-link href=https://github.com/kplaube/blog/ title=Contribute! rel=nofollow>GitHub</a>.</p> </div> </footer> </div> <script>
        (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
        function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
        e=o.createElement(i);r=o.getElementsByTagName(i)[0];
        e.src='//www.google-analytics.com/analytics.js';
        r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
        ga('create','UA-19657400-1');ga('send','pageview');
    </script> </body> </html>