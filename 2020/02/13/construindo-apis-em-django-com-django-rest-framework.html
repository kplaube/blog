<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.493e6315ef3a09bc2f74.css">code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.20.12"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><style data-styled="" data-styled-version="5.1.0">.dQgIel{display:inline-block;vertical-align:middle;overflow:hidden;}/*!sc*/
data-styled.g1[id="sc-AxjAm"]{content:"dQgIel,"}/*!sc*/
.dLmtYS{color:rgba(0,0,0,0.84);height:24px;width:24px;}/*!sc*/
data-styled.g2[id="article-share__FacebookStyled-sc-1s9obkn-0"]{content:"dLmtYS,"}/*!sc*/
.cXEKcd{color:rgba(0,0,0,0.84);height:24px;width:24px;}/*!sc*/
data-styled.g3[id="article-share__LinkedinStyled-sc-1s9obkn-1"]{content:"cXEKcd,"}/*!sc*/
.kBgYvV{color:rgba(0,0,0,0.84);height:24px;width:24px;}/*!sc*/
data-styled.g4[id="article-share__TwitterStyled-sc-1s9obkn-2"]{content:"kBgYvV,"}/*!sc*/
.jVnceN{color:rgba(0,0,0,0.84);height:24px;width:24px;}/*!sc*/
data-styled.g5[id="article-share__WhatsappStyled-sc-1s9obkn-3"]{content:"jVnceN,"}/*!sc*/
.hUktyW{display:inline-block;margin-right:8px;}/*!sc*/
data-styled.g6[id="article-share__SocialLink-sc-1s9obkn-4"]{content:"hUktyW,"}/*!sc*/
.hKQQPE{clear:both;margin-bottom:32px;}/*!sc*/
@media (min-width:768px){.hKQQPE{clear:none;float:right;line-height:48px;}}/*!sc*/
data-styled.g7[id="article-share__SocialWrapper-sc-1s9obkn-5"]{content:"hKQQPE,"}/*!sc*/
.gKRNvs{margin-bottom:24px;}/*!sc*/
data-styled.g8[id="article-tags__Tags-lfitfk-0"]{content:"gKRNvs,"}/*!sc*/
.kdcwKK{background-color:#f4f4f4;color:rgba(0,0,0,0.54);display:inline-block;font-size:14px;margin:0 8px 8px 0;padding:8px 16px;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
data-styled.g9[id="article-tags__Tag-lfitfk-1"]{content:"kdcwKK,"}/*!sc*/
.gfJCPa{color:rgba(0,0,0,0.84);margin-bottom:4px;}/*!sc*/
data-styled.g14[id="article__AuthorName-sc-1bof3w4-0"]{content:"gfJCPa,"}/*!sc*/
.cZgAvk{clear:both;font-family:Georgia,"Times New Roman",Times,serif;font-size:18px;font-weight:300;-webkit-letter-spacing:-0.054px;-moz-letter-spacing:-0.054px;-ms-letter-spacing:-0.054px;letter-spacing:-0.054px;line-height:28px;margin-bottom:48px;}/*!sc*/
@media (min-width:768px){.cZgAvk{font-size:20px;}}/*!sc*/
.cZgAvk *{margin:0;margin-block-end:0;margin-block-start:0;padding:0;}/*!sc*/
.cZgAvk h2,.cZgAvk h3,.cZgAvk h4{font-family:"Lucida Sans","Lucida Sans Regular","Lucida Grande","Lucida Sans Unicode",Geneva,Verdana,sans-serif;-webkit-letter-spacing:-0.66px;-moz-letter-spacing:-0.66px;-ms-letter-spacing:-0.66px;letter-spacing:-0.66px;margin-top:8px;margin-bottom:28px;}/*!sc*/
@media (min-width:768px){.cZgAvk h2,.cZgAvk h3,.cZgAvk h4{margin-bottom:16px;}}/*!sc*/
.cZgAvk figure,.cZgAvk iframe,.cZgAvk .gatsby-highlight{left:-24px;position:relative;width:100vw;}/*!sc*/
@media (min-width:768px){.cZgAvk figure,.cZgAvk iframe,.cZgAvk .gatsby-highlight{left:0;width:auto;}}/*!sc*/
.cZgAvk a{color:#c4170c;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.cZgAvk a:hover{-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
.cZgAvk blockquote{color:rgba(0,0,0,0.54);font-style:italic;}/*!sc*/
.cZgAvk code{font-size:16px;}/*!sc*/
.cZgAvk figcaption{color:rgba(0,0,0,0.54);font-size:16px;line-height:20px;padding:16px 24px 0;text-align:center;}/*!sc*/
.cZgAvk h2{font-size:26px;font-weight:600;line-height:32px;margin-bottom:28px;}/*!sc*/
.cZgAvk h3{color:#333;font-size:22px;font-weight:300;line-height:28px;}/*!sc*/
.cZgAvk h4{color:rgba(0,0,0,0.54);font-size:16;font-weight:300;line-height:24px;}/*!sc*/
.cZgAvk iframe{display:block;margin:0 auto 28px auto;height:260px;}/*!sc*/
@media (min-width:768px){.cZgAvk iframe{margin-bottom:42px;height:315px;width:560px;}}/*!sc*/
.cZgAvk img{display:block;margin:0 auto;}/*!sc*/
.cZgAvk p{margin-bottom:28px;}/*!sc*/
@media (min-width:768px){.cZgAvk p{margin-bottom:42px;}}/*!sc*/
.cZgAvk pre{font-size:16px;margin-bottom:28px;padding:24px 16px;}/*!sc*/
@media (min-width:768px){.cZgAvk pre{margin-bottom:42px;}}/*!sc*/
.cZgAvk ol,.cZgAvk ul{margin-left:28px;}/*!sc*/
@media (min-width:768px){.cZgAvk ol,.cZgAvk ul{margin-bottom:42px;}}/*!sc*/
.cZgAvk li{margin-bottom:8px;}/*!sc*/
@media (min-width:768px){.cZgAvk li{margin-bottom:16px;}}/*!sc*/
data-styled.g15[id="article__Content-sc-1bof3w4-1"]{content:"cZgAvk,"}/*!sc*/
.lhlkLZ{border-top:1px solid #f4f4f4;margin-bottom:24px;padding-top:24px;}/*!sc*/
data-styled.g16[id="article__DiscussionWrapper-sc-1bof3w4-2"]{content:"lhlkLZ,"}/*!sc*/
.hnJNBS{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.54);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;float:left;font-size:14px;margin-bottom:32px;}/*!sc*/
data-styled.g17[id="article__Meta-sc-1bof3w4-3"]{content:"hnJNBS,"}/*!sc*/
.cTbbvU{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
data-styled.g18[id="article__MetaText-sc-1bof3w4-4"]{content:"cTbbvU,"}/*!sc*/
.lhqEXT{border-radius:60px;margin-right:16px;}/*!sc*/
data-styled.g19[id="article__StyledAvatar-sc-1bof3w4-5"]{content:"lhqEXT,"}/*!sc*/
.dtcUmd{color:rgba(0,0,0,0.84);font-weight:600;-webkit-letter-spacing:-0.93px;-moz-letter-spacing:-0.93px;-ms-letter-spacing:-0.93px;letter-spacing:-0.93px;margin:0 0 4px 0;font-size:30px;font-weight:400;margin-bottom:32px;}/*!sc*/
@media (min-width:768px){.dtcUmd{font-size:40px;}}/*!sc*/
data-styled.g20[id="article__StyledTitle-sc-1bof3w4-6"]{content:"dtcUmd,"}/*!sc*/
.bfwjqj{margin:0 auto;max-width:640px;padding:0 24px;}/*!sc*/
data-styled.g21[id="container-sc-1o2is99-0"]{content:"bfwjqj,"}/*!sc*/
.iyjQQp{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#c4170c;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-family:Arial,Helvetica,sans-serif;height:36px;width:36px;}/*!sc*/
data-styled.g22[id="page-header-brand__Brand-ofbkek-0"]{content:"iyjQQp,"}/*!sc*/
.hPHtvI{display:none;}/*!sc*/
@media (min-width:768px){.hPHtvI{display:block;}}/*!sc*/
data-styled.g23[id="page-header-brand__BrandFragment-ofbkek-1"]{content:"hPHtvI,"}/*!sc*/
.exgtKg{color:#333;display:inline-block;margin-left:4px;}/*!sc*/
.exgtKg:first-child{margin-left:0;margin-right:4px;}/*!sc*/
data-styled.g24[id="page-header-brand__Bracket-ofbkek-2"]{content:"exgtKg,"}/*!sc*/
.fUa-dQJ{color:#333;width:22px;}/*!sc*/
data-styled.g25[id="page-header__GreyMail-sc-1ef23a-0"]{content:"fUa-dQJ,"}/*!sc*/
.GBaPr{box-shadow:0 -8px 16px 0 rgba(0,0,0,0.54);font-size:1.1rem;margin-bottom:24px;}/*!sc*/
@media (min-width:768px){.GBaPr{margin-bottom:64px;}}/*!sc*/
data-styled.g26[id="page-header__Header-sc-1ef23a-1"]{content:"GBaPr,"}/*!sc*/
.ktLFvT{margin:0 auto;max-width:640px;padding:0 24px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:56px;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;max-width:974px;}/*!sc*/
data-styled.g27[id="page-header__HeaderContainer-sc-1ef23a-2"]{content:"ktLFvT,"}/*!sc*/
.gbnbN{-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
data-styled.g28[id="page-header__StyledLink-sc-1ef23a-3"]{content:"gbnbN,"}/*!sc*/
.hJnaIf{-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
data-styled.g29[id="page-header__StyledA-sc-1ef23a-4"]{content:"hJnaIf,"}/*!sc*/
.eZHcyp{border-top:1px solid #f4f4f4;color:rgba(0,0,0,0.54);font-size:14px;padding:24px 0;text-align:center;}/*!sc*/
@media (min-width:768px){.eZHcyp{text-align:right;}}/*!sc*/
data-styled.g30[id="page-footer__Footer-sc-1jesc4c-0"]{content:"eZHcyp,"}/*!sc*/
.hCZhVV{color:rgba(0,0,0,0.84);-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.hCZhVV:hover{-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
data-styled.g31[id="page-footer__Link-sc-1jesc4c-1"]{content:"hCZhVV,"}/*!sc*/
body{color:rgba(0,0,0,0.84);font-family:Arial,Helvetica,sans-serif;margin:0;}/*!sc*/
data-styled.g51[id="sc-global-eLbNMD1"]{content:"sc-global-eLbNMD1,"}/*!sc*/
</style><title data-react-helmet="true">Construindo APIs em Django com Django REST Framework | Klaus Laube</title><meta data-react-helmet="true" name="description" content="No post anterior
tive a oportunidade de &quot;destilar&quot; a minha simpatia pelo Django REST Framework,
e de salientar alguns aspectos positivos da…"/><meta data-react-helmet="true" property="og:title" content="Construindo APIs em Django com Django REST Framework"/><meta data-react-helmet="true" property="og:description" content="No post anterior
tive a oportunidade de &quot;destilar&quot; a minha simpatia pelo Django REST Framework,
e de salientar alguns aspectos positivos da…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Klaus Peter Laube"/><meta data-react-helmet="true" name="twitter:title" content="Construindo APIs em Django com Django REST Framework"/><meta data-react-helmet="true" name="twitter:description" content="No post anterior
tive a oportunidade de &quot;destilar&quot; a minha simpatia pelo Django REST Framework,
e de salientar alguns aspectos positivos da…"/><meta data-react-helmet="true" name="keywords" content="desenvolvimento-web,api,python,django,rest,drf"/><meta data-react-helmet="true" property="og:image" content="https://klauslaube.com.br/static/46012f1b5a5e44b0747baafa90e04f8a/django-logo.png"/><link rel="icon" href="/icons/icon-48x48.png?v=36b7df61fef254bef7f8fee13b1f890b"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=36b7df61fef254bef7f8fee13b1f890b"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=36b7df61fef254bef7f8fee13b1f890b"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=36b7df61fef254bef7f8fee13b1f890b"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=36b7df61fef254bef7f8fee13b1f890b"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=36b7df61fef254bef7f8fee13b1f890b"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=36b7df61fef254bef7f8fee13b1f890b"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=36b7df61fef254bef7f8fee13b1f890b"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=36b7df61fef254bef7f8fee13b1f890b"/><link rel="alternate" type="application/rss+xml" title="Klaus Laube" href="/feed/rss.xml"/><link as="script" rel="preload" href="/webpack-runtime-dc96c66775562e27b368.js"/><link as="script" rel="preload" href="/framework-15c64f04ece7e16d9319.js"/><link as="script" rel="preload" href="/styles-72b9aca6a03bf971c27e.js"/><link as="script" rel="preload" href="/app-e7e259d06d29a943bae9.js"/><link as="script" rel="preload" href="/commons-d19a5247b9c341fd9cf4.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-5ffdc932bc635b5de73e.js"/><link as="fetch" rel="preload" href="/page-data/2020/02/13/construindo-apis-em-django-com-django-rest-framework.html/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="page-header__Header-sc-1ef23a-1 GBaPr"><div class="container-sc-1o2is99-0 page-header__HeaderContainer-sc-1ef23a-2 ktLFvT"><a class="page-header__StyledLink-sc-1ef23a-3 gbnbN" href="/"><div class="page-header-brand__Brand-ofbkek-0 iyjQQp"><span class="page-header-brand__Bracket-ofbkek-2 exgtKg">{</span>k<span class="page-header-brand__BrandFragment-ofbkek-1 hPHtvI">laus</span>l<span class="page-header-brand__BrandFragment-ofbkek-1 hPHtvI">aube</span><span class="page-header-brand__Bracket-ofbkek-2 exgtKg">}</span></div></a><div><a href="https://about.me/klauslaube" title="Contato" class="page-header__StyledA-sc-1ef23a-4 hJnaIf"><svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" class="sc-AxjAm dQgIel page-header__GreyMail-sc-1ef23a-0 fUa-dQJ"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a></div></div></div><div><div class="container-sc-1o2is99-0 bfwjqj"><h1 class="typograph__Title-sc-4kf6ch-1 article__StyledTitle-sc-1bof3w4-6 dtcUmd">Construindo APIs em Django com Django REST Framework</h1><div class="article__Meta-sc-1bof3w4-3 hnJNBS"><img src="https://en.gravatar.com/userimage/12163112/d3ae0c6239980b01ff1f1730b65c2ebe.jpg" width="48" height="48" alt="Avatar" class="avatar-sc-46srdf-0 article__StyledAvatar-sc-1bof3w4-5 lhqEXT"/><div class="article__MetaText-sc-1bof3w4-4 cTbbvU"><div class="article__AuthorName-sc-1bof3w4-0 gfJCPa">Klaus Peter Laube</div>13 de Fevereiro de 2020<!-- --> - <!-- -->9 minutos<!-- --> de leitura</div></div><div class="article-share__SocialWrapper-sc-1s9obkn-5 hKQQPE"><a href="https://twitter.com/intent/tweet?url=https://klauslaube.com.br/2020/02/13/construindo-apis-em-django-com-django-rest-framework.html&amp;text=Construindo APIs em Django com Django REST Framework" target="_blank" rel="noreferrer" title="Compartilhe no Twitter" class="article-share__SocialLink-sc-1s9obkn-4 hUktyW"><svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="sc-AxjAm dQgIel article-share__TwitterStyled-sc-1s9obkn-2 kBgYvV"><path d="M19.633 7.997c.013.175.013.349.013.523 0 5.325-4.053 11.461-11.46 11.461-2.282 0-4.402-.661-6.186-1.809.324.037.636.05.973.05a8.07 8.07 0 005.001-1.721 4.036 4.036 0 01-3.767-2.793c.249.037.499.062.761.062.361 0 .724-.05 1.061-.137a4.027 4.027 0 01-3.23-3.953v-.05c.537.299 1.16.486 1.82.511a4.022 4.022 0 01-1.796-3.354c0-.748.199-1.434.548-2.032a11.457 11.457 0 008.306 4.215c-.062-.3-.1-.611-.1-.923a4.026 4.026 0 014.028-4.028c1.16 0 2.207.486 2.943 1.272a7.957 7.957 0 002.556-.973 4.02 4.02 0 01-1.771 2.22 8.073 8.073 0 002.319-.624 8.645 8.645 0 01-2.019 2.083z"></path></svg></a><a href="https://www.facebook.com/sharer/sharer.php?u=https://klauslaube.com.br/2020/02/13/construindo-apis-em-django-com-django-rest-framework.html" target="_blank" rel="noreferrer" title="Compartilhe no Facebook" class="article-share__SocialLink-sc-1s9obkn-4 hUktyW"><svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="sc-AxjAm dQgIel article-share__FacebookStyled-sc-1s9obkn-0 dLmtYS"><path d="M20 3H4a1 1 0 00-1 1v16a1 1 0 001 1h8.615v-6.96h-2.338v-2.725h2.338v-2c0-2.325 1.42-3.592 3.5-3.592.699-.002 1.399.034 2.095.107v2.42h-1.435c-1.128 0-1.348.538-1.348 1.325v1.735h2.697l-.35 2.725h-2.348V21H20a1 1 0 001-1V4a1 1 0 00-1-1z"></path></svg></a><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://klauslaube.com.br/2020/02/13/construindo-apis-em-django-com-django-rest-framework.html&amp;title=Construindo APIs em Django com Django REST Framework" target="_blank" rel="noreferrer" title="Compartilhe no Linkedin" class="article-share__SocialLink-sc-1s9obkn-4 hUktyW"><svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="sc-AxjAm dQgIel article-share__LinkedinStyled-sc-1s9obkn-1 cXEKcd"><path d="M20 3H4a1 1 0 00-1 1v16a1 1 0 001 1h16a1 1 0 001-1V4a1 1 0 00-1-1zM8.339 18.337H5.667v-8.59h2.672v8.59zM7.003 8.574a1.548 1.548 0 110-3.096 1.548 1.548 0 010 3.096zm11.335 9.763h-2.669V14.16c0-.996-.018-2.277-1.388-2.277-1.39 0-1.601 1.086-1.601 2.207v4.248h-2.667v-8.59h2.56v1.174h.037c.355-.675 1.227-1.387 2.524-1.387 2.704 0 3.203 1.778 3.203 4.092v4.71z"></path></svg></a><a href="https://api.whatsapp.com/send?text=https://klauslaube.com.br/2020/02/13/construindo-apis-em-django-com-django-rest-framework.html" target="_blank" rel="noreferrer" title="Compartilhe no Whatsapp" class="article-share__SocialLink-sc-1s9obkn-4 hUktyW"><svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="sc-AxjAm dQgIel article-share__WhatsappStyled-sc-1s9obkn-3 jVnceN"><path fill-rule="evenodd" d="M18.403 5.633A8.919 8.919 0 0012.053 3c-4.948 0-8.976 4.027-8.978 8.977 0 1.582.413 3.126 1.198 4.488L3 21.116l4.759-1.249a8.981 8.981 0 004.29 1.093h.004c4.947 0 8.975-4.027 8.977-8.977a8.926 8.926 0 00-2.627-6.35m-6.35 13.812h-.003a7.446 7.446 0 01-3.798-1.041l-.272-.162-2.824.741.753-2.753-.177-.282a7.448 7.448 0 01-1.141-3.971c.002-4.114 3.349-7.461 7.465-7.461a7.413 7.413 0 015.275 2.188 7.42 7.42 0 012.183 5.279c-.002 4.114-3.349 7.462-7.461 7.462m4.093-5.589c-.225-.113-1.327-.655-1.533-.73-.205-.075-.354-.112-.504.112s-.58.729-.711.879-.262.168-.486.056-.947-.349-1.804-1.113c-.667-.595-1.117-1.329-1.248-1.554s-.014-.346.099-.458c.101-.1.224-.262.336-.393.112-.131.149-.224.224-.374s.038-.281-.019-.393c-.056-.113-.505-1.217-.692-1.666-.181-.435-.366-.377-.504-.383a9.65 9.65 0 00-.429-.008.826.826 0 00-.599.28c-.206.225-.785.767-.785 1.871s.804 2.171.916 2.321c.112.15 1.582 2.415 3.832 3.387.536.231.954.369 1.279.473.537.171 1.026.146 1.413.089.431-.064 1.327-.542 1.514-1.066.187-.524.187-.973.131-1.067-.056-.094-.207-.151-.43-.263" clip-rule="evenodd"></path></svg></a></div><div class="article__Content-sc-1bof3w4-1 cZgAvk"><p>No <a href="/2020/02/06/eu-me-rendo-django-rest-framework.html" title="Leia o meu depoimento sobre a rendição ao DRF"><em>post</em> anterior</a>
tive a oportunidade de "destilar" a minha simpatia pelo <a href="/tag/drf.html" title="Leia mais sobre o Django REST Framework"><em>Django REST Framework</em></a>,
e de salientar alguns aspectos positivos da ferramenta. A praticidade
é sem dúvida um de seus pontos mais altos, e nesse <em>post</em> vamos explorá-la através
de código escrito (que vale mais do que mil palavras).</p>
<h2>Instalando</h2>
<p>Sem mais delongas, o <em>REST Framework</em> é facilmente instalado através dos comandos <code class="language-text">pip</code> ou <code class="language-text">pipenv</code>:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ pipenv install djangorestframework</code></pre></div>
<p>Não esqueça de adicionar a <em>app</em> ao seu <code class="language-text">INSTALLED_APPS</code>:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># settings.py</span>

INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
    <span class="token string">'rest_framework'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span></code></pre></div>
<p>Estamos prontos para mergulhar nos conceitos de <em>routers</em>, serializadores e <em>views</em>.</p>
<h2>Antes de ir: O problema</h2>
<p>Embora o "iMDB-clone" seja o meu tipo de exemplo favorito, dessa vez vamos imaginar que estamos desenvolvendo
um "Feedly-clone". O <a href="https://feedly.com/" title="Visite o Feedly"><em>Feedly</em></a> é uma espécie de leitor <a href="/2010/11/12/o-que-e-rss.html" title="O que é RSS?"><em>RSS</em></a>
(com esteroides) muito popular.</p>
<p>Vamos focar em dois tipos específicos: <code class="language-text">Channel</code> e <code class="language-text">Item</code>; <em>Channel</em> é de fato o <em>website</em> ou <em>blog</em> que queremos registrar em
nossa plataforma. Esse é o mesmo nome utilizado pelo formato <em>RSS</em>:</p>
<div class="gatsby-highlight" data-language="xml"><pre class="language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rss</span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>channel</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>RSS Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">></span></span>This is an example of an RSS feed<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span><span class="token punctuation">></span></span>http://www.example.com/main.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>link</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>lastBuildDate</span><span class="token punctuation">></span></span>Mon, 06 Sep 2010 00:01:00 +0000 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>lastBuildDate</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pubDate</span><span class="token punctuation">></span></span>Sun, 06 Sep 2009 16:20:00 +0000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pubDate</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ttl</span><span class="token punctuation">></span></span>1800<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ttl</span><span class="token punctuation">></span></span>

 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Example entry<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">></span></span>Here is some text containing an interesting description.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span><span class="token punctuation">></span></span>http://www.example.com/blog/post/1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>link</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>guid</span> <span class="token attr-name">isPermaLink</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>7bd204c6-1655-4c27-aeee-53f933c5395f<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>guid</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pubDate</span><span class="token punctuation">></span></span>Sun, 06 Sep 2009 16:20:00 +0000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pubDate</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>channel</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rss</span><span class="token punctuation">></span></span></code></pre></div>
<p>Já item, como ilustrado no exemplo acima, é de fato a notícia/artigo/música/podcast que aquele canal está publicando.</p>
<p>Então, partiremos do princípio que os seguintes modelos já estão estabelecidos:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># channels/models.py</span>

<span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models


<span class="token keyword">class</span> <span class="token class-name">Channel</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">)</span>
    description <span class="token operator">=</span> models<span class="token punctuation">.</span>TextField<span class="token punctuation">(</span>blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    link <span class="token operator">=</span> models<span class="token punctuation">.</span>URLField<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>title


<span class="token keyword">class</span> <span class="token class-name">Item</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    channel <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Channel<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">)</span>
    description <span class="token operator">=</span> models<span class="token punctuation">.</span>TextField<span class="token punctuation">(</span>blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    link <span class="token operator">=</span> models<span class="token punctuation">.</span>URLField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    pub_date <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>title</code></pre></div>
<p>O próximo passo será definir a <em>API</em> para que um possível cliente <em>mobile</em> (por exemplo) a consuma.</p>
<h2>Os serializadores</h2>
<p>Segundo a <a href="https://www.django-rest-framework.org/api-guide/serializers/" title="Serializers">documentação oficial</a>:</p>
<blockquote>
<p>Serializers allow complex data such as querysets and model instances to be converted to native Python datatypes that can then be easily rendered into JSON, XML or other content types. Serializers also provide deserialization, allowing parsed data to be converted back into complex types, after first validating the incoming data.</p>
</blockquote>
<p>Eles funcionam como um espécie de <code class="language-text">Form</code>, proporcionando ferramental para o <em>parsing</em> e validação das requisições, bem como controlando o que será mandado como <em>output</em> para o usuário. Dentro dessa analogia, o <code class="language-text">ModelSerializer</code> faz mais ou menos o que o <code class="language-text">ModelForm</code> faz. Logo, um bom candidato para começarmos a escrever o <em>endpoint</em>:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># channels/serializers.py</span>

<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers

<span class="token keyword">from</span> channels<span class="token punctuation">.</span>models <span class="token keyword">import</span> Channel


<span class="token keyword">class</span> <span class="token class-name">ChannelSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Channel
        fields <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string">"description"</span><span class="token punctuation">,</span>
            <span class="token string">"link"</span><span class="token punctuation">,</span>
            <span class="token string">"title"</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span></code></pre></div>
<p>Uma vez que estamos expondo todos os campos do modelo, é possível trocar a lista em <code class="language-text">fields</code>, pela <em>string</em> <code class="language-text">__all__</code>.</p>
<h2>Viewsets</h2>
<p>Continuando com as analogias, um <em>viewset</em> seria mais ou menos o que são as <em>class-based views</em> no <em>Django</em>. Elas abstraem uma
porção de lógica repetitiva (como <em>CRUD</em>) através de uma estrutura muito familiar aos que já possuem certa vivência com o <em>framework</em>:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># channels/api.py</span>

<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> viewsets

<span class="token keyword">from</span> channels<span class="token punctuation">.</span>models <span class="token keyword">import</span> Channel
<span class="token keyword">from</span> channels<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> ChannelSerializer


<span class="token keyword">class</span> <span class="token class-name">ChannelViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Channel<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> ChannelSerializer</code></pre></div>
<p>Note que em <code class="language-text">queryset</code> apontamos para o modelo <code class="language-text">Channel</code>, e em <code class="language-text">serializer_class</code> para a classe serializadora criada anteriormente.</p>
<h2>Fazendo o roteamento</h2>
<p>Como último passo para termos algo de fato visual, vamos mapear as rotas para o novo recurso criado.</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 740px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/767c61c3f85f83779b4b72b19b2e65d7/07f3a/hyperdrive.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 42.1875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABw6BIH//EABcQAAMBAAAAAAAAAAAAAAAAAAACMQH/2gAIAQEAAQUCXSDX/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAGBAAAwEBAAAAAAAAAAAAAAAAAAERMWH/2gAIAQEAAT8hgN0ump//2gAMAwEAAgADAAAAEIAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Qp//EAB0QAAIBBAMAAAAAAAAAAAAAAAERACExQVFhoeH/2gAIAQEAAT8QCjQLQOuZVSLP3qDaLBzP/9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Falcon em hyperdrive"
        title="Usar DRF é como entrar em hyperdrive (pinpointe.com)"
        src="/static/767c61c3f85f83779b4b72b19b2e65d7/07f3a/hyperdrive.jpg"
        srcset="/static/767c61c3f85f83779b4b72b19b2e65d7/7809d/hyperdrive.jpg 192w,
/static/767c61c3f85f83779b4b72b19b2e65d7/4ecad/hyperdrive.jpg 384w,
/static/767c61c3f85f83779b4b72b19b2e65d7/07f3a/hyperdrive.jpg 740w"
        sizes="(max-width: 740px) 100vw, 740px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span>
    <figcaption class="gatsby-resp-image-figcaption">Usar DRF é como entrar em hyperdrive (pinpointe.com)</figcaption>
  </figure></p>
<p>Uma das vantagens de utilizar um <em>viewset</em> é que ele também se encarrega de fazer o mapeamento das <em>URLs</em>. Por exemplo, o <code class="language-text">ChannelViewSet</code> uma vez que mapeado,
responderá para rotas terminando em <code class="language-text">/</code> e <code class="language-text">/&lt;id-do-channel&gt;</code>. Além disso compreenderá que um <code class="language-text">POST</code> em <code class="language-text">/</code> é relacionado à criação de um novo elemento, bem como <code class="language-text">DELETE</code> em <code class="language-text">/&lt;id-do-channel&gt;</code> está relação à remoção:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># urls.py</span>

<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> include<span class="token punctuation">,</span> path

<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> routers
<span class="token keyword">from</span> channels<span class="token punctuation">.</span>api <span class="token keyword">import</span> ChannelViewSet

api_router <span class="token operator">=</span> routers<span class="token punctuation">.</span>DefaultRouter<span class="token punctuation">(</span><span class="token punctuation">)</span>
api_router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r"channels"</span><span class="token punctuation">,</span> ChannelViewSet<span class="token punctuation">)</span>

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">"api/"</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span>api_router<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span></code></pre></div>
<p>Nesse momento já é possível presenciar um resultado mais sólido ao acessar <code class="language-text">http://localhost:8000/api</code>:</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 740px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/0a797ad2b8417bd9a2e5f88cd3c3a1b0/50383/django-rest-framework-example.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 54.6875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABYlAAAWJQFJUiTwAAABj0lEQVQoz32R2UrDUBCG+yYa8UahthVv1Noaalu3otblxmcS8RkEn8HaNHF5ABFEhEosiCbaJmma5WxZnKR1K9LDx89wmG/mwElslPfy2fVyYYfPra8sV9aK1VJhu5DfzC2ufrO0UC7kKyW+srtR4osHayvVIr8FPYn02Pj81DSfzuRT6WwymZtJzU1OZriJ2b9kOC6+hOQGN+NcQpQkQRTP63VBEqEALgShVq/XhGEaYkOSGmKckiQ2Li8TYRgGQUApDXw/HHlMEr47fpeGCiSOmiNZVVVZlpvNpqIovu8zRhljUAQwL04vnnty0zo8uzu6kvdPb4+v5YFsmr23N6Xd7miarutGJzoapeCHnhfpfQIgCKJ3+nH2ZcdxwXFdzAijmBJMESIjgE4YPdgMe+7vH55ary9ts/VudC0XI/IDHgahX7LW0R6fWs9KWzVstWvrlosIHfDfK2AzIV8yoQybDjFs0rWpYRG9hz6MiI6JDAvhkTJlHrYR6TnYwcRyoSBmDBQOgr4hMIbf8ED8BMauEY/dCRS/AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Exemplo ao acessar o endereço no browser"
        title="Exemplo ao acessar o endereço no browser"
        src="/static/0a797ad2b8417bd9a2e5f88cd3c3a1b0/50383/django-rest-framework-example.png"
        srcset="/static/0a797ad2b8417bd9a2e5f88cd3c3a1b0/8514f/django-rest-framework-example.png 192w,
/static/0a797ad2b8417bd9a2e5f88cd3c3a1b0/804b2/django-rest-framework-example.png 384w,
/static/0a797ad2b8417bd9a2e5f88cd3c3a1b0/50383/django-rest-framework-example.png 740w"
        sizes="(max-width: 740px) 100vw, 740px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span>
    <figcaption class="gatsby-resp-image-figcaption">Exemplo ao acessar o endereço no browser</figcaption>
  </figure></p>
<p>Não ligue para a porta <code class="language-text">:5000</code> no exemplo acima...</p>
<p>Se você não é fã do <em>browsable api</em>, e não quer ter essa visão do <code class="language-text">API Root</code> (como da imagem acima), troque o <code class="language-text">DefaultRouter</code> por <code class="language-text">SimpleRouter</code>.</p>
<h2>CRUD em ação</h2>
<p>Considerando tudo o que foi dito até então, podemos esperar que temos o recurso mapeado no endereço <code class="language-text">http://localhost:8000/api/channels</code>,
e que a partir desse, poderemos desempenhar a listagem, adição, edição e exclusão de dados desse recurso.</p>
<p>Começamos então adicionando um elemento, ao enviar o método <code class="language-text">POST</code> para o endereço com final <code class="language-text">channels/</code>:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">curl -XPOST http://localhost:8000/api/channels/ --data &#39;{
    &quot;id&quot;: 1,
    &quot;title&quot;: &quot;Klaus Laube&quot;,
    &quot;description&quot;: &quot;Python, Django e desenvolvimento Web&quot;,
    &quot;link&quot;: &quot;https://klauslaube.com.br&quot;
}&#39; --header &quot;Content-Type: application/json&quot;

{&quot;id&quot;:1,&quot;title&quot;:&quot;Klaus Laube&quot;,&quot;description&quot;:&quot;Python, Django e desenvolvimento Web&quot;,&quot;link&quot;:&quot;https://klauslaube.com.br&quot;}</code></pre></div>
<p>Como o serializador espelha as propriedades do modelo <code class="language-text">Channel</code>, caso um campo obrigatório não seja enviado
no <em>payload</em>, o próprio serializador se encarregará de fazer essa validação e de retornar detalhes do erro ao usuário:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">curl -i -XPOST http://localhost:8000/api/channels/ --data &#39;{
    &quot;title&quot;: &quot;Klaus Laube&quot;,
    &quot;description&quot;: &quot;Python, Django, APIs, e desenvolvimento Web&quot;
}&#39; --header &quot;Content-Type: application/json&quot;

HTTP/1.1 400 Bad Request
Date: Tue, 11 Feb 2020 18:00:44 GMT
Server: WSGIServer/0.2 CPython/3.7.2
Content-Type: application/json
Vary: Accept, Cookie
Allow: GET, POST, HEAD, OPTIONS
X-Frame-Options: DENY
Content-Length: 36
X-Content-Type-Options: nosniff

{&quot;link&quot;:[&quot;This field is required.&quot;]}</code></pre></div>
<p>Como estamos falando de uma <em>API</em> <em>REST</em>, é normal esperarmos que um <code class="language-text">GET</code> no mesmo endereço traga uma lista de <em>channels</em>:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">curl http://localhost:8000/api/channels/

[{&quot;id&quot;:1,&quot;title&quot;:&quot;Klaus Laube&quot;,&quot;description&quot;:&quot;Python, Django e desenvolvimento Web&quot;,&quot;link&quot;:&quot;https://klauslaube.com.br&quot;}]</code></pre></div>
<p>E normalmente, um <code class="language-text">GET</code> em <code class="language-text">channels/1</code> deve trazer detalhes daquele recurso:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">curl http://localhost:8000/api/channels/1/

{&quot;id&quot;:1,&quot;title&quot;:&quot;Klaus Laube&quot;,&quot;description&quot;:&quot;Python, Django e desenvolvimento Web&quot;,&quot;link&quot;:&quot;https://klauslaube.com.br&quot;}</code></pre></div>
<p>Para atualizar o registro, enviamos o método <code class="language-text">PUT</code>:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">curl -XPUT http://localhost:8000/api/channels/1/ --data &#39;{
    &quot;title&quot;: &quot;Klaus Laube&quot;,
    &quot;description&quot;: &quot;Python, Django, APIs, e desenvolvimento Web&quot;,
    &quot;link&quot;: &quot;https://klauslaube.com.br&quot;
}&#39; --header &quot;Content-Type: application/json&quot;

{&quot;id&quot;:1,&quot;title&quot;:&quot;Klaus Laube&quot;,&quot;description&quot;:&quot;Python, Django, APIs, e desenvolvimento Web&quot;,&quot;link&quot;:&quot;https://klauslaube.com.br&quot;}</code></pre></div>
<p>E para finalizar, com <code class="language-text">DELETE</code> é possível remover o recurso:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">curl -XDELETE http://localhost:8000/api/channels/2/</code></pre></div>
<p>Mágico, não?!</p>
<h2>Serializando relacionamentos</h2>
<p>Passaremos a abordar agora a construção do <em>endpoint</em> para o recurso <code class="language-text">Item</code>.</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 640px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/71dd224a33c9c79420baf43984fa2225/c08c5/vim-jedi.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAUCAwT/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQP/2gAMAwEAAhADEAAAAVzVJo0VJAo//8QAGhAAAgMBAQAAAAAAAAAAAAAAAAMBAhESE//aAAgBAQABBQJGejGdVKjJnD//xAAXEQADAQAAAAAAAAAAAAAAAAABAhAR/9oACAEDAQE/AQ2T/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGhAAAgIDAAAAAAAAAAAAAAAAAAEQESFBQv/aAAgBAQAGPwLJfK1CFH//xAAYEAADAQEAAAAAAAAAAAAAAAAAARExIf/aAAgBAQABPyFmQRbUJWtm6KuhpF4I/9oADAMBAAIAAwAAABBY7//EABYRAQEBAAAAAAAAAAAAAAAAAAEREP/aAAgBAwEBPxARJn//xAAWEQEBAQAAAAAAAAAAAAAAAAARAAH/2gAIAQIBAT8Q10m//8QAHBABAQACAgMAAAAAAAAAAAAAAREAITFhQVGB/9oACAEBAAE/ELpIjVKHeBMI1/AHveaSja5xjbu/ccHsgBcTOc//2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Kylo vs Rey"
        title="Nem o DRF consegue serializar o relacionamento entre Rey e Kylo (jovemnerd.com.br)"
        src="/static/71dd224a33c9c79420baf43984fa2225/c08c5/vim-jedi.jpg"
        srcset="/static/71dd224a33c9c79420baf43984fa2225/7809d/vim-jedi.jpg 192w,
/static/71dd224a33c9c79420baf43984fa2225/4ecad/vim-jedi.jpg 384w,
/static/71dd224a33c9c79420baf43984fa2225/c08c5/vim-jedi.jpg 640w"
        sizes="(max-width: 640px) 100vw, 640px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span>
    <figcaption class="gatsby-resp-image-figcaption">Nem o DRF consegue serializar o relacionamento entre Rey e Kylo (jovemnerd.com.br)</figcaption>
  </figure></p>
<p>Começamos pelo <em>serializer</em>, que não é muito diferente do construído anteriormente para o modelo <code class="language-text">Channel</code>:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># channels/serializers.py</span>

<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">ItemSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Item
        fields <span class="token operator">=</span> <span class="token string">"__all__"</span></code></pre></div>
<p>O <code class="language-text">ModelSerializer</code> "automagicamente" fará o <em>parsing</em> do relacionamento entre <code class="language-text">Item</code> e <code class="language-text">Channel</code>. O resultado da serialização de uma instância
de <code class="language-text">Item</code> terá uma propriedade <code class="language-text">channel</code>, com a chave primária do elemento relacionado como valor:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">(...)

&gt;&gt;&gt; item = Item.objects.first()
&gt;&gt;&gt; serializer = ItemSerializer(item)
&gt;&gt;&gt; data = serializer.data

&gt;&gt;&gt; print(data[&quot;channel&quot;])
1</code></pre></div>
<p>Antes de passarmos para o <em>viewset</em>, vamos discutir como ficará a <em>URL</em> desse recurso. Se seguirmos a mesma receita utilizada para <code class="language-text">Channel</code>,
teremos um endereço semelhante com o abaixo:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">http://localhost:8000/api/items/&lt;id&gt;</code></pre></div>
<p>Mas que tal se <code class="language-text">channels</code> fosse parte da <em>URL</em> de <code class="language-text">items</code>? É possível atingir tal resultado com o conceito de recurso aninhado.</p>
<h2>Nested resources</h2>
<p>O que queremos, na prática, é o seguinte:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">http://localhost:8000/api/channels/&lt;id-do-channel&gt;/items/&lt;id-do-item&gt;</code></pre></div>
<p>Com isso, ao acessar <code class="language-text">channels/1/items</code> (por exemplo), teremos uma listagem de todos os itens relacionados
com o canal <code class="language-text">1</code>.</p>
<p>Infelizmente o <em>DRF</em> não possui nenhuma "classe mágica" que faça isso acontecer com poucas linhas de código. Estratégias
para atingir o mesmo resultado podem variar. Existe uma biblioteca que integra-se com o <em>DRF</em> e produz um resultado
similar ao que queremos. Estou falando da <a href="https://github.com/alanjds/drf-nested-routers" title="Veja o repositório do projeto"><em>drf-nested-routers</em></a>:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ pipenv install drf-nested-routers</code></pre></div>
<p><strong>Fica o <em>disclaimer</em>:</strong> Como o próprio autor da biblioteca salienta na documentação, essa é uma ferramenta em estado experimental, portanto,
cogite alternativas quando estiver fazendo o <em>deploy</em> do código para produção. Para provar o conceito apresentado nesse <em>post</em>, ela serve
perfeitamente.</p>
<p>Agora sim podemos continuar com o desenvolvimento do recurso <code class="language-text">Item</code>:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># channels/api.py</span>

<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">ItemViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    serializer_class <span class="token operator">=</span> ItemSerializer

    <span class="token keyword">def</span> <span class="token function">get_queryset</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Item<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>
            channel<span class="token operator">=</span>self<span class="token punctuation">.</span>kwargs<span class="token punctuation">[</span><span class="token string">"channel_pk"</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></div>
<p>Note a sobrescrita do método <code class="language-text">get_queryset</code>. O parâmetro <code class="language-text">channel_pk</code> será passado para o <code class="language-text">ItemViewSet</code> no momento
em que registrarmos a classe no <code class="language-text">Router</code>. Com isso, de forma "lazy", estamos dizendo que os items pesquisados
devem ser relacionados com o <code class="language-text">channel</code> mencionado no <em>path</em> do endereço acessado.</p>
<p>De volta ao <code class="language-text">urls.py</code>, atualizaremos o roteamento para ficar semelhante com o exemplo abaixo:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># urls.py</span>

<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> include<span class="token punctuation">,</span> path
<span class="token keyword">from</span> rest_framework_nested <span class="token keyword">import</span> routers

<span class="token keyword">from</span> channels<span class="token punctuation">.</span>api <span class="token keyword">import</span> ChannelViewSet<span class="token punctuation">,</span> ItemViewSet

api_router <span class="token operator">=</span> routers<span class="token punctuation">.</span>DefaultRouter<span class="token punctuation">(</span><span class="token punctuation">)</span>
api_router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r"channels"</span><span class="token punctuation">,</span> ChannelViewSet<span class="token punctuation">)</span>

channels_router <span class="token operator">=</span> routers<span class="token punctuation">.</span>NestedDefaultRouter<span class="token punctuation">(</span>
    api_router<span class="token punctuation">,</span> <span class="token string">r"channels"</span><span class="token punctuation">,</span> lookup<span class="token operator">=</span><span class="token string">"channel"</span><span class="token punctuation">)</span>
channels_router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r"items"</span><span class="token punctuation">,</span> ItemViewSet<span class="token punctuation">,</span>
    basename<span class="token operator">=</span><span class="token string">"channel-items"</span><span class="token punctuation">)</span>

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">"api/"</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span>api_router<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">"api/"</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span>channels_router<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span></code></pre></div>
<p>Vamos aos pontos de atenção:</p>
<ul>
<li>Importamos <code class="language-text">routers</code> de <code class="language-text">rest_framework_nested</code>, e não mais de <code class="language-text">rest_framework</code>;</li>
<li>Agora lidamos com duas instâncias de <code class="language-text">Router</code>, a primeiro vindo de <code class="language-text">api_router = routers.DefaultRouter()</code>,
e a segunda vindo de <code class="language-text">channels_router = routers.NestedDefaultRouter(api_router, r&quot;channels&quot;, lookup=&quot;channel&quot;)</code>;</li>
<li><code class="language-text">DefaultRouter</code> continua com o mesmo comportamento do exemplo anterior;</li>
<li>Precisamos adicionar ao <code class="language-text">urlpatterns</code> a instância de <code class="language-text">DefaultRouter</code> e as instâncias de <code class="language-text">NestedDefaultRouter</code>.</li>
</ul>
<p><code class="language-text">NestedDefaultRouter</code> espera três parâmetros:</p>
<ul>
<li><code class="language-text">parent_router</code>: O <code class="language-text">Router</code> "pai", podendo ser um <code class="language-text">DefaultRouter</code> ou até mesmo outro <code class="language-text">NestedDefaultRouter</code>;</li>
<li><code class="language-text">parent_prefix</code>: O prefixo de <em>URL</em> no qual os recursos registrados passarão a ser articulados como sub recursos;</li>
<li><code class="language-text">lookup</code>: É a partir dessa informação que a chave <code class="language-text">channel_pk</code> é criada e passada para o <em>viewset</em>.</li>
</ul>
<p>Aqui também, se você não quiser ter a visão de <em>browsable api</em> habilitada, troque para o <code class="language-text">SimpleRouter</code>.</p>
<p>Pronto! O recurso <code class="language-text">Item</code> está disponível para as operações exibidas anteriormente:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">curl http://localhost:8000/api/channels/1/items/

[{&quot;id&quot;:1,&quot;title&quot;:&quot;Eu me rendo: Django REST Framework&quot;,&quot;description&quot;:&quot;Confesso que nunca fui muito simpático ao Django REST Framework...&quot;,&quot;link&quot;:&quot;https://klauslaube.com.br/2020/02/06/eu-me-rendo-django-rest-framework.html&quot;,&quot;pub_date&quot;:&quot;2020-02-06T09:40:00Z&quot;,&quot;channel&quot;:1}]</code></pre></div>
<p>O <em>payload</em> retorna uma chave <code class="language-text">channel</code> para cada item. Uma vez que estamos falando de um <em>nested resource</em>, não faz muito sentido retornarmos essa informação. A maneira mais prática de corrigirmos isso é alterando a classe serializadora:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># channels/serializers.py</span>

<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">ItemSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Item
        exclude <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"channel"</span><span class="token punctuation">]</span></code></pre></div>
<p>Como queremos tudo, menos o <code class="language-text">channel</code>, utilizamos a propriedade <code class="language-text">exclude</code> ao invés de <code class="language-text">fields</code>, e determinamos o que queremos excluir da resposta.</p>
<h2>Considerações finais</h2>
<p>Há muito o que ser discutido ainda, como customização, autenticação, segurança, <em>HATEOAS</em>, etc. Assuntos esses que pretendo abordar em <em>posts</em> vindouros.</p>
<p>Com o mínimo coberto no <em>getting started</em> da documentação do <em>DRF</em>, já é
possível termos algo <em>up &#x26; running</em>. Provar conceitos e discutir contratos
passou a ser muito menos custoso graças à biblioteca.</p>
<p>Essa "proximidade" de conceitos como serializadores e <em>viewsets</em>, com conceitos bem estabelecidos do <em>Django</em> (como <em>forms</em> e <em>class-based views</em>) faz com que o atrito seja menor, e a curva de aprendizagem mais baixa. É quase natural compreender tais artefatos à primeira vista.</p>
<p>Se o seu projeto é feito em <em>Django</em>, e você necessita escrever <em>APIs</em> <em>REST</em>, não perca tempo e caia de cabeça no <em>REST Framework</em>.</p>
<p>Até a próxima.</p>
<h2>Referências</h2>
<ul>
<li><a href="https://www.django-rest-framework.org/tutorial/quickstart/">Django REST Framework - Quickstart</a></li>
<li><a href="https://en.wikipedia.org/wiki/RSS">Wikipedia - RSS</a></li>
</ul></div><div class="article-tags__Tags-lfitfk-0 gKRNvs"><a class="article-tags__Tag-lfitfk-1 kdcwKK" href="/tag/desenvolvimento-web.html">desenvolvimento-web</a><a class="article-tags__Tag-lfitfk-1 kdcwKK" href="/tag/api.html">api</a><a class="article-tags__Tag-lfitfk-1 kdcwKK" href="/tag/python.html">python</a><a class="article-tags__Tag-lfitfk-1 kdcwKK" href="/tag/django.html">django</a><a class="article-tags__Tag-lfitfk-1 kdcwKK" href="/tag/rest.html">rest</a><a class="article-tags__Tag-lfitfk-1 kdcwKK" href="/tag/drf.html">drf</a></div><div class="article__DiscussionWrapper-sc-1bof3w4-2 lhlkLZ"><div shortname="klauslaube" config="[object Object]" id="disqus_thread"></div></div></div></div><footer class="page-footer__Footer-sc-1jesc4c-0 eZHcyp"><div class="container-sc-1o2is99-0 bfwjqj"><p>O conteúdo desse blog está sob a licença<!-- --> <a href="http://creativecommons.org/licenses/by/3.0/deed.pt_BR" class="page-footer__Link-sc-1jesc4c-1 hCZhVV">Creative Commons Attribution</a>.</p><p><a href="https://github.com/kplaube/blog" class="page-footer__Link-sc-1jesc4c-1 hCZhVV">Fork me on Github</a>.</p></div></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2020/02/13/construindo-apis-em-django-com-django-rest-framework.html";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-e7e259d06d29a943bae9.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-5ffdc932bc635b5de73e.js"],"component---src-templates-blog-list-js":["/component---src-templates-blog-list-js-0712dae6686d19cfe871.js"],"component---src-templates-tag-js":["/component---src-templates-tag-js-37944ec4ec91a7d47898.js"],"component---src-pages-404-js":["/component---src-pages-404-js-bf5e10cca5c03eb48f60.js"]};/*]]>*/</script><script src="/component---src-templates-blog-post-js-5ffdc932bc635b5de73e.js" async=""></script><script src="/commons-d19a5247b9c341fd9cf4.js" async=""></script><script src="/app-e7e259d06d29a943bae9.js" async=""></script><script src="/styles-72b9aca6a03bf971c27e.js" async=""></script><script src="/framework-15c64f04ece7e16d9319.js" async=""></script><script src="/webpack-runtime-dc96c66775562e27b368.js" async=""></script></body></html>