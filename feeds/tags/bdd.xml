<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Klaus Laube - bdd]]></title><description><![CDATA[Python, Django e desenvolvimento Web]]></description><link>https://klauslaube.com.br</link><generator>RSS for Node</generator><lastBuildDate>Mon, 01 Mar 2021 20:46:23 GMT</lastBuildDate><author><![CDATA[Klaus Peter Laube]]></author><item><title><![CDATA[O popular e poderoso Pytest]]></title><description><![CDATA[Ok. Eu admito. O primeiro post de 2021 será só para cumprir tabela. Afinal,
se você já programa em Python, provavelmente já ouviu falar do
Pytest.
E é pela sua popularidade, mas acima de tudo sua versatilidade, que eu me sinto na
obrigação de pelo menos arranhar o assunto. 10 anos de blog, e escrevi…]]></description><link>https://klauslaube.com.br/2021/01/24/o-popular-e-poderoso-pytest.html</link><guid isPermaLink="false">https://klauslaube.com.br/2021/01/24/o-popular-e-poderoso-pytest.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Sun, 24 Jan 2021 17:37:00 GMT</pubDate><content:encoded>&lt;p&gt;Ok. Eu admito. O primeiro &lt;em&gt;post&lt;/em&gt; de 2021 será só para cumprir tabela. Afinal,
se você já programa em &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt;, provavelmente já ouviu falar do
&lt;a href=&quot;https://docs.pytest.org/en/stable/&quot; title=&quot;helps you write better programs&quot;&gt;&lt;em&gt;Pytest&lt;/em&gt;&lt;/a&gt;.
E é pela sua popularidade, mas acima de tudo sua versatilidade, que eu me sinto na
obrigação de pelo menos arranhar o assunto.&lt;/p&gt;
&lt;p&gt;10 anos de &lt;em&gt;blog&lt;/em&gt;, e &lt;a href=&quot;https://www.google.com/search?sxsrf=ALeKk01qQM8UPLiwJ7HSSqmN5BBbdsb_DQ%3A1609852895254&amp;#x26;ei=32f0X_WHD_-GwPAP9pClgAw&amp;#x26;q=klauslaube.com.br+%22pytest%22&amp;#x26;oq=klauslaube.com.br+%22pytest%22&amp;#x26;gs_lcp=CgZwc3ktYWIQAzoECAAQRzoECCMQJ1D9gQFY-ZQBYKCXAWgAcAJ4AIABeYgB0QGSAQMxLjGYAQCgAQGqAQdnd3Mtd2l6yAECwAEB&amp;#x26;sclient=psy-ab&amp;#x26;ved=0ahUKEwi189iv8YTuAhV_AxAIHXZICcAQ4dUDCA0&amp;#x26;uact=5&quot;&gt;escrevi quase nada sobre a ferramenta&lt;/a&gt;. Shame!&lt;/p&gt;
&lt;h2&gt;Um baita framework de testes&lt;/h2&gt;
&lt;p&gt;Já falamos sobre os benefícios de escrever testes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/2011/01/27/tdd-desenvolvimento-orientado-testes.html&quot; title=&quot;Leia na íntegra&quot;&gt;TDD: Desenvolvimento Orientado a Testes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/2011/07/18/ferramentas-de-testes-em-django-parte-1.html&quot; title=&quot;Leia na íntegra&quot;&gt;Ferramentas de testes em Django - Parte 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/2011/07/23/ferramentas-de-testes-em-django-parte-2.html&quot; title=&quot;Leia na íntegra&quot;&gt;Ferramentas de testes em Django - Parte 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/2016/02/03/bdd-com-django-e-behave.html&quot; title=&quot;Leia na íntegra&quot;&gt;BDD com Django e Behave&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/2018/01/05/testando-apps-django-com-tox.html&quot; title=&quot;Leia na íntegra&quot;&gt;Testando apps Django com Tox&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/2014/08/07/os-testes-e-os-dubles-parte-1.html&quot; title=&quot;Leia na íntegra&quot;&gt;Os testes e os dublês - Parte 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/2015/06/29/os-testes-e-os-dubles-parte-2.html&quot; title=&quot;Leia na íntegra&quot;&gt;Os testes e os dublês - Parte 2&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Então podemos partir do princípio que testes são mais do que essenciais como ferramenta de &lt;em&gt;design&lt;/em&gt; e desenvolvimento.&lt;/p&gt;
&lt;p&gt;O &lt;em&gt;Pytest&lt;/em&gt; se considera um &lt;em&gt;framework&lt;/em&gt; que tem por objetivo te permitir escrever testes pequenos de maneira fácil, e ainda assim
ser possível escalar o seu uso para testes funcionais complexos.&lt;/p&gt;
&lt;p&gt;Livre e de código-aberto (&lt;a href=&quot;https://github.com/pytest-dev/pytest/blob/master/LICENSE&quot; title=&quot;Leia na íntegra&quot;&gt;MIT&lt;/a&gt;), é hoje
uma alternativa &lt;a href=&quot;https://www.jetbrains.com/lp/python-developers-survey-2019/#FrameworksLibraries&quot; title=&quot;Veja o resultado do survey de 2019&quot;&gt;mais popular que o próprio &lt;em&gt;unittest&lt;/em&gt;&lt;/a&gt; (que faz parte da &lt;em&gt;standard lib&lt;/em&gt;). Rico em &lt;em&gt;plugins&lt;/em&gt;, com ele é possível escrever
testes em diferentes formatos, para diferentes fins.&lt;/p&gt;
&lt;h2&gt;Mão na massa!&lt;/h2&gt;
&lt;p&gt;Vamos aproveitar o &lt;a href=&quot;/2020/12/30/poesia-pythonista-com-poetry.html&quot; title=&quot;Leia o artigo na íntegra&quot;&gt;&lt;em&gt;Poetry&lt;/em&gt;&lt;/a&gt; e iniciar um projeto:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ poetry new my_calc
$ cd my_calc/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O &lt;em&gt;Pytest&lt;/em&gt; já é listado como uma dependência de projetos criados via &lt;code class=&quot;language-text&quot;&gt;poetry&lt;/code&gt;. Portanto, um &lt;code class=&quot;language-text&quot;&gt;poetry install&lt;/code&gt; é o suficiente para
instalá-lo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ poetry install&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ou com o &lt;code class=&quot;language-text&quot;&gt;pip&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pip install pytest&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Vamos ativar o virtualenv com o &lt;em&gt;Poetry&lt;/em&gt;, para que assim as instruções daqui para frente sejam as mesmas para os não-usuários da ferramenta:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ poetry shell&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Encontrando os testes&lt;/h2&gt;
&lt;p&gt;Por padrão, o &lt;em&gt;Pytest&lt;/em&gt; espera que o seus arquivos de teste comecem com &lt;code class=&quot;language-text&quot;&gt;test_&lt;/code&gt;, ou terminem com &lt;code class=&quot;language-text&quot;&gt;_test.py&lt;/code&gt;. Customizações &lt;a href=&quot;https://docs.pytest.org/en/stable/example/pythoncollection.html#changing-naming-conventions&quot; title=&quot;Changing naming conventions&quot;&gt;são possíveis&lt;/a&gt;, mas o padrão já nos atende.&lt;/p&gt;
&lt;p&gt;Vamos começar o teste pela forma convencional, utilizando &lt;code class=&quot;language-text&quot;&gt;unittest&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# tests/test_my_calc.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; unittest &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; TestCase


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestSum&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;TestCase&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_one_plus_one_is_equal_two&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;assertEqual&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; result&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ainda com a &lt;code class=&quot;language-text&quot;&gt;unittest&lt;/code&gt;, executamos o teste:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python -m unittest
E
======================================================================
ERROR: test_one_plus_one_is_equal_two (tests.test_my_calc.TestSum)
----------------------------------------------------------------------
Traceback (most recent call last):
  File &amp;quot;/Users/klauslaube/Workspace/my_calc/tests/test_my_calc.py&amp;quot;, line 7, in test_one_plus_one_is_equal_two
    result = calc(1, &amp;quot;+&amp;quot;, 1)
NameError: name &amp;#39;calc&amp;#39; is not defined

----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Agora utilizando o utilitário de linha de comando, &lt;code class=&quot;language-text&quot;&gt;pytest&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pytest
======================================================================================== test session starts =========================================================================================
platform darwin -- Python 3.8.1, pytest-5.4.3, py-1.10.0, pluggy-0.13.1
rootdir: /Users/klauslaube/Workspace/my_calc
collected 1 item

tests/test_my_calc.py F                                                                                                                                                                        [100%]

============================================================================================== FAILURES ==============================================================================================
_______________________________________________________________________________ TestSum.test_one_plus_one_is_equal_two _______________________________________________________________________________

self = &amp;lt;tests.test_my_calc.TestSum testMethod=test_one_plus_one_is_equal_two&amp;gt;

    def test_one_plus_one_is_equal_two(self):
&amp;gt;       result = calc(1, &amp;quot;+&amp;quot;, 1)
E       NameError: name &amp;#39;calc&amp;#39; is not defined

tests/test_my_calc.py:7: NameError
====================================================================================== short test summary info =======================================================================================
FAILED tests/test_my_calc.py::TestSum::test_one_plus_one_is_equal_two - NameError: name &amp;#39;calc&amp;#39; is not defined
========================================================================================= 1 failed in 0.10s ==========================================================================================&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Como é possível notar, o &lt;em&gt;output&lt;/em&gt; é um pouco mais &lt;em&gt;verbose&lt;/em&gt;. Mas o ponto alto aqui é que, mesmo que o seu projeto esteja
utilizando &lt;code class=&quot;language-text&quot;&gt;unittest&lt;/code&gt; como biblioteca de testes, o &lt;em&gt;test runner&lt;/em&gt; do &lt;code class=&quot;language-text&quot;&gt;pytest&lt;/code&gt; ainda assim
consegue identificar e executá-los.&lt;/p&gt;
&lt;p&gt;Fazer o teste passar vai demandar a criação da função &lt;code class=&quot;language-text&quot;&gt;calc&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# my_calc/calc.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;num1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; operation&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; num2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;E importar a mesma nos testes:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# tests/test_my_calc.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; unittest &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; TestCase
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; my_calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;calc &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; cal

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Executar novamente o &lt;code class=&quot;language-text&quot;&gt;pytest&lt;/code&gt; deve trazer um resultado positivo dessa vez.&lt;/p&gt;
&lt;h2&gt;Escrevendo os testes&lt;/h2&gt;
&lt;p&gt;E se quisermos abrir mão do uso da &lt;code class=&quot;language-text&quot;&gt;unittest&lt;/code&gt;? É perfeitamente possível. O &lt;em&gt;Pytest&lt;/em&gt;
(por padrão) busca por classes de teste com prefixo &lt;code class=&quot;language-text&quot;&gt;Test&lt;/code&gt;, e prefixo &lt;code class=&quot;language-text&quot;&gt;test&lt;/code&gt; para os métodos:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# tests/test_my_calc.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; my_calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;calc &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; calc


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestSum&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_one_plus_one_is_equal_two&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; result&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Podemos ir além, e ao invés de métodos utilizar funções. Isso simplificará bastante o
&lt;em&gt;boilterplate&lt;/em&gt; de código necessário para escrever um teste simples:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# tests/test_my_calc.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; my_calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;calc &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; calc


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_one_plus_one_is_equal_two&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; result&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Antes de ir, vamos refatorar a solução:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# my_calc/calc.py&lt;/span&gt;

OPERATIONS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;lambda&lt;/span&gt; x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; y
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;num1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; operation&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; num2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; OPERATIONS&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;operation&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;num1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; num2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Fixtures&lt;/h3&gt;
&lt;p&gt;Para apresentar o conceito de &lt;em&gt;fixtures&lt;/em&gt;, vamos deixar a calculadora ainda mais &quot;maluca&quot; (para esconder a falta de criatividade de quem vos escreve). Vamos supor que há a seguinte demanda:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# tests/test_my_calc.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; dataclasses &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; dataclass
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; my_calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;calc &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; calc


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dataclass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FakeWrappedValue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_wrapper_object_with_twenty_plus_one_is_equal_to_twenty_one&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    wrapped_value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FakeWrappedValue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;wrapped_value&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;21&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; result&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Os testes vão obviamente falhar. Vamos corrigir a função &lt;code class=&quot;language-text&quot;&gt;calc&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;num1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; operation&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; num2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;num1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; num1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; OPERATIONS&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;operation&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; num2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ainda precisamos garantir que &lt;code class=&quot;language-text&quot;&gt;num2&lt;/code&gt; possa também receber um objeto com atributo &lt;code class=&quot;language-text&quot;&gt;value&lt;/code&gt;.
Para fins didáticos, vamos escrever um novo teste:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# tests/test_my_calc.py&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_one_plus_wrapper_object_with_twentyis_equal_to_twenty_one&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    wrapped_value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FakeWrappedValue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; wrapped_value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;21&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; resul&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O testes falharão novamente. Corrigimos novamente a função:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;num1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; operation&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; num2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;num1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; num1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    y &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;num2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; num2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; OPERATIONS&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;operation&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Pronto! Testes passando novamente, e enfim podemos falar sobre &lt;em&gt;fixtures&lt;/em&gt;. Segundo o
&lt;a href=&quot;https://realpython.com/pytest-python-testing/&quot; title=&quot;Leia o excelente artigo sobre Pytest&quot;&gt;&lt;em&gt;Real Python&lt;/em&gt;&lt;/a&gt;, &lt;em&gt;fixtures&lt;/em&gt; são:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;(...) a way of providing data, test doubles, or state setup to your tests. Fixtures are functions that can return a wide range of values. Each test that depends on a fixture must explicitly accept that fixture as an argument.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Com auxílio do &lt;em&gt;decorator&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;@fixture&lt;/code&gt;, somos capazes de escrever uma função que pode
ser reaproveitada por diferentes testes. Faremos isso com a instância de &lt;code class=&quot;language-text&quot;&gt;FakeWrappedValue&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# tests/test_my_calc.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; pytest
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; dataclasses &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; dataclass
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; my_calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;calc &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; calc


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dataclass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FakeWrappedValue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fixture&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;wrapped_value_with_twenty&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; FakeWrappedValue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_one_plus_one_is_equal_two&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; result


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_wrapper_object_with_twenty_plus_one_is_equal_to_twenty_one&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;wrapped_value_with_twenty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;wrapped_value_with_twenty&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;21&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; result


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_one_plus_wrapper_object_with_twentyis_equal_to_twenty_one&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;wrapped_value_with_twenty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; wrapped_value_with_twenty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;21&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; result&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note a função &lt;code class=&quot;language-text&quot;&gt;wrapped_value_with_twenty&lt;/code&gt; decorada com &lt;code class=&quot;language-text&quot;&gt;pytest.fixture&lt;/code&gt;. Outro ponto importante é que as funções que utilizam esse parâmetro agora recebem ele como argumento.
Por exemplo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_wrapper_object_with_twenty_plus_one_is_equal_to_twenty_one&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;wrapped_value_with_twenty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;wrapped_value_with_twenty&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;21&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; result&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;Fixtures&lt;/em&gt; podem ajudar a abstrair complexidades que não fazem sentido serem evidenciadas
no corpo do teste. Por exemplo (e perceba que esse é um exemplo infinitamente bobo), podemos esconder a &quot;complexidade&quot; de instanciar um objeto com &lt;code class=&quot;language-text&quot;&gt;value&lt;/code&gt; vazio:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fixture&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;empty_wrapped_value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; FakeWrappedValue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_wrapper_object_with_empty_value_plus_one_is_equal_to_one&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;empty_wrapped_value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;empty_wrapped_value&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; result&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Os testes vão quebrar. Ficará ao seu encargo resolver essa aí ;)&lt;/p&gt;
&lt;h3&gt;Escopos&lt;/h3&gt;
&lt;p&gt;Juntamente com as &lt;em&gt;fixtures&lt;/em&gt; vem o conceito de &lt;em&gt;scopes&lt;/em&gt;. É possível encontrar cinco tipos diferentes,
e podemos começar pelo já explorado &quot;function&quot;.&lt;/p&gt;
&lt;p&gt;No exemplo de &lt;em&gt;fixtures&lt;/em&gt; da seção anterior, utilizamos esse tipo de escopo. Por padrão, &lt;em&gt;fixtures&lt;/em&gt; são definidas
com o escopo de função, significando que a &lt;em&gt;fixture&lt;/em&gt; será executada por &lt;em&gt;test function&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;O escopo &lt;code class=&quot;language-text&quot;&gt;class&lt;/code&gt; traz um comportamento um pouco diferente. Quando aplicado a uma classe,
ele funciona como o &lt;code class=&quot;language-text&quot;&gt;setUpClass&lt;/code&gt; do &lt;code class=&quot;language-text&quot;&gt;unittest&lt;/code&gt;. Vamos mudar o arquivo de testes para
vislumbrar a diferença entre esses dois tipos de escopo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# tests/test_my_calc.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; dataclasses &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; dataclass

&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; pytest
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; my_calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;calc &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; calc


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dataclass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FakeWrappedValue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fixture&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;wrapped_value_with_twenty&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Function fixture&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; FakeWrappedValue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fixture&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;scope&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;class&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;x_and_y&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Class fixture&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    request&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cls&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
    request&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cls&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;y &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;usefixtures&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;x_and_y&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestAddingThingsUp&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_one_plus_one_is_equal_two&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;y&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; result

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_wrapper_object_with_twenty_plus_one_is_equal_to_twenty_one&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; wrapped_value_with_twenty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;wrapped_value_with_twenty&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;y&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;21&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; result

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_one_plus_wrapper_object_with_twentyis_equal_to_twenty_one&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; wrapped_value_with_twenty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; wrapped_value_with_twenty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;21&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; result&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Alguns pontos importantes não podem passar em branco:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Note o uso do argumento &lt;code class=&quot;language-text&quot;&gt;scope=&amp;quot;class&amp;quot;&lt;/code&gt; decorando a assinatura da &lt;em&gt;fixture&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;x_and_y&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;pytest.mark.usefixtures&lt;/code&gt; é quem ativa o uso da &lt;em&gt;fixture&lt;/em&gt; na classe &lt;code class=&quot;language-text&quot;&gt;TestAddingThingsUp&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Para visualizar o resultado dos &lt;code class=&quot;language-text&quot;&gt;print&lt;/code&gt;, é preciso executar o &lt;code class=&quot;language-text&quot;&gt;pytest&lt;/code&gt; com o parâmetro &lt;code class=&quot;language-text&quot;&gt;-s&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Note que esse é outro exemplo bobo (:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Já que temos o comportamento do &lt;code class=&quot;language-text&quot;&gt;setUp&lt;/code&gt;, conseguimos ter o &lt;code class=&quot;language-text&quot;&gt;tearDown&lt;/code&gt;? Sim! Com um &lt;code class=&quot;language-text&quot;&gt;yield&lt;/code&gt;
dentro da &lt;em&gt;fixture&lt;/em&gt;, você consegue &quot;agendar&quot; código a ser executado como parte do
&lt;em&gt;off-load&lt;/em&gt; da mesma:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fixture&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;scope&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;class&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;x_and_y&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Class fixture&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    request&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cls&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
    request&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cls&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;y &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Tearing things down!!!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Uma vez que fica claro o funcionamento dos &lt;em&gt;scopes&lt;/em&gt;, os três restantes são quase intuitivos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Module:&lt;/strong&gt; Executa a &lt;em&gt;fixture&lt;/em&gt; por módulo;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Package:&lt;/strong&gt; Executa a &lt;em&gt;fixture&lt;/em&gt; por pacote;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Session:&lt;/strong&gt; Cada vez que você executa o &lt;em&gt;Pytest&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Para fins didáticos, vamos utilizar outro argumento na construção das &lt;em&gt;fixtures&lt;/em&gt;
que exemplificarão como esses escopos funcionam. Estamos falando do &lt;code class=&quot;language-text&quot;&gt;autouse&lt;/code&gt;, e sem
nenhuma surpresa, ele faz a &lt;em&gt;fixture&lt;/em&gt; ser executada automaticamente:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fixture&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;scope&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;module&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; autouse&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;saying_hello_per_module&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Module fixture&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fixture&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;scope&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;package&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; autouse&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;saying_hello_per_package&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Package fixture&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fixture&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;scope&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;session&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; autouse&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;saying_hello_per_session&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Session fixture&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Agora com o &lt;code class=&quot;language-text&quot;&gt;pytest -s&lt;/code&gt;, podemos ver na prática o que acontece:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pytest -s

(...)

tests/test_my_calc.py Session fixture
Package fixture
Module fixture
Class fixture
.Function fixture
.Function fixture
.Tearing things down!!!&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Baterias inclusas + plugins == sucesso!&lt;/h2&gt;
&lt;p&gt;Há muitos outros conceitos por trás do &lt;em&gt;Pytest&lt;/em&gt;. Do arquivo &lt;em&gt;conftest.py&lt;/em&gt; ao
&lt;a href=&quot;https://stribny.name/blog/pytest/#parametrized-tests&quot; title=&quot;Testing Python applications with Pytest&quot;&gt;@parametrize&lt;/a&gt;, você vai encontrar funcionalidades incríveis que aumentarão
a sua produtividade escrevendo testes.&lt;/p&gt;
&lt;p&gt;E quando adicionamos os &lt;em&gt;plugins&lt;/em&gt; do &lt;em&gt;Pytest&lt;/em&gt; à equação, tudo fica mais divertido.
Para começar, se você está escrevendo testes em &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt; e quer utilizar &lt;em&gt;Pytest&lt;/em&gt;, o &lt;a href=&quot;https://pytest-django.readthedocs.io/en/latest/&quot; title=&quot;Leia a documentação da biblioteca&quot;&gt;pytest-django&lt;/a&gt; é mais que obrigatório. Ele resolverá tudo o que precisa-se resolver (banco de dados, sessões, transações, etc)
&lt;em&gt;out of the box&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Outros grande &lt;em&gt;plugins&lt;/em&gt; são:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/pytest-dev/pytest-bdd&quot; title=&quot;Acesse o repositório no Github&quot;&gt;pytest-bdd&lt;/a&gt;: &lt;em&gt;BDD&lt;/em&gt; sem precisar de outro &lt;em&gt;test runner&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/pytest-dev/pytest-cov&quot; title=&quot;Acesse o repositório no Github&quot;&gt;pytest-cov&lt;/a&gt;: Relatório de &lt;em&gt;test coverage&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/ktosiek/pytest-freezegun&quot; title=&quot;Acesse o repositório no Github&quot;&gt;pytest-freezegun&lt;/a&gt;: Congele o tempo com essa integração com o &lt;em&gt;Freezegun&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/pytest-dev/pytest-instafail&quot; title=&quot;Acesse o repositório no Github&quot;&gt;pytest-instafail&lt;/a&gt;: Mostra falhas e erros antes do fim da sessão de testes&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/miketheman/pytest-socket&quot; title=&quot;Acesse o repositório no Gihub&quot;&gt;pytest-socket&lt;/a&gt;: Previna &lt;em&gt;network calls&lt;/em&gt; indesejadas&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/Teemu/pytest-sugar&quot; title=&quot;Acesse o repositório no Github&quot;&gt;pytest-sugar&lt;/a&gt;: Progress bar e uma melhor visualização de falhas e erros&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/pytest-dev/pytest-xdist&quot; title=&quot;Acesse o repositório no Github&quot;&gt;pytest-xdist&lt;/a&gt;: Paralelize a execução dos testes&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;https://awesomeopensource.com/projects/pytest&quot; title=&quot;Veja projetos relacionados com Pytest&quot;&gt;A lista é imensa&lt;/a&gt;, e garanto que há um &lt;em&gt;plugin&lt;/em&gt; por aí pronto para resolver os seus problemas.&lt;/p&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;O &lt;em&gt;Pytest&lt;/em&gt; faz parte daquele seleto grupo de bibliotecas que instalamos imediatamente após iniciar um projeto. É rico, poderoso, flexível,
e faz do desenvolvimento orientado a testes uma experiência muito mais satisfatória, do que com a opção utilizando a &lt;em&gt;standard lib&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Atualmente na &lt;a href=&quot;https://www.sonofatailor.com/&quot; title=&quot;Custom fitted T-shirts&quot;&gt;&lt;em&gt;Son of a Tailor&lt;/em&gt;&lt;/a&gt;, estamos aumentando o nosso &lt;em&gt;coverage&lt;/em&gt; e gradativamente
adotando as baterias inclusas do &lt;em&gt;Pytest&lt;/em&gt;. Todos os testes, no entanto, utilizam a &lt;code class=&quot;language-text&quot;&gt;django.tests.TestCase&lt;/code&gt;. Mesmo assim, fomos capazes de trocar o &lt;em&gt;test runner&lt;/em&gt; para o &lt;em&gt;Pytest&lt;/em&gt;,
e tirar proveito de seus &lt;em&gt;plugins&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Sem nenhum problema.&lt;/p&gt;
&lt;p&gt;Até a próxima!&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/better-programming/understand-5-scopes-of-pytest-fixtures-1b607b5c19ed&quot;&gt;BetterProgramming: Understand 5 Scopes of Pytest Fixtures&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://realpython.com/pytest-python-testing/&quot;&gt;Real Python: Effective Python Testing with Pytest&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://semaphoreci.com/community/tutorials/testing-python-applications-with-pytest&quot;&gt;Semaphore: Testing Python Applications with Pytest&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://stribny.name/blog/pytest/&quot;&gt;Software development and beyond: Testing Python applications with Pytest&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[BDD com Django e Behave]]></title><description><![CDATA[Testar o comportamento da sua aplicação, ao invés de pequenos módulos isolados,
é uma grande prática no que diz respeito a escrita de testes que guiem o
seu desenvolvimento. Deixando a polêmica do "TDD is dead"
de lado, criar cenários que garantem um determinado fluxo, além de servir
como um…]]></description><link>https://klauslaube.com.br/2016/02/03/bdd-com-django-e-behave.html</link><guid isPermaLink="false">https://klauslaube.com.br/2016/02/03/bdd-com-django-e-behave.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Wed, 03 Feb 2016 23:50:00 GMT</pubDate><content:encoded>&lt;p&gt;Testar o comportamento da sua aplicação, ao invés de pequenos módulos isolados,
é uma grande prática no que diz respeito a escrita de testes que guiem o
seu desenvolvimento.&lt;/p&gt;
&lt;p&gt;Deixando a polêmica do &quot;&lt;a href=&quot;http://david.heinemeierhansson.com/2014/tdd-is-dead-long-live-testing.html&quot; title=&quot;TDD is dead. Long live testing.&quot;&gt;TDD is dead&lt;/a&gt;&quot;
de lado, criar cenários que garantem um determinado fluxo, além de servir
como um excelente contrato à sua suite de aceitação, é uma ótima ferramenta
para garantir que a integração &lt;em&gt;back-end/front-end&lt;/em&gt; está funcionando de acordo
com o esperado.&lt;/p&gt;
&lt;p&gt;Devo ser sincero com você, caro leitor: Fazer &lt;a href=&quot;/tag/bdd.html&quot; title=&quot;Leia mais sobre BDD&quot;&gt;&lt;em&gt;BDD&lt;/em&gt;&lt;/a&gt;
com &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt; (IMO) sempre foi uma dor de cabeça.
Já utilizei algumas ferramentas, como &lt;a href=&quot;/2011/07/18/ferramentas-de-testes-em-django-parte-1.html&quot;&gt;&lt;em&gt;unittest&lt;/em&gt;&lt;/a&gt;
focado em comportamento, &lt;a href=&quot;/2011/07/18/ferramentas-de-testes-em-django-parte-1.html&quot;&gt;&lt;em&gt;doctests&lt;/em&gt;&lt;/a&gt;,
&lt;a href=&quot;/2011/07/23/ferramentas-de-testes-em-django-parte-2.html&quot;&gt;&lt;em&gt;Lettuce&lt;/em&gt;&lt;/a&gt;, &lt;em&gt;Pycurracy&lt;/em&gt; e até mesmo &lt;em&gt;Jasmine&lt;/em&gt;...
Nada pareceu ser &quot;o certo a se fazer&quot;.&lt;/p&gt;
&lt;p&gt;Recentemente esbarrei com um artigo ensinando a usar o &lt;a href=&quot;http://pythonhosted.org/behave/&quot; title=&quot;BDD for Python&quot;&gt;&lt;em&gt;Behave&lt;/em&gt;&lt;/a&gt;,
um &lt;em&gt;engine&lt;/em&gt; de testes &lt;em&gt;BDD&lt;/em&gt; para &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt;...
E foi aí que a minha opinião mudou.&lt;/p&gt;
&lt;h2&gt;Oh, behave!&lt;/h2&gt;
&lt;p&gt;O &lt;em&gt;Behave&lt;/em&gt; é uma biblioteca &lt;em&gt;Python&lt;/em&gt; que permite a escrita de &lt;em&gt;specs&lt;/em&gt; em linguagem humana,
e a execução dos cenários através de &lt;em&gt;asserts&lt;/em&gt; em &quot;linguagem de programação&quot;. Agnóstico de &lt;em&gt;framework&lt;/em&gt;,
é um &lt;em&gt;engine&lt;/em&gt; promissor, &lt;a href=&quot;http://pythonhosted.org/behave/tutorial.html&quot; title=&quot;Conheça o tutorial do Behave&quot;&gt;fácil de usar&lt;/a&gt;,
e que possui uma boa comunidade dando suporte.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 480px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/bb6cb6691f182c0f762c2544f9a48ceb/7cc5e/oh-behave.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 86.45833333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBAEF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAgMA/9oADAMBAAIQAxAAAAGeC+3Lzms5ciPUis//xAAbEAADAAIDAAAAAAAAAAAAAAAAAQIDEBETQf/aAAgBAQABBQLNdi5FLZMWxxlO1zpnv//EABkRAAEFAAAAAAAAAAAAAAAAAAEAAhARIf/aAAgBAwEBPwFpxWJ//8QAGREAAgMBAAAAAAAAAAAAAAAAAAECEBMh/9oACAECAQE/AXHplSP/xAAdEAABBAIDAAAAAAAAAAAAAAAAAQIRIRASQXGx/9oACAEBAAY/AtuCyhXFekQ3C9in/8QAGxAAAwEBAAMAAAAAAAAAAAAAAAERITFRcbH/2gAIAQEAAT8hfqJqZBr7Yjq1CunclwYWEhW9ye4efZ8ow//aAAwDAQACAAMAAAAQw+f+/8QAGREAAwADAAAAAAAAAAAAAAAAAAERMVFx/9oACAEDAQE/EE1Rlvo8n//EABgRAAMBAQAAAAAAAAAAAAAAAAARITFR/9oACAECAQE/EJEVWcMH/8QAHRAAAgMAAgMAAAAAAAAAAAAAAREAIUEx8GGhwf/aAAgBAQABPxAcflAuyrUNZMHWVfLiKgEgo65ceWMEwqJ8iDDbTg7GgYoUCxWQ8dMnDooz3vgn/9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;&amp;quot;Austin Powers: Oh behave (flickr.com)&amp;quot;&quot;
        title=&quot;Austin Powers: Oh behave (flickr.com)&quot;
        src=&quot;/static/bb6cb6691f182c0f762c2544f9a48ceb/7cc5e/oh-behave.jpg&quot;
        srcset=&quot;/static/bb6cb6691f182c0f762c2544f9a48ceb/7809d/oh-behave.jpg 192w,
/static/bb6cb6691f182c0f762c2544f9a48ceb/4ecad/oh-behave.jpg 384w,
/static/bb6cb6691f182c0f762c2544f9a48ceb/7cc5e/oh-behave.jpg 480w&quot;
        sizes=&quot;(max-width: 480px) 100vw, 480px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;Austin Powers: Oh behave (flickr.com)&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Você pode escrever a integração do &lt;em&gt;lib&lt;/em&gt; com o &lt;em&gt;Django&lt;/em&gt;, como demonstrado na &lt;a href=&quot;http://pythonhosted.org/behave/django.html&quot; title=&quot;Exemplo de integração entre Behave e Django&quot;&gt;documentação oficial&lt;/a&gt;.
Como eu sou preguiçoso, prefiro utilizar o módulo &lt;code class=&quot;language-text&quot;&gt;behave-django&lt;/code&gt;,
criado por &lt;a href=&quot;https://github.com/mixxorz&quot; title=&quot;Perfil do mixxorz no GitHub&quot;&gt;Mitchel Cabuloy&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pip install behave-django&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Não podemos esquecer de colocá-lo no &lt;code class=&quot;language-text&quot;&gt;INSTALLED_APPS&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;INSTALLED_APPS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;behave_django&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Agora basta criar uma estrutura na raíz do seu projeto (no mesmo nível do &lt;code class=&quot;language-text&quot;&gt;manage.py&lt;/code&gt;), com a seguinte formação:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;features/
    steps/
        steps.py
    environment.py
    funcionalidade.feature&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Vamos para um exemplo mais prático: &lt;em&gt;Eu quero que minha home exiba meu nome de usuário, caso eu esteja logado&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Começaremos pelo arquivo &lt;code class=&quot;language-text&quot;&gt;.feature&lt;/code&gt;. Vou chamá-lo de &lt;code class=&quot;language-text&quot;&gt;features/home-logada.feature&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Feature: Logged in page

    Scenario: Access index page

        Given an authenticated user
        When I access the home page
        Then I see my username printed&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Já podemos executar o &lt;code class=&quot;language-text&quot;&gt;behave&lt;/code&gt; através do &lt;code class=&quot;language-text&quot;&gt;manage.py&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py behave&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Você verá uma saída sinalizando que nosso cenário está montado, mas
que ainda não há testes executando de fato.&lt;/p&gt;
&lt;p&gt;O arquivo de teste pode ter o nome que você desejar, o &lt;em&gt;Behave&lt;/em&gt; olhará
para cada ocorrência dentro de &lt;code class=&quot;language-text&quot;&gt;steps/&lt;/code&gt; e coletará os passos que serão
usados para a execução das especificações.&lt;/p&gt;
&lt;p&gt;Mas antes de escrevermos os testes, vamos falar de uma ferramenta essencial
quando estamos fazendo testes de interface &lt;em&gt;web&lt;/em&gt; com &lt;em&gt;Python&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Splinter&lt;/h2&gt;
&lt;p&gt;Diretamente da &lt;a href=&quot;https://splinter.readthedocs.org/en/latest/&quot; title=&quot;Documentação do Splinter&quot;&gt;documentação oficial&lt;/a&gt; do &lt;em&gt;Splinter&lt;/em&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Splinter is an open source tool for testing web applications using Python. It lets you automate browser actions,
such as visiting URLs and interacting with their items.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;A ferramenta fornece uma &lt;em&gt;API&lt;/em&gt; única para diferentes ferramentas de
testes de interface &lt;em&gt;web&lt;/em&gt;, como &lt;em&gt;Selenium&lt;/em&gt;, &lt;em&gt;PhantomJS&lt;/em&gt; e &lt;em&gt;zope.testbrowser&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Conseguimos instalá-la de forma muito fácil, através do comando &lt;code class=&quot;language-text&quot;&gt;pip&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ pip install splinter&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;É ele que nos permite, através de sua interface, escrever testes utilizando o driver do
&lt;em&gt;Firefox&lt;/em&gt; (por exemplo), e deixar as &lt;em&gt;tasks&lt;/em&gt; executando em nosso servidor de integração
contínua com um driver &lt;em&gt;headless&lt;/em&gt;, como o &lt;em&gt;PhantomJS&lt;/em&gt;.&lt;/p&gt;
&lt;h3&gt;Django + Behave + Splinter == Epic Win&lt;/h3&gt;
&lt;p&gt;Podemos utilizar o &lt;em&gt;Splinter&lt;/em&gt; juntamente com a mecânica de teste do &lt;em&gt;Behave&lt;/em&gt;.
A maneira mais fácil é através do esquema de configuração da suite,
criando o arquivo &lt;code class=&quot;language-text&quot;&gt;features/environment.py&lt;/code&gt;, com o seguinte conteúdo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; splinter &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Browser


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;before_all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Browser&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;server_url &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;http://localhost:8000&apos;&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;after_all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;quit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Pronto! O contexto dos nossos testes tem a propriedade &lt;code class=&quot;language-text&quot;&gt;browser&lt;/code&gt;, que é a instância do &lt;em&gt;Splinter&lt;/em&gt;
para execução dos testes de interface.&lt;/p&gt;
&lt;p&gt;As &lt;em&gt;specs&lt;/em&gt; executarão com o &lt;em&gt;Firefox&lt;/em&gt;, por padrão. Caso queira alterar o navegador,
basta especificá-lo na instância de &lt;code class=&quot;language-text&quot;&gt;Browser&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Browser&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;chrome&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Dado um determinado cenário&lt;/h2&gt;
&lt;p&gt;Vamos escrever o código &lt;em&gt;Python&lt;/em&gt; necessário para atender a seguinte condição:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Given an authenticated user&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Para isso, criaremos um &lt;em&gt;step&lt;/em&gt; específico para autenticação:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# features/steps/auth.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; behave &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; given
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;contrib&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;auth&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;models &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; User


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@given&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;an authenticated user&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;given_auth_user&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    User&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create_superuser&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;username&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;test&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; email&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;foo@bar&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; password&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;test&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    br &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser
    br&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;visit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;base_url &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;/admin/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    br&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fill&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;username&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;test&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    br&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fill&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;password&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;test&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    br&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;find_by_css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;.submit-row input&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;first&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;click&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O código acima é simples e objetivo. Através do &lt;em&gt;decorator&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;@given&lt;/code&gt; associamos um determinado
pedaço de código &lt;em&gt;Python&lt;/em&gt; a um trecho das histórias escritas em &lt;code class=&quot;language-text&quot;&gt;.feature&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Rodando o &lt;code class=&quot;language-text&quot;&gt;behave&lt;/code&gt;, teremos uma saída similar a essa:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py behave

Creating test database for alias &amp;#39;default&amp;#39;...
Feature: Logged in page # features/home-logada.feature:1

    Scenario: Access index page    # features/home-logada.feature:3
    Given an authenticated user    # features/steps/auth.py:5 0.646s
    When I access the home page    # None
    Then I see my username printed # None&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O motor de testes, além de identificar e executar o trecho de código necessário
para contemplar uma expressão, exibe o tempo de execução da mesma.&lt;/p&gt;
&lt;h2&gt;Quando alguma coisa acontece&lt;/h2&gt;
&lt;p&gt;Vamos para a parte onde o usuário interage com a aplicação.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# features/steps/actions.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; behave &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; when


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@when&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;I access the home page&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;access_the_home_page&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    br &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser
    br&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;visit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;base_url &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Aqui começa a ficar mais evidente o funcionamento de &lt;em&gt;steps&lt;/em&gt;. Se amanhã
eu precisar de um novo cenário onde é necessário acessar a página inicial,
eu posso aproveitar o &lt;code class=&quot;language-text&quot;&gt;when&lt;/code&gt; criado acima. O &lt;em&gt;Behave&lt;/em&gt; fará isso automaticamente
para você... Portanto, organizar os &lt;em&gt;steps&lt;/em&gt; de uma forma que eles agrupem
um determinado grupo de ações é uma sugestão interessante.&lt;/p&gt;
&lt;h2&gt;Então eu espero algum resultado&lt;/h2&gt;
&lt;p&gt;E para finalizar o nosso exemplo, vamos para o &lt;em&gt;decorator&lt;/em&gt; de &lt;code class=&quot;language-text&quot;&gt;@then&lt;/code&gt;,
que é o passo onde validamos o resultado dos acontecimentos disparados por &lt;code class=&quot;language-text&quot;&gt;@when&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# features/steps/results.py&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; behave &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; then


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@then&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;I see my username printed&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;see_my_username&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    br &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser
    body &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; br&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;find_by_css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;body&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Hello test!&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; body&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Pronto! Executamos nossas &lt;em&gt;specs&lt;/em&gt; e temos o seguinte resultado:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py behave

Creating test database for alias &amp;#39;default&amp;#39;...
Feature: Logged in page # features/home-logada.feature:1

    Scenario: Access index page      # features/home-logada.feature:3
    Given an authenticated user    # features/steps/auth.py:5 0.654s
    When I access the home page    # features/steps/actions.py:4 0.888s
    Then I see my username printed # features/steps/results.py:4 0.075s

1 feature passed, 0 failed, 0 skipped
1 scenario passed, 0 failed, 0 skipped
3 steps passed, 0 failed, 0 skipped, 0 undefined
Took 0m1.617s
Destroying test database for alias &amp;#39;default&amp;#39;...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Garantimos através dos cenários acima que, dado um usuário logado,
imprimiremos o seu &lt;em&gt;username&lt;/em&gt; na rota &lt;code class=&quot;language-text&quot;&gt;http://localhost:8000/&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;O &lt;em&gt;Behave&lt;/em&gt; é uma ótima ferramenta de &lt;em&gt;BDD&lt;/em&gt; para &lt;em&gt;Python&lt;/em&gt;. Sua integração
com o &lt;em&gt;Django&lt;/em&gt; e demais &lt;em&gt;frameworks&lt;/em&gt; é relativamente simples, o que só
aumenta a simpatia pela ferramenta.&lt;/p&gt;
&lt;p&gt;Já sofri muito com escrita de testes de aceitação com &lt;em&gt;Django&lt;/em&gt;. Não é
um veredicto, mas até o momento o sentimento é extremamente positivo em relação
ao casamento entre &lt;em&gt;Behave&lt;/em&gt; e &lt;em&gt;Django&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Até a próxima!&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://pythonhosted.org/behave/&quot;&gt;&lt;em&gt;Behave: Behavior-Driven Development, Python style&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/mixxorz/behave-django&quot;&gt;&lt;em&gt;GitHub: behave-django&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://splinter.readthedocs.org/en/latest/&quot;&gt;&lt;em&gt;Splinter: Tool for testing web applications using Python&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Ferramentas de testes em Django - Parte 2]]></title><description><![CDATA[No post anterior,
conhecemos as ferramentas default para construção de testes
automatizados em Django. Acontece que você pode “sair um pouco da
caixa” e usufruir de ferramentas “third-party“, que enriquecerão o seu
ambiente de desenvolvimento e lhe trarão maior segurança em seus testes
de software…]]></description><link>https://klauslaube.com.br/2011/07/23/ferramentas-de-testes-em-django-parte-2.html</link><guid isPermaLink="false">https://klauslaube.com.br/2011/07/23/ferramentas-de-testes-em-django-parte-2.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Sat, 23 Jul 2011 18:00:00 GMT</pubDate><content:encoded>&lt;p&gt;No &lt;a href=&quot;/2011/07/18/ferramentas-de-testes-em-django-parte-1.html&quot; title=&quot;Ferramentas de testes em Django - Parte 1&quot;&gt;&lt;em&gt;post&lt;/em&gt; anterior&lt;/a&gt;,
conhecemos as ferramentas &lt;em&gt;default&lt;/em&gt; para construção de testes
automatizados em &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;. Acontece que você pode “sair um pouco da
caixa” e usufruir de ferramentas “third-party“, que enriquecerão o seu
ambiente de desenvolvimento e lhe trarão maior segurança em seus &lt;a href=&quot;/tag/testes.html&quot; title=&quot;Leia mais sobre testes&quot;&gt;testes
de &lt;em&gt;software&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;splinter – Testando a sua aplicação com um navegador&lt;/h2&gt;
&lt;p&gt;É perfeitamente possível criar testes de aceitação em &lt;em&gt;Django&lt;/em&gt; com a
&lt;a href=&quot;https://docs.djangoproject.com/en/dev/topics/testing/#module-django.test.client&quot; title=&quot;Testando aplicações web com test client em Django&quot;&gt;&lt;em&gt;TestClient&lt;/em&gt;&lt;/a&gt; e &lt;a href=&quot;http://lxml.de/&quot; title=&quot;Faça parser XML e HTML com lxml&quot;&gt;&lt;em&gt;lxml&lt;/em&gt;&lt;/a&gt;. Mas vamos ser sinceros, é deveras
trabalhoso “parsear” os resultados das suas &lt;em&gt;views&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Com a &lt;a href=&quot;http://splinter.cobrateam.info/&quot; title=&quot;Visite a documentação oficial da Splinter&quot;&gt;&lt;em&gt;Splinter&lt;/em&gt;&lt;/a&gt;, uma ferramenta para testes de aplicações
&lt;a href=&quot;/tag/desenvolvimento-web.html&quot; title=&quot;Leia mais sobre Web&quot;&gt;&lt;em&gt;web&lt;/em&gt;&lt;/a&gt;, você pode automatizar ações executadas por navegadores, como
visitar uma página, preencher um formulário ou clicar em um &lt;em&gt;link&lt;/em&gt;; tudo
isso sem preocupar-se com &lt;em&gt;parsing&lt;/em&gt;, nós, &lt;em&gt;DOM&lt;/em&gt;, nem nada do tipo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; splinter&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Browser

browser &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Browser&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Visitar uma URL&lt;/span&gt;
url &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;http://search.twitter.com&quot;&lt;/span&gt;
browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;visit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fill&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;q&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;#cobrateam&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Procurar e clicar no botão &apos;search&apos;&lt;/span&gt;
button &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;find_by_css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;#searchButton input&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;first

&lt;span class=&quot;token comment&quot;&gt;# Interagir com os elementos&lt;/span&gt;
button&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;click&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;is_text_present&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;No results for #cobrateam&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;nobody likes us =(&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;we&apos;re popular =)&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O que eu acho mais bacana nesta ferramenta são os seletores, facilitam
muito na hora de checar resultados e comportamentos.&lt;/p&gt;
&lt;p&gt;A comunidade em volta desta ferramenta está em constante crescimento e
atividade. Portanto, caso você queira contribuir com o projeto, vá agora
mesmo para o &lt;a href=&quot;https://github.com/cobrateam/splinter&quot; title=&quot;Repositório da Splinter no GitHub&quot;&gt;repositório no &lt;em&gt;GitHub&lt;/em&gt; e colabore&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;nose – Caçando testes em seu projeto (Python)&lt;/h2&gt;
&lt;p&gt;E quando queremos fugir da regra? Aposto que chegará um momento em que a
estrutura de diretórios padrão, necessária para a execução dos seus
testes em &lt;em&gt;Django&lt;/em&gt;, não te satisfará mais. O que fazer neste caso?
Simples, recorra ao &lt;em&gt;Nose&lt;/em&gt;!&lt;/p&gt;
&lt;p&gt;O &lt;a href=&quot;http://somethingaboutorange.com/mrl/projects/nose/1.0.0/&quot; title=&quot;Nose - is nicer testing for Python&quot;&gt;&lt;em&gt;Nose&lt;/em&gt;&lt;/a&gt; estende os recursos da &lt;em&gt;unittest&lt;/em&gt; e facilita a escrita
e carregamento dos testes em projetos &lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt;. De uma forma mais
detalhada, ele percorre o seu projeto (ou uma determinada região de seu
escolha) executando subclasses da &lt;code class=&quot;language-text&quot;&gt;unittest.TestCase&lt;/code&gt; ou funções que
contenham “test”. Por exemplo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# test_subclasse.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; unittest

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SubclasseTest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;unittest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TestCase&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_um_eh_verdadeiro&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;assertTrue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# test_funcao.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_zero_eh_falso&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ao executar o comando &lt;strong&gt;nosetests&lt;/strong&gt; o &lt;em&gt;nose&lt;/em&gt; se encarregará de procurar
e carregar os testes:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ nosetests
..
----------------------------------------------------------------------
Ran 2 tests in 0.005s

OK&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;É claro que existe uma “mágica” aí. Na verdade o &lt;em&gt;nose&lt;/em&gt; pesquisará por
&lt;strong&gt;arquivos&lt;/strong&gt; &lt;em&gt;Python&lt;/em&gt; com “test” em seu nome, por &lt;strong&gt;funções&lt;/strong&gt; com “test”
em seu enunciado, e por &lt;strong&gt;classes&lt;/strong&gt; com métodos “test” em sua
declaração. Ele age mesmo como um “runner“, tendo a capacidade de lidar
com testes escritos com &lt;em&gt;unittest&lt;/em&gt; ou não.&lt;/p&gt;
&lt;p&gt;Essa é só a ponta do &lt;em&gt;iceberg&lt;/em&gt;. É possível construir &lt;em&gt;plugins&lt;/em&gt; para o
&lt;em&gt;nose&lt;/em&gt;, permitindo melhorar ainda mais o seu ambiente de testes (como
por exemplo, permitir que o &lt;a href=&quot;http://pypi.python.org/pypi/nosepipe/&quot; title=&quot;Conheça o nosepipe&quot;&gt;&lt;em&gt;nose&lt;/em&gt; funcione em &lt;em&gt;subprocess&lt;/em&gt;
separados&lt;/a&gt;).&lt;/p&gt;
&lt;h3&gt;Caçando testes em seu projeto (Django)&lt;/h3&gt;
&lt;p&gt;Para facilitar ainda mais a escrita de testes em &lt;em&gt;Django&lt;/em&gt; existem
&lt;em&gt;plugins&lt;/em&gt; como o &lt;a href=&quot;http://pypi.python.org/pypi/django-nose&quot; title=&quot;Utilize o nose em seus projetos Django&quot;&gt;&lt;em&gt;django-nose&lt;/em&gt;&lt;/a&gt;, que permite que você substitua o
&lt;em&gt;Test Runner&lt;/em&gt; padrão da &lt;em&gt;framework&lt;/em&gt; por um específico que utiliza o
&lt;em&gt;nose&lt;/em&gt;, unindo assim a facilidade e “add-ons” do &lt;em&gt;nose&lt;/em&gt; com o ambiente
de testes do &lt;em&gt;Django&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;lettuce – BDD em Django&lt;/h2&gt;
&lt;p&gt;E se você estava se perguntando sobre &lt;a href=&quot;/tag/bdd.html&quot; title=&quot;Leia mais sobre BDD&quot;&gt;&lt;em&gt;BDD&lt;/em&gt;&lt;/a&gt; em &lt;em&gt;Django&lt;/em&gt;, eu
apresento a &lt;a href=&quot;http://lettuce.it/intro/overview.html#intro-overview&quot; title=&quot;Saiba mais sobre a lettuce&quot;&gt;&lt;em&gt;Lettuce&lt;/em&gt;&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;Esta ferramenta, baseada na &lt;a href=&quot;http://cukes.info/&quot; title=&quot;Cucumber - Making BDD fun&quot;&gt;&lt;em&gt;Cucumber&lt;/em&gt;&lt;/a&gt;, permite com que você escreva
histórias utilizando linguagem ubíqua, mais próxima da área de negócios
do que da área técnica, e automatize a validação delas.&lt;/p&gt;
&lt;p&gt;O mais bacana é que ela já vem preparada para o &lt;em&gt;Django&lt;/em&gt;, permitindo que
a gente execute os testes de comportamento de forma fácil e rápida:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;gherkin&quot;&gt;&lt;pre class=&quot;language-gherkin&quot;&gt;&lt;code class=&quot;language-gherkin&quot;&gt;&lt;span class=&quot;token feature&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;Feature:&lt;/span&gt;&lt;span class=&quot;token important&quot;&gt; Rocking with lettuce and django&lt;/span&gt;

&lt;/span&gt;    &lt;span class=&quot;token scenario&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;Scenario:&lt;/span&gt;&lt;span class=&quot;token important&quot;&gt; Simple Hello World&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;token atrule&quot;&gt;Given&lt;/span&gt; &lt;span class=&quot;token atrule&quot;&gt;I&lt;/span&gt; access the url &lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt;
        &lt;span class=&quot;token atrule&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;token atrule&quot;&gt;I&lt;/span&gt; see the header &lt;span class=&quot;token string&quot;&gt;&quot;Hello World&quot;&lt;/span&gt;

    &lt;span class=&quot;token scenario&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;Scenario:&lt;/span&gt;&lt;span class=&quot;token important&quot;&gt; Hello + capitalized name&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;token atrule&quot;&gt;Given&lt;/span&gt; &lt;span class=&quot;token atrule&quot;&gt;I&lt;/span&gt; access the url &lt;span class=&quot;token string&quot;&gt;&quot;/some-name&quot;&lt;/span&gt;
        &lt;span class=&quot;token atrule&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;token atrule&quot;&gt;I&lt;/span&gt; see the header &lt;span class=&quot;token string&quot;&gt;&quot;Hello Some Name&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;História escrita, vamos escrever o &lt;em&gt;script&lt;/em&gt; &lt;em&gt;Python&lt;/em&gt; que validará se está
tudo de acordo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; lettuce &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; lxml &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; html
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;test&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;client &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Client

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@before&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;all&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;set_browser&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    world&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Client&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@step&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;r&apos;I access the url &quot;(.*)&quot;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;access_url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;step&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; world&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    world&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dom &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; html&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fromstring&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;content&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@step&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;r&apos;I see the header &quot;(.*)&quot;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;see_header&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;step&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; text&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    header &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; world&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dom&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cssselect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;h1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; header&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; text&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Basta executá-lo da seguinte maneira:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py harvest&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;http://lettuce.it/recipes/django-lxml.html#recipes-django-lxml&quot; title=&quot;Django + Lettuce, uma dupla interessante!&quot;&gt;Confira mais informações sobre como utilizar o &lt;em&gt;lettuce&lt;/em&gt; com &lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;fudge – Ajude o Python a mentir&lt;/h2&gt;
&lt;p&gt;O &lt;a href=&quot;http://farmdev.com/projects/fudge/&quot; title=&quot;Fudge, criando objetos mentirosos&quot;&gt;&lt;em&gt;Fudge&lt;/em&gt;&lt;/a&gt; é um módulo &lt;em&gt;Python&lt;/em&gt; que auxilia na construção de
objetos “dublês” (&lt;a href=&quot;http://www.infoq.com/br/articles/mocks-Arent-Stubs&quot; title=&quot;Mocks não são Stubs&quot;&gt;&lt;em&gt;mocks&lt;/em&gt; e &lt;em&gt;stubs&lt;/em&gt;&lt;/a&gt;), que permitem escrever testes
sem necessariamente possuir um serviço ativo ou um objeto construído.&lt;/p&gt;
&lt;p&gt;Um caso comum: Você está construindo uma &lt;em&gt;API&lt;/em&gt; que autentica via &lt;em&gt;OAuth&lt;/em&gt;
ao &lt;em&gt;Twitter&lt;/em&gt; e está utilizando testes para guiar o seu desenvolvimento.
Não é interessante que nossos testes sejam dependentes da
disponibilidade do serviço do &lt;em&gt;Twitter&lt;/em&gt;, portanto, escrevemos um “objeto
mentiroso”, que simulará este serviço, aceitando uma entrada e gerando
um saída:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; fudge

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@fudge&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;patch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;oauthtwitter.OAuthApi&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;FakeOAuthApi&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;FakeOAuthApi&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;expects_call&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;with_args&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;returns_fake&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;expects&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;UpdateStatus&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;with_arg_count&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

post_msg_to_twitter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;hey there fellow testing freaks!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Pronto! Sabendo que valores serão passados, e quais os resultados,
podemos simular o comportamento daquele serviço. Prático, não?&lt;/p&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;Estas são as ferramentas que eu costumo utilizar em meus projetos
&lt;em&gt;Python/Django&lt;/em&gt;. É claro que existem outras, na verdade existem várias.
Tenha em mente que a ferramenta é apenas um meio de garantir, através de
testes, que você está guiando a sua aplicação para o lugar certo. Os
testes automatizados no final servem para garantir que ela ainda segue
este caminho, que contribuições realizadas tardiamente não “quebraram” o
comportamento que você escreveu no início do desenvolvimento.&lt;/p&gt;
&lt;p&gt;Tenho a intenção de escrever um &lt;em&gt;post&lt;/em&gt; mais prático sobre testes e
&lt;em&gt;Django&lt;/em&gt;. Fiquem no aguardo ;)&lt;/p&gt;
&lt;p&gt;E você? Tem alguma ferramenta para recomendar? Utilize os comentários
abaixo para compartilhá-la.&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://cilliano.com/blog/2011/02/07/django-bdd-with-lettuce-and-splinter/&quot; title=&quot;Leia sobre Django, BDD, Lettuce e Splinter&quot;&gt;&lt;em&gt;CillianO – Django Full Stack Testing and BDD with Lettuce and Splinter&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.dtsato.com/blog/work/introduzindo_desenvolvimento_orientado_comportamento_bdd/&quot; title=&quot;Não sabe o que é BDD? Conheça neste artigo de Danilo Sato&quot;&gt;&lt;em&gt;Danilo Sato&lt;/em&gt; – Introduzindo Desenvolvimento Orientado por Comportamento &lt;em&gt;BDD&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/jbalogh/django-nose&quot; title=&quot;Visite o repositório do django-nose no GitHub&quot;&gt;&lt;em&gt;django-nose – GitHub repository&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://farmdev.com/projects/fudge/using-fudge.html#fudging-a-web-service&quot; title=&quot;Documentação oficial do Fudge&quot;&gt;&lt;em&gt;Fudge – Using Fudge&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://jpz-log.info/archives/2010/06/08/nose-testing-in-python-made-easy/&quot; title=&quot;Testes em Python passam a ser mais fáceis com nose&quot;&gt;&lt;em&gt;JPz’log – nose: Testing in Python made easy&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://somethingaboutorange.com/mrl/projects/nose/1.0.0/writing_tests.html&quot; title=&quot;Aprenda a escrever testes Python com o Nose&quot;&gt;&lt;em&gt;Nose – Writing tests&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://splinter.cobrateam.info/&quot; title=&quot;Conheça o projeto Splinter, e envolva-se&quot;&gt;&lt;em&gt;Splinter – Test framework for web applications&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Até a próxima…&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Ferramentas de testes em Django - Parte 1]]></title><description><![CDATA[Dando continuidade à série
“Montando seu ambiente de desenvolvimento Django no Linux“, vou
indicar algumas ferramentas de testes para que você também possa deixar
com que os testes guiem o desenvolvimento de suas aplicações. Afinal, testar é preciso ;) Testar em Django é possível? Sem dúvida nenhuma…]]></description><link>https://klauslaube.com.br/2011/07/18/ferramentas-de-testes-em-django-parte-1.html</link><guid isPermaLink="false">https://klauslaube.com.br/2011/07/18/ferramentas-de-testes-em-django-parte-1.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Mon, 18 Jul 2011 22:06:00 GMT</pubDate><content:encoded>&lt;p&gt;Dando continuidade à série
“&lt;a href=&quot;/2011/03/03/montando-seu-ambiente-de-desenvolvimento-django.html&quot; title=&quot;Veja outros posts desta série&quot;&gt;Montando seu ambiente de desenvolvimento &lt;em&gt;Django&lt;/em&gt; no &lt;em&gt;Linux&lt;/em&gt;&lt;/a&gt;“, vou
indicar algumas ferramentas de testes para que você também possa deixar
com que os &lt;a href=&quot;/2011/01/27/tdd-desenvolvimento-orientado-testes.html&quot; title=&quot;TDD: Desenvolvimento Orientado a Testes&quot;&gt;testes guiem o desenvolvimento de suas aplicações&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Afinal, testar é preciso ;)&lt;/p&gt;
&lt;h2&gt;Testar em Django é possível?&lt;/h2&gt;
&lt;p&gt;Sem dúvida nenhuma! Mas não espere que o &lt;em&gt;framework&lt;/em&gt; adeque-se a você,
você precisa ter a iniciativa de tentar compreender as melhores maneiras
para escrever testes em &lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Por exemplo, se você tem por hábito isolar os modelos para &lt;a href=&quot;/tag/testes.html&quot; title=&quot;Leia mais sobre testes&quot;&gt;testá-los&lt;/a&gt;
de forma unitária, pode passar por certa dor de cabeça com o
&lt;a href=&quot;/tag/python.html&quot; title=&quot;Leia mais sobre Python&quot;&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/a&gt; / &lt;em&gt;Django&lt;/em&gt;. Não que seja impossível, mas o comportamento
&lt;em&gt;default&lt;/em&gt; do &lt;em&gt;framework&lt;/em&gt; é criar uma base de dados “fake” para você não
precisar ter este trabalho.&lt;/p&gt;
&lt;p&gt;Enfim, talvez a forma de &lt;strong&gt;utilizar&lt;/strong&gt; estas ferramentas &lt;strong&gt;caiba em um
outro &lt;em&gt;post&lt;/em&gt;&lt;/strong&gt;, o objetivo deste é &lt;strong&gt;apenas apresentá-las&lt;/strong&gt;.&lt;/p&gt;
&lt;h2&gt;unittest – Testando unidades através de classes&lt;/h2&gt;
&lt;p&gt;A &lt;a href=&quot;http://docs.python.org/library/unittest.html&quot; title=&quot;unittest — Unit testing framework&quot;&gt;&lt;em&gt;unittest&lt;/em&gt;&lt;/a&gt; é uma biblioteca padrão do &lt;em&gt;Python&lt;/em&gt; que ajuda (e muito)
a escrever testes automatizados com a linguagem.&lt;/p&gt;
&lt;p&gt;Os testes são escritos através de classes, onde utilizamos os esquemas
de &lt;a href=&quot;http://docs.python.org/library/unittest.html#assert-methods&quot; title=&quot;Veja a lista de asserts da unittest&quot;&gt;&lt;em&gt;assertions&lt;/em&gt;&lt;/a&gt; para garantir o comportamento do código testado
(nenhuma novidade até aqui). Para quem utiliza testes unitários no
&lt;em&gt;Java&lt;/em&gt; não vai sentir grandes mudanças na abordagem, já que a &lt;em&gt;unittest&lt;/em&gt;
é inspirada na &lt;a href=&quot;http://javafree.uol.com.br/wiki/JUnit&quot; title=&quot;Leia mais sobre a JUnit&quot;&gt;&lt;em&gt;JUnit&lt;/em&gt;&lt;/a&gt; (sendo muitas vezes até chamada de &lt;em&gt;PyUnit&lt;/em&gt;):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; unittest
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; myapp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;models &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Animal

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AnimalTestCase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;unittest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TestCase&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setUp&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;lion &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Animal&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;lion&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sound&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;roar&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cat &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Animal&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;cat&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sound&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;meow&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;testSpeaking&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;assertEquals&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;lion&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;speak&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;The lion says &quot;roar&quot;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;assertEquals&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cat&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;speak&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;The cat says &quot;meow&quot;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O &lt;em&gt;test runner&lt;/em&gt; padrão do &lt;em&gt;Django&lt;/em&gt; irá procurar por subclasses de
&lt;code class=&quot;language-text&quot;&gt;unittest.TestCase&lt;/code&gt; nos arquivos &lt;code class=&quot;language-text&quot;&gt;models.py&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;tests.py&lt;/code&gt;. A suíte
de testes tenta facilitar ao máximo a sua vida… execute a seguinte
instrução e confira se a sua aplicação está &lt;em&gt;ok&lt;/em&gt; ou não:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ python manage.py test&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Peraí que não acabou! Apresentando a TestCase&lt;/h3&gt;
&lt;p&gt;Testar aplicações &lt;a href=&quot;/tag/desenvolvimento-web.html&quot; title=&quot;Leia mais sobre Web&quot;&gt;&lt;em&gt;Web&lt;/em&gt;&lt;/a&gt; com a &lt;em&gt;unittest&lt;/em&gt; pode ser dureza. Pensando
nisso o &lt;em&gt;Django&lt;/em&gt; disponibiliza a &lt;code class=&quot;language-text&quot;&gt;TestCase&lt;/code&gt;, que estende a &lt;em&gt;unittest&lt;/em&gt;
adicionando funcionalidades como carregamento de &lt;em&gt;fixtures&lt;/em&gt;, roteamento
de &lt;em&gt;urls&lt;/em&gt; e um &lt;em&gt;client&lt;/em&gt; para fazer requisições &lt;em&gt;Web&lt;/em&gt; e testar as suas
&lt;em&gt;views&lt;/em&gt; (o &lt;em&gt;TestClient&lt;/em&gt;, detalhado mais abaixo).&lt;/p&gt;
&lt;h2&gt;doctest – Testando através de docstrings&lt;/h2&gt;
&lt;p&gt;Admito que escrever documentação de &lt;em&gt;software&lt;/em&gt; não é o meu forte… mas
com &lt;em&gt;doctests&lt;/em&gt; pode-se documentar métodos ao mesmo tempo em que
escreve-se testes!&lt;/p&gt;
&lt;p&gt;A &lt;a href=&quot;http://docs.python.org/library/doctest.html&quot; title=&quot;Leia mais sobre a doctest&quot;&gt;&lt;em&gt;doctest&lt;/em&gt;&lt;/a&gt; é uma biblioteca padrão do &lt;em&gt;Python&lt;/em&gt; que procura e
interpreta &lt;a href=&quot;http://www.python.org/dev/peps/pep-0257/&quot; title=&quot;Entenda o que é uma docstring&quot;&gt;&lt;em&gt;docstrings&lt;/em&gt;&lt;/a&gt; na aplicação. A sintaxe nesses trechos de
&lt;em&gt;docstrings&lt;/em&gt; é diferenciada, simulando um interpretador interativo do
&lt;em&gt;Python&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# models.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;db &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; models

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Animal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;
  An animal that knows how to make noise

  # Create some animals
  &gt;&gt;&gt; lion = Animal.objects.create(name=&quot;lion&quot;, sound=&quot;roar&quot;)
  &gt;&gt;&gt; cat = Animal.objects.create(name=&quot;cat&quot;, sound=&quot;meow&quot;)

  # Make &apos;em speak
  &gt;&gt;&gt; lion.speak()
  &apos;The lion says &quot;roar&quot;&apos;
  &gt;&gt;&gt; cat.speak()
  &apos;The cat says &quot;meow&quot;&apos;
  &quot;&quot;&quot;&lt;/span&gt;
  name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CharField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;max_length&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  sound &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CharField&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;max_length&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;speak&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;The %s says &quot;%s&quot;&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sound&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Assim como com a &lt;em&gt;unittest&lt;/em&gt;, o &lt;em&gt;test runner&lt;/em&gt; padrão do &lt;em&gt;Django&lt;/em&gt;
procurará por ocorrências de &lt;em&gt;docstests&lt;/em&gt; em &lt;code class=&quot;language-text&quot;&gt;models.py&lt;/code&gt; e
&lt;code class=&quot;language-text&quot;&gt;tests.py&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Django Test Client – Testando a sua aplicação como se fosse um navegador&lt;/h2&gt;
&lt;p&gt;E como fazer para testar requisições &lt;em&gt;Web&lt;/em&gt;? Por exemplo, você não quer
testar a sua &lt;em&gt;view&lt;/em&gt; de forma isolada, quer testar desde a parte de
roteamento ao comportamento com o banco de dados, como se você se
estivesse realmente visitando a página. Neste caso entra a &lt;a href=&quot;https://docs.djangoproject.com/en/dev/topics/testing/#module-django.test.client&quot; title=&quot;Testando aplicações Django com requisições Web falsas&quot;&gt;&lt;em&gt;test
client&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Toda a classe &lt;code class=&quot;language-text&quot;&gt;TestCase&lt;/code&gt; possui uma instância da &lt;strong&gt;Django Test
Client&lt;/strong&gt;. Então escrever testes com requisições à sua aplicação fica
muito simples utilizando classes:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;test &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; TestCase

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SimpleTest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;TestCase&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_details&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;/customer/details/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;assertEqual&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status_code&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_index&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;/customer/index/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;assertEqual&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status_code&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;É perfeitamente possível utilizar a &lt;strong&gt;test client&lt;/strong&gt; em &lt;em&gt;doctests&lt;/em&gt;
também:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;
&gt;&gt;&gt; from django.test.client import Client
&gt;&gt;&gt; c = Client()
&gt;&gt;&gt; response = c.post(&apos;/login/&apos;, {&apos;username&apos;: &apos;john&apos;,
...        &apos;password&apos;: &apos;smith&apos;})
&gt;&gt;&gt; response.status_code
200
&quot;&quot;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Considerações finais&lt;/h2&gt;
&lt;p&gt;Particularmente, tive a oportunidade de implementar testes unitários já
no início do meu aprendizado em &lt;em&gt;Django&lt;/em&gt;. Deixar os testes te guiarem é
uma prática excelente!&lt;/p&gt;
&lt;p&gt;Tudo parte do bom senso, óbvio. Nenhum processo ou ferramenta deveria
substituir o “feeling” do profissional… também não é muito sadio ser
extremamente “by the book“. Mas se puder utilizar testes para guiar o
seu desenvolvimento, use-os!&lt;/p&gt;
&lt;p&gt;Na segunda parte deste &lt;em&gt;post&lt;/em&gt; pretendo apresentar algumas ferramentas
que irão turbinar ainda mais o seu desenvolvimento orientado a testes.&lt;/p&gt;
&lt;p&gt;Até lá!&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/1.1/topics/testing/#writing-unit-tests&quot; title=&quot;Leia direto da fonte como escrever testes em Django&quot;&gt;&lt;em&gt;Django Documentation – Writing unit tests&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/1.1/topics/testing/#writing-doctests&quot; title=&quot;Leia direto da fonte sobre como escrever testes com docstrings&quot;&gt;&lt;em&gt;Django Documentation – Writing doctests&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.djangoproject.com/en/1.1/topics/testing/#testcase&quot; title=&quot;Entenda a diferença entre unittest do Python e o TestCase do Django&quot;&gt;&lt;em&gt;Django Documentation – TestCase&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://docs.python.org/library/unittest.html&quot; title=&quot;Leia sobre a unittest direto da documentação do Python&quot;&gt;&lt;em&gt;Python Documentation – unittest: Unit testing framework&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://dougalmatthews.com/articles/2010/jan/20/testing-your-first-django-app/&quot; title=&quot;Aprenda a testar a sua primeira aplicação em Django&quot;&gt;&lt;em&gt;Dougal Matthews – Testing your first Django app&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://kokoko.fluxionary.net/testing-django-part-1-nose&quot; title=&quot;O Konrad apresenta algumas ferramentas muito boas para testes com Django&quot;&gt;&lt;em&gt;Konrad’s Kode, Konfigs &amp;#x26; Konstructions – Testing Django&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.marinhobrandao.com/blog/programacao-dirigida-a-testes-no-django/&quot; title=&quot;Aprenda Django de uma forma divertida com o Marinho&quot;&gt;&lt;em&gt;Marinho Brandão&lt;/em&gt; – Programação dirigida a testes no &lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[BDD: Desenvolvimento Orientado a Comportamento]]></title><description><![CDATA[Esse post foi originalmente escrito para o Profissionais TI, você
pode conferi-lo na íntegra aqui. No post anterior, introduzi o conceito de TDD. Mas para
relembrar, utilizando a prática “baby steps” temos os seguintes
procedimentos: Escreva um teste que falhe; Escreva um código (rudimentar) para o…]]></description><link>https://klauslaube.com.br/2011/02/02/bdd-desenvolvimento-orientado-comportamento.html</link><guid isPermaLink="false">https://klauslaube.com.br/2011/02/02/bdd-desenvolvimento-orientado-comportamento.html</guid><dc:creator><![CDATA[Klaus Peter Laube]]></dc:creator><pubDate>Wed, 02 Feb 2011 11:48:00 GMT</pubDate><content:encoded>&lt;p&gt;Esse post foi originalmente escrito para o &lt;a href=&quot;http://www.profissionaisti.com.br/&quot; title=&quot;Artigos sobre Tecnologia da Informação&quot;&gt;&lt;em&gt;Profissionais TI&lt;/em&gt;&lt;/a&gt;, você
pode conferi-lo na &lt;a href=&quot;http://www.profissionaisti.com.br/2010/01/bdd-desenvolvimento-orientado-a-comportamento/&quot; title=&quot;BDD: Desenvolvimento Orientado a Comportamento&quot;&gt;íntegra aqui&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;No &lt;a href=&quot;/2011/01/27/tdd-desenvolvimento-orientado-testes.html&quot; title=&quot;TDD: Desenvolvimento Orientado a Testes&quot;&gt;&lt;em&gt;post&lt;/em&gt; anterior&lt;/a&gt;, introduzi o conceito de &lt;a href=&quot;/tag/tdd.html&quot;&gt;&lt;em&gt;TDD&lt;/em&gt;&lt;/a&gt;. Mas para
relembrar, utilizando a prática “baby steps” temos os seguintes
procedimentos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Escreva um teste que falhe;&lt;/li&gt;
&lt;li&gt;Escreva um código (rudimentar) para o teste;&lt;/li&gt;
&lt;li&gt;Faça o teste passar;&lt;/li&gt;
&lt;li&gt;Deixe o código “cheirando bem” (&lt;em&gt;refactoring&lt;/em&gt;);&lt;/li&gt;
&lt;li&gt;Volte para o primeiro procedimento.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;O &lt;em&gt;TDD&lt;/em&gt; é focado em testes unitários, onde você isola um modelo (por
exemplo) e monta-o de acordo com os testes que você escrever. Quando
você tiver um determinado número de modelos, aí você testa a integração
entre eles, e assim por diante.&lt;/p&gt;
&lt;p&gt;Fazendo uma analogia, isso é mais ou menos como construir o &lt;em&gt;software&lt;/em&gt;
&lt;strong&gt;“de dentro para fora”&lt;/strong&gt;, onde partimos escrevendo testes específicos
(unitários) e depois vamos abrangendo outras regiões do sistema
(integração, funcional, aceitação, etc). Já em &lt;em&gt;BDD&lt;/em&gt; (&lt;em&gt;Behavior-Driven
Development&lt;/em&gt;) podemos dizer que o &lt;em&gt;software&lt;/em&gt; é desenvolvido &lt;strong&gt;“de fora
para dentro”&lt;/strong&gt;, onde os testes são construídos baseados nos requisitos
do cliente ou em um roteiro de aceitação (também conhecidos por
estórias).&lt;/p&gt;
&lt;p&gt;Esta prática é semelhante ao &lt;em&gt;TDD&lt;/em&gt;: &lt;strong&gt;testes são escritos primeiro,
funções depois&lt;/strong&gt;; O diferencial está que &lt;em&gt;BDD&lt;/em&gt; aborda o
&lt;strong&gt;comportamento&lt;/strong&gt; e o resultado como um todo, não preocupando-se
necessariamente com as classes, métodos e atributos de forma isolada.&lt;/p&gt;
&lt;h2&gt;Mas então qual usar? TDD ou BDD?&lt;/h2&gt;
&lt;p&gt;Essa era a minha dúvida. E demorou até cair a ficha&lt;/p&gt;
&lt;p&gt;Depois de uma boa conversa com o &lt;a href=&quot;http://twitter.com/andrewsmedina&quot; title=&quot;Siga o Andrews no Twitter.&quot;&gt;&lt;em&gt;@andrewsmedina&lt;/em&gt;&lt;/a&gt; (hoje já faz um
tempo que esta conversa aconteceu (: ), captei que pode-se utilizar os
dois! Claro! Garanta que a aplicação está indo de acordo com o teste de
aceitação escrito, e garanta que a escrita de determinada classe esteja
de acordo com os testes unitários criados.&lt;/p&gt;
&lt;p&gt;Geralmente trabalho com testes automatizados da seguinte maneira:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Escrevo estórias para determinada tarefa;&lt;/li&gt;
&lt;li&gt;Escrevo estas estórias em forma de testes. Estes testes podem ser
classificados como funcionais (no meu caso testo as &lt;em&gt;views&lt;/em&gt; do
&lt;a href=&quot;/tag/django.html&quot; title=&quot;Leia mais sobre Django&quot;&gt;&lt;em&gt;Django&lt;/em&gt;&lt;/a&gt;, mas isso pode variar de acordo com a aplicação);&lt;/li&gt;
&lt;li&gt;E através de “baby step” e &lt;em&gt;unit&lt;/em&gt;, crio testes isolados para os
modelos, formulários, &lt;em&gt;views&lt;/em&gt;, etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Testes de comportamento tendem a levar mais tempo para serem executados,
esta é outra razão para termos sempre em mãos os testes unitários.&lt;/p&gt;
&lt;p&gt;Até hoje não ví uma maneira “silver bullet” de trabalhar com testes
automatizados. Encaro da seguinte maneira:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Está cobrindo o teu sistema?&lt;/li&gt;
&lt;li&gt;Está guiando de forma correta o seu desenvolvimento?&lt;/li&gt;
&lt;li&gt;Está sendo escrito da forma correta (não deixando &lt;em&gt;bugs&lt;/em&gt; passarem
despercebidos, por exemplo)?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Se todas as respostas forem sim, acredito que esteja sendo feito da
maneira adequada.&lt;/p&gt;
&lt;h2&gt;Referências&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://logbr.reflectivesurface.com/2008/10/27/algumas-consideracoes-sobre-tdd-e-bdd/&quot; title=&quot;Leia mais no Superfície Reflexiva.&quot;&gt;&lt;em&gt;Superfície Reflexiva&lt;/em&gt; - Algumas considerações sobre &lt;em&gt;TDD&lt;/em&gt; e
&lt;em&gt;BDD&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://portalarquiteto.blogspot.com/2008/02/automao-de-testes-funcionais-e-de.html&quot; title=&quot;Leia mais no Portal do Arquiteto.&quot;&gt;&lt;em&gt;Portal do Arquiteto&lt;/em&gt; - Automação de testes funcionais e de
aceitação&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.aprendendodjango.com/programando-com-testes-automatizados/&quot; title=&quot;Leia mais no Aprendendo Django.&quot;&gt;&lt;em&gt;Aprendendo Django no Planeta Terra&lt;/em&gt; - Programando com Testes
Automatizados&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.slideshare.net/cmilfont/mare-de-agilidade-bdd-e-tdd&quot; title=&quot;Veja a apresentação no Slideshare.&quot;&gt;&lt;em&gt;Maré de Agilidade&lt;/em&gt;: &lt;em&gt;BDD&lt;/em&gt; e &lt;em&gt;TDD&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.dtsato.com/blog/work/introduzindo_desenvolvimento_orientado_comportamento_bdd/&quot; title=&quot;Leia mais no blog do Sato.&quot;&gt;&lt;em&gt;Danilo Sato&lt;/em&gt; - Introduzindo Desenvolvimento Orientado por
Comportamento&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item></channel></rss>